"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[44281],{28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>c});var n=s(96540);const a={},i=n.createContext(a);function r(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),n.createElement(i.Provider,{value:t},e.children)}},45625:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/script_generate_df-0b0db4e4ec1c0de934b618e41102edc5.png"},49235:(e,t,s)=>{s.d(t,{A:()=>a});s(96540);var n=s(74848);function a(e){return(0,n.jsxs)("div",{children:[e.python_package_name&&e.python_package_version&&(0,n.jsx)("a",{href:"https://docs.prophecy.io/engineers/package-hub/",children:(0,n.jsxs)("span",{className:"badge badge-dependency",children:[e.python_package_name," ",e.python_package_version]})}),e.scala_package_name&&e.scala_package_version&&(0,n.jsx)("a",{href:"https://docs.prophecy.io/engineers/package-hub",children:(0,n.jsxs)("span",{className:"badge badge-dependency",children:[e.scala_package_name," ",e.scala_package_version]})}),e.python_lib&&(0,n.jsx)("a",{href:"https://docs.prophecy.io/extensibility/dependencies/prophecy-libraries",children:(0,n.jsxs)("span",{className:"badge badge-dependency",children:["ProphecyLibsPython ",e.python_lib]})}),e.scala_lib&&(0,n.jsx)("a",{href:"https://docs.prophecy.io/extensibility/dependencies/prophecy-libraries",children:(0,n.jsxs)("span",{className:"badge badge-dependency",children:["ProphecyLibsScala ",e.scala_lib]})}),e.uc_single&&(0,n.jsx)("a",{href:"https://docs.prophecy.io/administration/fabrics/Spark-fabrics/databricks/ucshared",children:(0,n.jsxs)("span",{className:"badge badge-spark",children:["UC Dedicated Cluster ",e.uc_single]})}),e.uc_shared&&(0,n.jsx)("a",{href:"https://docs.prophecy.io/administration/fabrics/Spark-fabrics/databricks/ucshared",children:(0,n.jsxs)("span",{className:"badge badge-spark",children:["UC Standard Cluster ",e.uc_shared]})}),e.livy&&(0,n.jsx)("a",{href:"https://docs.prophecy.io/administration/fabrics/Spark-fabrics/livy",children:(0,n.jsxs)("span",{className:"badge badge-spark",children:["Livy ",e.livy]})}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{})]})}},64747:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"Spark/gems/custom/script","title":"Script gem","description":"Provide a place to use a SparkSession and whatever code you wish to use","source":"@site/docs/Spark/gems/custom/script.md","sourceDirName":"Spark/gems/custom","slug":"/engineers/script","permalink":"/engineers/script","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"custom","permalink":"/tags/custom"},{"inline":true,"label":"code","permalink":"/tags/code"}],"version":"current","frontMatter":{"title":"Script gem","sidebar_label":"Script","id":"script","slug":"/engineers/script","description":"Provide a place to use a SparkSession and whatever code you wish to use","tags":["custom","code"]},"sidebar":"mySidebar","previous":{"title":"Custom","permalink":"/engineers/custom"},"next":{"title":"SQLStatement","permalink":"/engineers/sql-statement"}}');var a=s(74848),i=s(28453),r=s(49235);const c={title:"Script gem",sidebar_label:"Script",id:"script",slug:"/engineers/script",description:"Provide a place to use a SparkSession and whatever code you wish to use",tags:["custom","code"]},d=void 0,o={},l=[{value:"Parameters",id:"parameters",level:2},{value:"Schema",id:"schema",level:2},{value:"Examples",id:"examples",level:2},{value:"Script gem with Input and Output: Un-pivoting a DataFrame",id:"script-gem-with-input-and-output-un-pivoting-a-dataframe",level:3},{value:"Script gem with only Output: Generating a DataFrame",id:"script-gem-with-only-output-generating-a-dataframe",level:3}];function p(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",hr:"hr",img:"img",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.A,{python_package_name:"",python_package_version:"",scala_package_name:"",scala_package_version:"",scala_lib:"",python_lib:"",uc_single:"14.3+",uc_shared:"14.3+",livy:"3.0.1+"}),"\n",(0,a.jsxs)(t.p,{children:["Provides a ",(0,a.jsx)(t.code,{children:"SparkSession"})," and allows you to run custom PySpark code."]}),"\n",(0,a.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Meaning"}),(0,a.jsx)(t.th,{style:{textAlign:"left"},children:"Required"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Input DataFrame(s)"}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Input DataFrame(s)"}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"False"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Output DataFrame(s)"}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Output DataFrame(s)"}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"False"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Code"}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"Custom code to be executed"}),(0,a.jsx)(t.td,{style:{textAlign:"left"},children:"True"})]})]})]}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["To edit or remove input and output DataFrame(s), click on the ",(0,a.jsx)(t.strong,{children:"pen"})," icon next to ",(0,a.jsx)(t.strong,{children:"Ports"})," to open edit mode."]})}),"\n",(0,a.jsx)(t.h2,{id:"schema",children:"Schema"}),"\n",(0,a.jsxs)(t.p,{children:["When executing a custom script gem, the output schema is not known by Prophecy so it must be inferred from a sample computation result. Click the ",(0,a.jsx)(t.code,{children:"Custom Schema"})," button and ",(0,a.jsx)(t.code,{children:"Infer from cluster"})," as shown in the gem ",(0,a.jsx)(t.a,{href:"/engineers/gems#output-ports",children:"output port tab"}),". The schema will be inferred according to the script and the Spark version running on the connected cluster."]}),"\n",(0,a.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h3,{id:"script-gem-with-input-and-output-un-pivoting-a-dataframe",children:"Script gem with Input and Output: Un-pivoting a DataFrame"}),"\n",(0,a.jsxs)(t.p,{children:["We'll perform the ",(0,a.jsx)(t.code,{children:"unpivot"})," operation using our custom code"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Script - Unpivot",src:s(65448).A+"",width:"1726",height:"812"})}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.h3,{id:"script-gem-with-only-output-generating-a-dataframe",children:"Script gem with only Output: Generating a DataFrame"}),"\n",(0,a.jsxs)(t.p,{children:["We'll use the provided ",(0,a.jsx)(t.code,{children:"SparkSession"})," to create and return a DataFrame"]}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsx)(t.p,{children:"Since we removed the input port, we don't see input DataFrame in the method signature"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Script - Unpivot",src:s(45625).A+"",width:"2110",height:"1228"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},65448:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/script_unpivot-be4b541e680f7028ab24c2a3b37ebda4.png"}}]);