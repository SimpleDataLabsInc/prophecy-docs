"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[64479],{15680:(e,o,t)=>{t.d(o,{xA:()=>p,yg:()=>y});var n=t(96540);function a(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function r(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{};o%2?r(Object(t),!0).forEach((function(o){a(e,o,t[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}))}return e}function s(e,o){if(null==e)return{};var t,n,a=function(e,o){if(null==e)return{};var t,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],o.indexOf(t)>=0||(a[t]=e[t]);return a}(e,o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],o.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=n.createContext({}),u=function(e){var o=n.useContext(i),t=o;return e&&(t="function"==typeof e?e(o):l(l({},o),e)),t},p=function(e){var o=u(e.components);return n.createElement(i.Provider,{value:o},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var o=e.children;return n.createElement(n.Fragment,{},o)}},g=n.forwardRef((function(e,o){var t=e.components,a=e.mdxType,r=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=u(t),g=a,y=d["".concat(i,".").concat(g)]||d[g]||c[g]||r;return t?n.createElement(y,l(l({ref:o},p),{},{components:t})):n.createElement(y,l({ref:o},p))}));function y(e,o){var t=arguments,a=o&&o.mdxType;if("string"==typeof e||a){var r=t.length,l=new Array(r);l[0]=g;var s={};for(var i in o)hasOwnProperty.call(o,i)&&(s[i]=o[i]);s.originalType=e,s[d]="string"==typeof e?e:a,l[1]=s;for(var u=2;u<r;u++)l[u]=t[u];return n.createElement.apply(null,l)}return n.createElement.apply(null,t)}g.displayName="MDXCreateElement"},7333:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>i,contentTitle:()=>l,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>u});var n=t(58168),a=(t(96540),t(15680));const r={title:"Download logs",id:"download-logs",description:"Download Prophecy support logs",sidebar_position:5,tags:["download","support logs"]},l=void 0,s={unversionedId:"architecture/self-hosted/download-logs",id:"architecture/self-hosted/download-logs",title:"Download logs",description:"Download Prophecy support logs",source:"@site/docs/architecture/self-hosted/download-logs.md",sourceDirName:"architecture/self-hosted",slug:"/architecture/self-hosted/download-logs",permalink:"/architecture/self-hosted/download-logs",draft:!1,tags:[{label:"download",permalink:"/tags/download"},{label:"support logs",permalink:"/tags/support-logs"}],version:"current",sidebarPosition:5,frontMatter:{title:"Download logs",id:"download-logs",description:"Download Prophecy support logs",sidebar_position:5,tags:["download","support logs"]},sidebar:"defaultSidebar",previous:{title:"Upgrades and backups",permalink:"/architecture/self-hosted/upgrade-backup-restore"},next:{title:"Generate API Key",permalink:"/architecture/self-hosted/generate-api-key"}},i={},u=[{value:"Use case",id:"use-case",level:2},{value:"Download logs features",id:"download-logs-features",level:3},{value:"Enable Prophecy Downloads logs",id:"enable-prophecy-downloads-logs",level:2},{value:"Navigate to the Download logs UI",id:"navigate-to-the-download-logs-ui",level:2}],p={toc:u},d="wrapper";function c(e){let{components:o,...t}=e;return(0,a.yg)(d,(0,n.A)({},p,t,{components:o,mdxType:"MDXLayout"}),(0,a.yg)("p",null,"As an admin user, you can download your environment logs from Prophecy without needing access to your Prophecy cluster or the assistance of Prophecy Support. This reduces the delay in debugging any issues with your Prophecy services."),(0,a.yg)("h2",{id:"use-case"},"Use case"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"The overarching objective is to debug what is going on with your Prophecy services."),(0,a.yg)("li",{parentName:"ul"},"To achieve this, we've enabled admins to be able to download Prophecy logs and environment information so that they can upload them to Zendesk.")),(0,a.yg)("h3",{id:"download-logs-features"},"Download logs features"),(0,a.yg)("p",null,"You can use the Download Logs feature to capture logs using the Services and time selectors."),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"All services are selected by default."),(0,a.yg)("li",{parentName:"ul"},"The download supports one hour of logs from the Start Time.")),(0,a.yg)("p",null,"The captured logs include all relevant Prophecy configurations, such as the following items:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Kubernetes cluster configuration",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Resource quotas"),(0,a.yg)("li",{parentName:"ul"},"Node configuration"))),(0,a.yg)("li",{parentName:"ul"},"Cluster custom resources"),(0,a.yg)("li",{parentName:"ul"},"Config maps and files"),(0,a.yg)("li",{parentName:"ul"},"Resource consumption logs")),(0,a.yg)("admonition",{type:"note"},(0,a.yg)("p",{parentName:"admonition"},"Sensitive information, such as customer preview data, credentials, tokens, or passwords, is scrubbed or redacted from the download bundle.")),(0,a.yg)("h2",{id:"enable-prophecy-downloads-logs"},"Enable Prophecy Downloads logs"),(0,a.yg)("p",null,"Before you can download logs, you must enable it in your private SAAS deployment."),(0,a.yg)("p",null,"See the following requirements for enabling the Prophecy logs:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Prophecy collects the logs of all pods and stores it in the Athena Pod."),(0,a.yg)("li",{parentName:"ul"},"Each pod uses an additional 500 MB ephemeral storage for temporary storage."),(0,a.yg)("li",{parentName:"ul"},"Athena requires additional storage of around 100 GB to store one week of logs."),(0,a.yg)("li",{parentName:"ul"},"A new container image fluentbit (",(0,a.yg)("inlineCode",{parentName:"li"},"gcr.io/prophecy-share/fluent-bit:2.2.3"),") is required for this feature.")),(0,a.yg)("p",null,"To enable Minio in Athena and provide it a volume, follow these steps:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Add env variables to Athena STS:")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},'  - name: MINIO_ENDPOINT\n    value: athena:9000\n  - name: ENABLE_FLUENTBIT_SIDECARS\n    value: "true"\n  - name: RUN_ATHENA_MINIO\n    value: "true"\n')),(0,a.yg)("ol",{start:2},(0,a.yg)("li",{parentName:"ol"},"Add volume to Athena STS:")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"  volumeClaimTemplates:\n  ...\n  - apiVersion: v1\n    kind: PersistentVolumeClaim\n    metadata:\n      creationTimestamp: null\n      name: minio-storage\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n      volumeMode: Filesystem\n")),(0,a.yg)("ol",{start:3},(0,a.yg)("li",{parentName:"ol"},"Add volume mount to Athena:")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"  volumeMounts:\n  ...\n  - mountPath: /minio/data\n    name: minio-storage\n")),(0,a.yg)("ol",{start:4},(0,a.yg)("li",{parentName:"ol"},"Add the Minio port to Athena SVC:")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"  ports:\n  ...\n  - name: minio\n    port: 9000\n    protocol: TCP\n    targetPort: 9000\n")),(0,a.yg)("h2",{id:"navigate-to-the-download-logs-ui"},"Navigate to the Download logs UI"),(0,a.yg)("p",null,"To download logs in the Prophecy UI, follow these steps:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Log in to the Prophecy UI as an admin user."),(0,a.yg)("li",{parentName:"ol"},"Click on the ",(0,a.yg)("strong",{parentName:"li"},"three dots")," at the bottom left corner and select the ",(0,a.yg)("strong",{parentName:"li"},"Settings")," icon from the submenu."),(0,a.yg)("li",{parentName:"ol"},"Navigate to the ",(0,a.yg)("strong",{parentName:"li"},"Admin")," main tab."),(0,a.yg)("li",{parentName:"ol"},"Within the Admin main tab, access the ",(0,a.yg)("strong",{parentName:"li"},"Logs")," sub tab."),(0,a.yg)("li",{parentName:"ol"},"Set the ",(0,a.yg)("strong",{parentName:"li"},"Services")," and ",(0,a.yg)("strong",{parentName:"li"},"Start Date/Time"),", and then click ",(0,a.yg)("strong",{parentName:"li"},"Download"))),(0,a.yg)("p",null,"After several seconds, the file will download via your browser. The download generates a compressed file containing logs, suitable for sharing with a Prophecy support engineer."))}c.isMDXComponent=!0}}]);