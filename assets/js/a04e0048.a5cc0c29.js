"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[7573],{3905:(e,t,s)=>{s.d(t,{Zo:()=>p,kt:()=>m});var a=s(67294);function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t){if(null==e)return{};var s,a,r=function(e,t){if(null==e)return{};var s,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)s=i[a],t.indexOf(s)>=0||(r[s]=e[s]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}var l=a.createContext({}),u=function(e){var t=a.useContext(l),s=t;return e&&(s="function"==typeof e?e(t):n(n({},t),e)),s},p=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var s=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=u(s),h=r,m=c["".concat(l,".").concat(h)]||c[h]||d[h]||i;return s?a.createElement(m,n(n({ref:t},p),{},{components:s})):a.createElement(m,n({ref:t},p))}));function m(e,t){var s=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=s.length,n=new Array(i);n[0]=h;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[c]="string"==typeof e?e:r,n[1]=o;for(var u=2;u<i;u++)n[u]=s[u];return a.createElement.apply(null,n)}return a.createElement.apply(null,s)}h.displayName="MDXCreateElement"},27283:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>n,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>u});var a=s(87462),r=(s(67294),s(3905));const i={title:"Test a Pipeline",id:"test-Pipeline",description:"How to add unit tests to a Pipeline",sidebar_position:3,tags:["Pipelines","tutorial","test","custom","unit"]},n=void 0,o={unversionedId:"tutorials/videos/test-Pipeline",id:"tutorials/videos/test-Pipeline",title:"Test a Pipeline",description:"How to add unit tests to a Pipeline",source:"@site/docs/tutorials/videos/test-pipeline.md",sourceDirName:"tutorials/videos",slug:"/tutorials/videos/test-Pipeline",permalink:"/tutorials/videos/test-Pipeline",draft:!1,tags:[{label:"Pipelines",permalink:"/tags/pipelines"},{label:"tutorial",permalink:"/tags/tutorial"},{label:"test",permalink:"/tags/test"},{label:"custom",permalink:"/tags/custom"},{label:"unit",permalink:"/tags/unit"}],version:"current",sidebarPosition:3,frontMatter:{title:"Test a Pipeline",id:"test-Pipeline",description:"How to add unit tests to a Pipeline",sidebar_position:3,tags:["Pipelines","tutorial","test","custom","unit"]},sidebar:"defaultSidebar",previous:{title:"Schedule a Pipeline",permalink:"/tutorials/videos/schedule-Pipeline"}},l={},u=[{value:"Summary",id:"summary",level:3},{value:"Description",id:"description",level:3},{value:"Transcript",id:"transcript",level:3},{value:"Follow along checklist",id:"follow-along-checklist",level:3}],p={toc:u},c="wrapper";function d(e){let{components:t,...s}=e;return(0,r.kt)(c,(0,a.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("div",{class:"wistia_responsive_padding",style:{padding:"56.25% 0 0 0",position:"relative"}},(0,r.kt)("div",{class:"wistia_responsive_wrapper",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"}},(0,r.kt)("iframe",{src:"https://fast.wistia.net/embed/iframe/hs4r7qlsxo?wtime=0s?seo=false?videoFoam=true",title:"Design a Pipeline Video",allow:"autoplay; fullscreen",allowtransparency:"true",frameborder:"0",scrolling:"no",class:"wistia_embed",name:"wistia_embed",msallowfullscreen:!0,width:"100%",height:"100%"}))),(0,r.kt)("script",{src:"https://fast.wistia.net/assets/external/E-v1.js",async:!0}),(0,r.kt)("h3",{id:"summary"},"Summary"),(0,r.kt)("p",null,"Generate unit tests to ensure each transformation functions as expected."),(0,r.kt)("h3",{id:"description"},"Description"),(0,r.kt)("p",null,"Generate unit tests using Prophecy's template test builder, run tests and check results all in Prophecy's low-code interface. Create custom data samples or configure Prophecy to generate a data sample based on your Pipeline. Go further with custom predicate expressions. Commit your tests, and Prophecy will run the tests any time the main branch is updated. Maintain tests in Prophecy and gate releases based on test outcomes. Achieve greater test coverage with Prophecy!"),(0,r.kt)("h3",{id:"transcript"},"Transcript"),(0,r.kt)("p",null,"Welcome back! In the last trainings, we designed a Pipeline, scheduled the Pipeline, and now we\u2019ll test the Pipeline. Let\u2019s get started!"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://fast.wistia.net/embed/iframe/hs4r7qlsxo?wtime=18s?seo=false?videoFoam=true"},"Basic test: Output Rows Equality"),(0,r.kt)("br",{parentName:"p"}),"\n",'We\u2019ll start with a test to make sure our aggregate function works as expected. Our SumAmounts Gem groups by return and delivery status. We\u2019ll focus on the SUM_QTY column for simplicity. Here we\u2019ll use the first option "Output rows equality." We will define input data and output data so that our Aggregate function always transforms the input data into the output data. (If preferred, there\u2019s an option to generate a data sample from the larger Dataset.) Select the columns you\u2019d like to include in the test. Notice the input and output Datasets have been started for us. These are the input columns that are needed to compute our desired output columns. Remember this Gem should group by returnflag and delivery status. Let\u2019s say our return flags could be A or B, and our delivery status could be C or D. For simplicity, let\u2019s say each order has quantity of one. We have created our input sample data. Now let\u2019s create the output sample data. We expect the data should be grouped by return flag, then by delivery status. The quantity from each group is summed.'),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://fast.wistia.net/embed/iframe/hs4r7qlsxo?wtime=1m47s?seo=false?videoFoam=true"},"Run the basic test"),(0,r.kt)("br",{parentName:"p"}),"\n","We have created our test. Run the test right here in Prophecy. The test passed! So our Aggregate function, called SumAmounts, is working exactly as we thought."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://fast.wistia.net/embed/iframe/hs4r7qlsxo?wtime=2m3s?seo=false?videoFoam=true"},"See the basic test code"),(0,r.kt)("br",{parentName:"p"}),"\n","Let\u2019s see what the code looks like behind the scenes. For this unit test here is the input data sample and the output data sample. This test computes sumAmounts given the input DataFrame and asserts the columns match the expected output Dataset. Wow, so that\u2019s it! Creating a test in Prophecy is easy. Commit the code and your tests can be used to gate your releases."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://fast.wistia.net/embed/iframe/hs4r7qlsxo?wtime=2m39s?seo=false?videoFoam=true"},"Custom test: Output predicates"),(0,r.kt)("br",{parentName:"p"}),"\n",'For those Prophecy users who want to dig deeper, we have a bonus segment to explore customizing tests. Here we\u2019ll create a unit test for the Cleanup Gem. I created the expression here which handles erroneous zero tax values and replaces them with a default value. So this is the expression i want to test. Last time we created a test using the "Output rows equality" option, wherein we specify the input and output Datasets. Here we\u2019ll customize our test with "Output predicates." Select the columns of interest. Define the expression your function should satisfy. Define some sample rows. Hopefully our function will replace the zero with the default value.'),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://fast.wistia.net/embed/iframe/hs4r7qlsxo?wtime=3m43s?seo=false?videoFoam=true"},"Run the custom test"),(0,r.kt)("br",{parentName:"p"}),"\n","We have created our test! Let\u2019s run it right here in Prophecy. It passed! Before we save our work I want to find a scenario where I can make my test fail. If I remove this expression in my Cleanup Function - if I just pass the input Tax as it is with the zeros included - then my tests should fail. The predicate expression is not always true for this input Dataset. Great! Let\u2019s return the expression to cleanup the data in the Cleanup Gem and save our work."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://fast.wistia.net/embed/iframe/hs4r7qlsxo?wtime=4m28s?seo=false?videoFoam=true"},"See the custom test code"),(0,r.kt)("br",{parentName:"p"}),"\n","Let\u2019s see this code behind the scenes! Assert the computed output satisfies our custom predicate."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://fast.wistia.net/embed/iframe/hs4r7qlsxo?wtime=4m38s?seo=false?videoFoam=true"},"Recap"),(0,r.kt)("br",{parentName:"p"}),"\n","Wow, we created unit tests for the SumAmounts and Cleanup functions. We used two types of tests, including custom predicates, to make sure our functions are working as designed. Just commit this new code, merge, and release a version tag, exactly as in the previous video training. Your tests will be included in your Pipeline release sequence, so you can be alerted if your functions stop passing these code quality tests. Nice! In the next training we\u2019ll see how to monitor our Pipelines over time."),(0,r.kt)("p",null,"See you next time!"),(0,r.kt)("h3",{id:"follow-along-checklist"},"Follow along checklist"),(0,r.kt)("p",null,"Databricks and Prophecy credentials are needed. Set Prophecy credentials while signing up for a free trial here: ",(0,r.kt)("a",{parentName:"p",href:"https://App.Prophecy.io/"},"App.Prophecy.io"),'. If you don\'t have Databricks credentials, the Prophecy app will guide you to use our "managed" Databricks cluster during your 14 day free trial.'),(0,r.kt)("p",null,"My repository is located ",(0,r.kt)("a",{parentName:"p",href:"https://Github.com/SimpleDataLabsInc/ShippingReports"},"here"),"; I just created an empty repository, designed, scheduled, and tested my Pipeline as shown in Prophecy, then committed the generated code from the Prophecy UI."),(0,r.kt)("p",null,"Go for it! Follow the steps outlined in the video above; ask questions on Prophecy's ",(0,r.kt)("a",{parentName:"p",href:"https://join.slack.com/t/Prophecy-io-support/shared_invite/zt-moq3xzoj-~5MSJ6WPnZfz7bwsqWi8tQ"},"Slack")))}d.isMDXComponent=!0}}]);