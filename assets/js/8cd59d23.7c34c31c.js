"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[41283],{28453:(e,i,t)=>{t.d(i,{R:()=>o,x:()=>c});var n=t(96540);const r={},s=n.createContext(r);function o(e){const i=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(s.Provider,{value:i},e.children)}},65042:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"administration/authentication/oauth-setup","title":"OAuth app registrations","description":"Create app registrations in Prophecy for OAuth setup","source":"@site/docs/administration/authentication/oauth-setup.md","sourceDirName":"administration/authentication","slug":"/oauth-setup","permalink":"/oauth-setup","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"authentication","permalink":"/tags/authentication"},{"inline":true,"label":"oauth","permalink":"/tags/oauth"}],"version":"current","frontMatter":{"title":"OAuth app registrations","id":"oauth-setup","slug":"/oauth-setup","description":"Create app registrations in Prophecy for OAuth setup","tags":["authentication","oauth"]},"sidebar":"gettingStartedSidebar","previous":{"title":"Admin settings","permalink":"/administration/cluster-admin-settings"},"next":{"title":"Audit logs","permalink":"/administration/audit-logging"}}');var r=t(74848),s=t(28453);const o={title:"OAuth app registrations",id:"oauth-setup",slug:"/oauth-setup",description:"Create app registrations in Prophecy for OAuth setup",tags:["authentication","oauth"]},c=void 0,d={},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Supported providers",id:"supported-providers",level:2},{value:"App registration selection",id:"app-registration-selection",level:2},{value:"Create an app registration",id:"create-an-app-registration",level:2},{value:"Default and custom scopes",id:"default-and-custom-scopes",level:3},{value:"Create provider-side OAuth applications",id:"create-provider-side-oauth-applications",level:2},{value:"Databricks",id:"databricks",level:3},{value:"Google Cloud",id:"google-cloud",level:3},{value:"ID Anywhere",id:"id-anywhere",level:3}];function a(e){const i={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.admonition,{title:"Enterprise",type:"edition",children:(0,r.jsxs)(i.p,{children:["Available on the ",(0,r.jsx)(i.a,{href:"/getting-started/editions/",children:"Enterprise Edition"})," only."]})}),"\n",(0,r.jsx)(i.p,{children:"Configure OAuth for Prophecy fabric connections by creating app registrations for supported identity providers."}),"\n",(0,r.jsx)(i.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(i.p,{children:"Before you configure OAuth in Prophecy, ensure you have:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Cluster admin access to Prophecy."}),"\n",(0,r.jsxs)(i.li,{children:["An OAuth application created with your identity provider. See ",(0,r.jsx)(i.a,{href:"#create-provider-side-oauth-applications",children:"Create provider-side OAuth applications"}),"."]}),"\n",(0,r.jsx)(i.li,{children:"The client ID from your provider's OAuth application."}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"supported-providers",children:"Supported providers"}),"\n",(0,r.jsx)(i.p,{children:"Prophecy supports OAuth authentication with the following providers:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Databricks"}),": Authenticate with Databricks workspaces"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Google"}),": Authenticate with Google Cloud services"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"ID Anywhere"}),": Authenticate with custom identity providers"]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"app-registration-selection",children:"App registration selection"}),"\n",(0,r.jsx)(i.p,{children:"If you create multiple app registrations for a certain provider, the selection behavior varies based on the fabric type."}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Fabric type"}),(0,r.jsx)(i.th,{children:"Description"}),(0,r.jsx)(i.th,{children:"Example"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.a,{href:"/administration/fabrics/prophecy-fabrics/",children:"Prophecy fabrics"})}),(0,r.jsx)(i.td,{children:"You can select which app registration to use from a dropdown in the fabric connection settings. If multiple app registrations exist, you can toggle between them."}),(0,r.jsx)(i.td,{children:"If you create a Prophecy fabric and configure a Databricks connection, and you have multiple Databricks app registrations, you can select which one to use."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.a,{href:"/administration/fabrics/Spark-fabrics/Fabrics",children:"Spark fabrics"})}),(0,r.jsxs)(i.td,{children:["The default app registration for the provider is ",(0,r.jsx)(i.strong,{children:"always"})," used automatically. You cannot change which app registration is used at the fabric level."]}),(0,r.jsx)(i.td,{children:"If you create a Spark fabric and select Databricks as the provider, the fabric will always use the default Databricks app registration."})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"create-an-app-registration",children:"Create an app registration"}),"\n",(0,r.jsx)(i.p,{children:"To add a new OAuth app registration:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsx)(i.p,{children:"Sign in to Prophecy as a cluster admin."}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["In the navigation menu, go to ",(0,r.jsx)(i.strong,{children:"Settings"})," > ",(0,r.jsx)(i.strong,{children:"Admin"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Select the ",(0,r.jsx)(i.strong,{children:"Security"})," tab."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Click ",(0,r.jsx)(i.strong,{children:"Add App Registration"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsx)(i.p,{children:"Configure the registration settings:"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Field"}),(0,r.jsx)(i.th,{children:"Description"}),(0,r.jsx)(i.th,{children:"Required"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Provider"}),(0,r.jsx)(i.td,{children:"Select your identity provider (Databricks, Google, or ID Anywhere)."}),(0,r.jsx)(i.td,{children:"Yes"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Default for Provider"}),(0,r.jsx)(i.td,{children:"When enabled, this registration becomes the default OAuth configuration for fabrics for the selected provider. The default is always used for Spark fabrics and cannot be changed at the fabric level."}),(0,r.jsx)(i.td,{children:"No"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Name"}),(0,r.jsx)(i.td,{children:"A descriptive name to identify this registration. Useful when managing multiple registrations for the same provider."}),(0,r.jsx)(i.td,{children:"Yes"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"App Client ID"}),(0,r.jsx)(i.td,{children:"The client ID from your OAuth application."}),(0,r.jsx)(i.td,{children:"Yes"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"App Client Secret"}),(0,r.jsx)(i.td,{children:"The client secret from your OAuth application."}),(0,r.jsx)(i.td,{children:"No"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Token Lifetime"}),(0,r.jsx)(i.td,{children:"Override the default token lifetime set by your provider."}),(0,r.jsx)(i.td,{children:"No"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Authorization Endpoint"}),(0,r.jsx)(i.td,{children:"The authorization URL for your identity provider."}),(0,r.jsx)(i.td,{children:"ID Anywhere only"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Scopes"}),(0,r.jsxs)(i.td,{children:["Space-separated list of OAuth scopes. Required for ID Anywhere. Optional for Databricks and Google to override ",(0,r.jsx)(i.a,{href:"#default-and-custom-scopes",children:"default scopes"}),"."]}),(0,r.jsx)(i.td,{children:"Depends"})]})]})]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Click ",(0,r.jsx)(i.strong,{children:"Save"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"default-and-custom-scopes",children:"Default and custom scopes"}),"\n",(0,r.jsx)(i.p,{children:"Each provider requires specific OAuth scopes:"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Provider"}),(0,r.jsx)(i.th,{children:"Default scopes"}),(0,r.jsx)(i.th,{children:"Custom scopes documentation"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Databricks"}),(0,r.jsxs)(i.td,{children:[(0,r.jsx)(i.code,{children:"all-apis"}),", ",(0,r.jsx)(i.code,{children:"offline_access"}),", ",(0,r.jsx)(i.code,{children:"profile"}),", ",(0,r.jsx)(i.code,{children:"email"}),", ",(0,r.jsx)(i.code,{children:"openid"})]}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.a,{href:"https://docs.databricks.com/api/account/customappintegration/create",children:"Custom app integration scopes"})})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Google"}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"https://www.googleapis.com/auth/bigquery"})}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.a,{href:"https://developers.google.com/identity/protocols/oauth2/scopes",children:"OAuth 2.0 Scopes for Google APIs"})})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"ID Anywhere"}),(0,r.jsx)(i.td,{children:"None (must specify manually)"}),(0,r.jsx)(i.td,{children:"Consult your provider's documentation"})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"create-provider-side-oauth-applications",children:"Create provider-side OAuth applications"}),"\n",(0,r.jsx)(i.p,{children:"Before adding an app registration in Prophecy, you need to create the corresponding OAuth application with your provider."}),"\n",(0,r.jsx)(i.h3,{id:"databricks",children:"Databricks"}),"\n",(0,r.jsxs)(i.p,{children:["First, a Databricks ",(0,r.jsx)(i.a,{href:"https://docs.databricks.com/en/admin/index.html#what-are-account-admins",children:"account admin"})," needs to complete the following steps ",(0,r.jsx)(i.strong,{children:"once"})," for your Prophecy deployment:"]}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["On Databricks, navigate to ",(0,r.jsx)(i.strong,{children:"Account Settings > App connections"})," in your account console."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.a,{href:"https://docs.databricks.com/en/integrations/enable-disable-oauth.html#enable-custom-oauth-applications-using-the-databricks-ui",children:"Create a new App connection"})," for Prophecy. Ensure that:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Access scopes are set to ",(0,r.jsx)(i.strong,{children:"ALL APIs"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsx)(i.p,{children:"The redirect URL contains the following URLs:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:"https://<your_prophecy_url>/api/databricks/oauthredirect\nhttps://<your_prophecy_url>/metadata/oauthCallback\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsx)(i.p,{children:"This process generates Databricks OAuth Application fields on the Prophecy side."}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Under Client ID, copy your ",(0,r.jsx)(i.strong,{children:"OAuth Client ID"})," for the application, and share it with your Prophecy Cluster Admin."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Under Client secret, select ",(0,r.jsx)(i.strong,{children:"Generate a client secret"}),". Share it with your Prophecy Cluster Admin."]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:["Click ",(0,r.jsx)(i.strong,{children:"Save"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"google-cloud",children:"Google Cloud"}),"\n",(0,r.jsx)(i.p,{children:"Create an OAuth 2.0 client in Google Cloud Console:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:["Sign in to ",(0,r.jsx)(i.a,{href:"https://console.cloud.google.com",children:"Google Cloud Console"}),"."]}),"\n",(0,r.jsx)(i.li,{children:"Select your project."}),"\n",(0,r.jsxs)(i.li,{children:["Go to ",(0,r.jsx)(i.strong,{children:"APIs & Services"})," > ",(0,r.jsx)(i.strong,{children:"Credentials"}),"."]}),"\n",(0,r.jsxs)(i.li,{children:["Click ",(0,r.jsx)(i.strong,{children:"Create Credentials"})," > ",(0,r.jsx)(i.strong,{children:"OAuth client ID"}),"."]}),"\n",(0,r.jsx)(i.li,{children:"Configure the OAuth consent screen if prompted."}),"\n",(0,r.jsx)(i.li,{children:"Select the application type and configure authorized redirect URIs."}),"\n",(0,r.jsx)(i.li,{children:"Save the generated client ID and secret for use in Prophecy."}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["For detailed instructions, see ",(0,r.jsx)(i.a,{href:"https://support.google.com/cloud/answer/6158849",children:"Setting up OAuth 2.0"})," in the Google Cloud documentation."]}),"\n",(0,r.jsx)(i.h3,{id:"id-anywhere",children:"ID Anywhere"}),"\n",(0,r.jsx)(i.p,{children:"For custom identity providers, consult your provider's documentation to:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Create an OAuth 2.0 application or client."}),"\n",(0,r.jsx)(i.li,{children:"Configure the authorization endpoint."}),"\n",(0,r.jsx)(i.li,{children:"Define the required scopes."}),"\n",(0,r.jsx)(i.li,{children:"Generate client credentials."}),"\n",(0,r.jsx)(i.li,{children:"Set up redirect URIs to point to your Prophecy instance."}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);