"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[63040],{28453:(e,t,n)=>{n.d(t,{R:()=>d,x:()=>l});var s=n(96540);const r={},i=s.createContext(r);function d(e){const t=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(i.Provider,{value:t},e.children)}},77956:(e,t,n)=>{n.d(t,{A:()=>r});n(96540);var s=n(74848);function r(e){return(0,s.jsxs)("div",{children:[e.execution_engine&&(0,s.jsx)("a",{href:"https://docs.prophecy.io/administration/fabrics/prophecy-fabrics/",children:(0,s.jsx)("span",{className:"badge badge-runtime",children:e.execution_engine})}),e.sql_package_name&&e.sql_package_version&&(0,s.jsx)("a",{href:"https://docs.prophecy.io/engineers/package-hub/",children:(0,s.jsxs)("span",{className:"badge badge-dependency",children:[e.sql_package_name," ",e.sql_package_version]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{})]})}},88208:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>x,frontMatter:()=>l,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"analysts/development/gems/custom/sql-statement","title":"SQLStatement gem","description":"Use a custom SQL statement","source":"@site/docs/analysts/development/gems/custom/sql-statement.md","sourceDirName":"analysts/development/gems/custom","slug":"/analysts/sql-statement","permalink":"/analysts/sql-statement","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"gems","permalink":"/tags/gems"},{"inline":true,"label":"analyst","permalink":"/tags/analyst"},{"inline":true,"label":"custom","permalink":"/tags/custom"}],"version":"current","frontMatter":{"title":"SQLStatement gem","sidebar_label":"SQLStatement","id":"sql-statement","slug":"/analysts/sql-statement","description":"Use a custom SQL statement","tags":["gems","analyst","custom"]},"sidebar":"platformSidebar","previous":{"title":"StoredProcedure","permalink":"/analysts/stored-procedure-gem"},"next":{"title":"ToDo","permalink":"/analysts/development/gems/custom/todo"}}');var r=n(74848),i=n(28453),d=n(77956);const l={title:"SQLStatement gem",sidebar_label:"SQLStatement",id:"sql-statement",slug:"/analysts/sql-statement",description:"Use a custom SQL statement",tags:["gems","analyst","custom"]},a=void 0,c={},o=[{value:"Input and Output",id:"input-and-output",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Example",id:"example",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.A,{execution_engine:"SQL Warehouse",sql_package_name:"",sql_package_version:""}),"\n",(0,r.jsx)(t.p,{children:"Use a custom SQL statement in your pipeline. The SQLStatement gem supports SELECT statements. This gem does not support actions like inserting or deleting tables."}),"\n",(0,r.jsx)(t.h2,{id:"input-and-output",children:"Input and Output"}),"\n",(0,r.jsx)(t.p,{children:"The SQLStatement gem uses the following input and output ports."}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Port"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"in0"})}),(0,r.jsx)(t.td,{children:"(Optional) Input table used in query."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"out"})}),(0,r.jsx)(t.td,{children:"Output table with query results."})]})]})]}),"\n",(0,r.jsxs)(t.p,{children:["By default, the SQL statement gem does not include an input port. To add a port, click the ",(0,r.jsx)(t.code,{children:"+"})," button next to ",(0,r.jsx)(t.strong,{children:"Ports"}),". Alternatively, connect the previous gem to the SQLStatement gem directly to add a new input port."]}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["Number of inputs and outputs can be changed as needed by clicking the ",(0,r.jsx)(t.code,{children:"+"})," button on the respective tab.\nTo learn more about adding and removing ports, see ",(0,r.jsx)(t.a,{href:"/analysts/gems#gem-ports",children:"Gem ports"}),"."]})}),"\n",(0,r.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(t.p,{children:"Configure the SQLStatement gem using the following parameters."}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter"}),(0,r.jsx)(t.th,{children:"Meaning"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Out"}),(0,r.jsx)(t.td,{children:"SQL query that defines the output result."})]})})]}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsxs)(t.p,{children:["Write your SQL query in the syntax of your SQL warehouse provider. For example, if you're connected to a Databricks SQL warehouse, use Databricks SQL dialect. If you're using the ",(0,r.jsx)(t.a,{href:"/administration/fabrics/prophecy-fabrics/",children:"Prophecy In Memory"}),", use DuckDB dialect."]})}),"\n",(0,r.jsx)(t.admonition,{type:"tip",children:(0,r.jsx)(t.p,{children:"To reference the input table in the SQL query, use the name of the gem that generates the input table."})}),"\n",(0,r.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,r.jsxs)(t.p,{children:["Assume you have a gem named ",(0,r.jsx)(t.code,{children:"weather_predictions"}),". It outputs the following table."]}),"\n",(0,r.jsx)("div",{class:"table-example",children:(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"DatePrediction"}),(0,r.jsx)(t.th,{children:"TemperatureCelsius"}),(0,r.jsx)(t.th,{children:"HumidityPercent"}),(0,r.jsx)(t.th,{children:"WindSpeed"}),(0,r.jsx)(t.th,{children:"Condition"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2025-03-01"}),(0,r.jsx)(t.td,{children:"15"}),(0,r.jsx)(t.td,{children:"65"}),(0,r.jsx)(t.td,{children:"10"}),(0,r.jsx)(t.td,{children:"Sunny"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2025-03-02"}),(0,r.jsx)(t.td,{children:"17"}),(0,r.jsx)(t.td,{children:"70"}),(0,r.jsx)(t.td,{children:"12"}),(0,r.jsx)(t.td,{children:"Cloudy"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2025-03-03"}),(0,r.jsx)(t.td,{children:"16"}),(0,r.jsx)(t.td,{children:"68"}),(0,r.jsx)(t.td,{children:"11"}),(0,r.jsx)(t.td,{children:"Rainy"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2025-03-04"}),(0,r.jsx)(t.td,{children:"14"}),(0,r.jsx)(t.td,{children:"72"}),(0,r.jsx)(t.td,{children:"9"}),(0,r.jsx)(t.td,{children:"Sunny"})]})]})]})}),"\n",(0,r.jsx)(t.p,{children:"To filter out predictions before March 3:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"Add a SQLStatement gem to the canvas."}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["Connect the ",(0,r.jsx)(t.code,{children:"weather_predictions"})," gem to the SQLStatement gem directly in the canvas."]}),"\n",(0,r.jsxs)(t.p,{children:["Alternatively, add an input port in the gem configuration and choose the ",(0,r.jsx)(t.code,{children:"weather_predictions"})," gem for ",(0,r.jsx)(t.strong,{children:"in0"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"In the code editor, paste the following query."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sql",children:"SELECT *\nFROM weather_predictions\nWHERE DatePrediction > '2025-03-02'\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This query uses the gem name ",(0,r.jsx)(t.code,{children:"weather_predictions"})," as the table name in the SELECT statement."]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"Run the gem. The following table appears as the gem output."}),"\n",(0,r.jsx)("div",{class:"table-example",children:(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"DatePrediction"}),(0,r.jsx)(t.th,{children:"TemperatureCelsius"}),(0,r.jsx)(t.th,{children:"HumidityPercent"}),(0,r.jsx)(t.th,{children:"WindSpeed"}),(0,r.jsx)(t.th,{children:"Condition"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2025-03-03"}),(0,r.jsx)(t.td,{children:"16"}),(0,r.jsx)(t.td,{children:"68"}),(0,r.jsx)(t.td,{children:"11"}),(0,r.jsx)(t.td,{children:"Rainy"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2025-03-04"}),(0,r.jsx)(t.td,{children:"14"}),(0,r.jsx)(t.td,{children:"72"}),(0,r.jsx)(t.td,{children:"9"}),(0,r.jsx)(t.td,{children:"Sunny"})]})]})]})}),"\n"]}),"\n"]})]})}function x(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);