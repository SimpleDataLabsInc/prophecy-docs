"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[38971],{28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>r});var t=s(96540);const i={},d=t.createContext(i);function l(e){const n=t.useContext(d);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(d.Provider,{value:n},e.children)}},59226:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>h,contentTitle:()=>c,default:()=>x,frontMatter:()=>r,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"analysts/development/gems/join-split/union-by-name","title":"UnionByName","description":"Combine datasets by aligning columns with the same name","source":"@site/docs/analysts/development/gems/join-split/union-by-name.md","sourceDirName":"analysts/development/gems/join-split","slug":"/analysts/union-by-name","permalink":"/analysts/union-by-name","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"UnionByName","id":"union-by-name","slug":"/analysts/union-by-name","description":"Combine datasets by aligning columns with the same name","tags":[]},"sidebar":"mySidebar","previous":{"title":"Union","permalink":"/analysts/union"},"next":{"title":"Intersect","permalink":"/analysts/intersect"}}');var i=s(74848),d=s(28453),l=s(82824);const r={title:"UnionByName",id:"union-by-name",slug:"/analysts/union-by-name",description:"Combine datasets by aligning columns with the same name",tags:[]},c=void 0,h={},a=[{value:"Input and Output",id:"input-and-output",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Example",id:"example",level:2},{value:"Table A",id:"table-a",level:3},{value:"Table B",id:"table-b",level:3},{value:"Result",id:"result",level:3}];function o(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.A,{execution_engine:"SQL Warehouse",sql_package_name:"ProphecyDatabricksSqlBasics",sql_package_version:"0.0.4+"}),"\n",(0,i.jsx)(n.p,{children:"Use the UnionByName gem to combine rows from multiple datasets by matching column names. This can help when working with data from different sources where schemas might vary slightly in order or structure, but the column names are consistent."}),"\n",(0,i.jsx)(n.h2,{id:"input-and-output",children:"Input and Output"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Port"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"in0"})}),(0,i.jsx)(n.td,{children:"The first input table."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"in1"})}),(0,i.jsx)(n.td,{children:"The second input table."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"inN"})}),(0,i.jsx)(n.td,{children:"Optional: Additional input tables to include in the union."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"out"})}),(0,i.jsx)(n.td,{children:"A single table containing the combined rows, with columns matched by name."})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["To add additional input ports, click ",(0,i.jsx)(n.code,{children:"+"})," next to ",(0,i.jsx)(n.strong,{children:"Ports"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Operation Type"}),(0,i.jsxs)(n.td,{children:["Choose between two different operations.",(0,i.jsxs)("ul",{class:"table-list",children:[(0,i.jsx)("li",{children:"Union By Name (No Missing Columns): All columns must be present in both tables."}),(0,i.jsx)("li",{children:"Union By Name (Allow Missing Columns): Columns do not have to match between tables."})]})]})]})})]}),"\n",(0,i.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,i.jsxs)(n.p,{children:["Let\u2019s say you\u2019re working with two tables: ",(0,i.jsx)(n.strong,{children:"Table A"})," and ",(0,i.jsx)(n.strong,{children:"Table B"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Both tables contain order-related data."}),"\n",(0,i.jsxs)(n.li,{children:["Table B is missing the ",(0,i.jsx)(n.code,{children:"amount"})," column that exists in Table A."]}),"\n",(0,i.jsxs)(n.li,{children:["The columns in ",(0,i.jsx)(n.strong,{children:"Table B"})," that match ",(0,i.jsx)(n.strong,{children:"Table A"})," are ordered differently."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"table-a",children:"Table A"}),"\n",(0,i.jsx)("div",{class:"table-example",children:(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"order_id"}),(0,i.jsx)(n.th,{children:"customer_id"}),(0,i.jsx)(n.th,{children:"order_date"}),(0,i.jsx)(n.th,{children:"amount"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"101"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2024-12-01"}),(0,i.jsx)(n.td,{children:"250.00"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"102"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"2024-12-03"}),(0,i.jsx)(n.td,{children:"150.00"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"103"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2025-01-15"}),(0,i.jsx)(n.td,{children:"300.00"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"104"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"2025-02-10"}),(0,i.jsx)(n.td,{children:"200.00"})]})]})]})}),"\n",(0,i.jsx)(n.h3,{id:"table-b",children:"Table B"}),"\n",(0,i.jsx)("div",{class:"table-example",children:(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"order_id"}),(0,i.jsx)(n.th,{children:"order_date"}),(0,i.jsx)(n.th,{children:"customer_id"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"103"}),(0,i.jsx)(n.td,{children:"2025-01-15"}),(0,i.jsx)(n.td,{children:"1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"104"}),(0,i.jsx)(n.td,{children:"2025-02-10"}),(0,i.jsx)(n.td,{children:"3"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"105"}),(0,i.jsx)(n.td,{children:"2025-03-05"}),(0,i.jsx)(n.td,{children:"4"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"106"}),(0,i.jsx)(n.td,{children:"2025-03-07"}),(0,i.jsx)(n.td,{children:"2"})]})]})]})}),"\n",(0,i.jsx)(n.h3,{id:"result",children:"Result"}),"\n",(0,i.jsxs)(n.p,{children:["The table below shows the output after running a UnionByName gem with ",(0,i.jsx)(n.strong,{children:"Allow Missing Columns"})," enabled."]}),"\n",(0,i.jsxs)(n.p,{children:["Since ",(0,i.jsx)(n.strong,{children:"Table B"})," doesn\u2019t have the ",(0,i.jsx)(n.code,{children:"amount"})," column, Prophecy fills in null values for rows coming from Table B."]}),"\n",(0,i.jsx)("div",{class:"table-example",children:(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"order_id"}),(0,i.jsx)(n.th,{children:"customer_id"}),(0,i.jsx)(n.th,{children:"order_date"}),(0,i.jsx)(n.th,{children:"amount"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"101"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2024-12-01"}),(0,i.jsx)(n.td,{children:"250.00"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"102"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"2024-12-03"}),(0,i.jsx)(n.td,{children:"150.00"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"103"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2025-01-15"}),(0,i.jsx)(n.td,{children:"300.00"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"104"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"2025-02-10"}),(0,i.jsx)(n.td,{children:"200.00"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"103"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2025-01-15"}),(0,i.jsx)(n.td,{children:"NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"104"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"2025-02-10"}),(0,i.jsx)(n.td,{children:"NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"105"}),(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"2025-03-05"}),(0,i.jsx)(n.td,{children:"NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"106"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"2025-03-07"}),(0,i.jsx)(n.td,{children:"NULL"})]})]})]})}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsxs)(n.p,{children:["This example will fail if you select ",(0,i.jsx)(n.strong,{children:"No Missing Columns"})," in the gem settings, since ",(0,i.jsx)(n.strong,{children:"Table B"})," is missing a column in ",(0,i.jsx)(n.strong,{children:"Table A"}),"."]})})]})}function x(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},82824:(e,n,s)=>{s.d(n,{A:()=>i});s(96540);var t=s(74848);function i(e){return(0,t.jsxs)("div",{children:[e.execution_engine&&(0,t.jsx)("a",{href:"https://docs.prophecy.io/administration/fabrics/prophecy-fabrics/",children:(0,t.jsx)("span",{className:"badge",children:e.execution_engine})}),e.sql_package_name&&e.sql_package_version&&(0,t.jsx)("a",{href:"https://docs.prophecy.io/engineers/package-hub/",children:(0,t.jsxs)("span",{className:"badge-dependency",children:[(0,t.jsx)("span",{className:"left",children:e.sql_package_name}),(0,t.jsx)("span",{className:"right",children:e.sql_package_version})]})}),(0,t.jsx)("br",{}),(0,t.jsx)("br",{})]})}}}]);