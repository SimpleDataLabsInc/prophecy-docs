"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[62745],{28453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>o});var a=r(96540);const i={},t=a.createContext(i);function s(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),a.createElement(t.Provider,{value:n},e.children)}},37826:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>u,contentTitle:()=>c,default:()=>m,frontMatter:()=>l,metadata:()=>a,toc:()=>h});const a=JSON.parse('{"id":"Spark/gems/transform/window-function","title":"WindowFunction gem","description":"Aggregate and transform Windowed data","source":"@site/docs/Spark/gems/transform/window-function.md","sourceDirName":"Spark/gems/transform","slug":"/engineers/window-function","permalink":"/engineers/window-function","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"gems","permalink":"/tags/gems"},{"inline":true,"label":"window","permalink":"/tags/window"},{"inline":true,"label":"aggregate","permalink":"/tags/aggregate"}],"version":"current","frontMatter":{"title":"WindowFunction gem","id":"window-function","slug":"/engineers/window-function","description":"Aggregate and transform Windowed data","tags":["gems","window","aggregate"]},"sidebar":"mySidebar","previous":{"title":"Unpivot gem","permalink":"/engineers/unpivot"},"next":{"title":"Join & Split","permalink":"/engineers/join-split"}}');var i=r(74848),t=r(28453),s=r(49235),o=r(65537),d=r(79329);const l={title:"WindowFunction gem",id:"window-function",slug:"/engineers/window-function",description:"Aggregate and transform Windowed data",tags:["gems","window","aggregate"]},c=void 0,u={},h=[{value:"Parameters",id:"parameters",level:2},{value:"Partition By",id:"partition-by",level:3},{value:"OrderBy",id:"orderby",level:3},{value:"Frame",id:"frame",level:3},{value:"Row Frame",id:"row-frame",level:4},{value:"Range Frame",id:"range-frame",level:4},{value:"WindowUse",id:"windowuse",level:3},{value:"Examples",id:"examples",level:2},{value:"Ranking Functions with Window",id:"ranking-functions-with-window",level:3},{value:"Analytical Functions with Window",id:"analytical-functions-with-window",level:3},{value:"Aggregate Functions with Window",id:"aggregate-functions-with-window",level:3}];function p(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.A,{python_package_name:"ProphecySparkBasicsPython",python_package_version:"0.0.1+",scala_package_name:"ProphecySparkBasicsScala",scala_package_version:"0.0.1+",scala_lib:"",python_lib:"",uc_single:"14.3+",uc_shared:"14.3+",livy:"3.0.1+"}),"\n",(0,i.jsx)(n.p,{children:"The WindowFunction gem lets you apply window functions on a DataFrame."}),"\n",(0,i.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsx)(n.p,{children:"Explore the following sections to understand how to configure the WindowFunction gem."}),"\n",(0,i.jsx)(n.h3,{id:"partition-by",children:"Partition By"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Required"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Partition column"}),(0,i.jsx)(n.td,{children:"Column to partition the data by in the Window function"}),(0,i.jsx)(n.td,{children:"False"})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"orderby",children:"OrderBy"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Required"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Order columns"}),(0,i.jsx)(n.td,{children:"Columns to order the data by in the window."}),(0,i.jsx)(n.td,{children:"False"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Sort"}),(0,i.jsx)(n.td,{children:"Sort in ascending or descending order."}),(0,i.jsx)(n.td,{children:"Required if order column is defined"})]})]})]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Order columns are required when the source expression in the WindowUse tab uses ",(0,i.jsx)(n.strong,{children:"ranking"})," or ",(0,i.jsx)(n.strong,{children:"analytical"})," functions. Numeric columns are required when ",(0,i.jsx)(n.strong,{children:"range frame"})," is the selected window frame type."]})}),"\n",(0,i.jsx)(n.h3,{id:"frame",children:"Frame"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Required"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Row frame"}),(0,i.jsx)(n.td,{children:"Row-based frame boundary to apply on the Window"}),(0,i.jsx)(n.td,{children:"False"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Range frame"}),(0,i.jsx)(n.td,{children:"Range-based frame boundary to apply on the Window"}),(0,i.jsx)(n.td,{children:"False"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"row-frame",children:"Row Frame"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"Row Frame"})," option defines the window size based on the number of rows before and after the current row."]}),"\n",(0,i.jsxs)(n.p,{children:["You configure the frame by setting a ",(0,i.jsx)(n.strong,{children:"Start"})," and an ",(0,i.jsx)(n.strong,{children:"End"})," boundary. The boundaries can be:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Unbounded Preceding: Includes all rows before the current row."}),"\n",(0,i.jsx)(n.li,{children:"Unbounded Following: Includes all rows after the current row."}),"\n",(0,i.jsx)(n.li,{children:"Current Row: Starts or ends at the current row."}),"\n",(0,i.jsx)(n.li,{children:"Row Number: A specific number of rows before or after the current row."}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"range-frame",children:"Range Frame"}),"\n",(0,i.jsx)(n.p,{children:"The Range Frame defines the window using values in the Order By column."}),"\n",(0,i.jsxs)(n.p,{children:["You configure the frame by setting a ",(0,i.jsx)(n.strong,{children:"Start"})," and an ",(0,i.jsx)(n.strong,{children:"End"})," boundary. The boundaries can be:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Unbounded Preceding: Includes all rows before the current row."}),"\n",(0,i.jsx)(n.li,{children:"Unbounded Following: Includes all rows after the current row."}),"\n",(0,i.jsx)(n.li,{children:"Current Row: Starts or ends at the current row."}),"\n",(0,i.jsx)(n.li,{children:"Range Value: A numeric or interval value defining how far before or after the current row to look."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Because the Range Frame depends on actual data values (not row positions), the number of rows in the window may vary for each record. For example, some window frames may include only one match within 5 days, while others may include ten."}),"\n",(0,i.jsx)(n.h3,{id:"windowuse",children:"WindowUse"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Required"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Target Column"}),(0,i.jsx)(n.td,{children:"Name of the column that will contain the values returned from the source expression(s)."}),(0,i.jsx)(n.td,{children:"True"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Source expression"}),(0,i.jsx)(n.td,{children:"Window function expression to apply over the window frame."}),(0,i.jsx)(n.td,{children:"True"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(n.h3,{id:"ranking-functions-with-window",children:"Ranking Functions with Window"}),"\n",(0,i.jsxs)(n.p,{children:["Examples of ranking functions are: ",(0,i.jsx)(n.code,{children:"row_number()"}),", ",(0,i.jsx)(n.code,{children:"rank()"}),", ",(0,i.jsx)(n.code,{children:"dense_rank()"})," and ",(0,i.jsx)(n.code,{children:"ntile()"}),"."]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Tab"}),(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"PartitionBy"}),(0,i.jsx)(n.td,{children:"PartitionColumn"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"customer_id"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"OrderBy"}),(0,i.jsx)(n.td,{children:"Order Columns"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"order_date"})," in ascending order"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"WindowUse"}),(0,i.jsx)(n.td,{children:"Source Expressions"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"row_number()"})," and ",(0,i.jsx)(n.code,{children:"ntile(2)"})]})]})]})]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Only the default window frame ",(0,i.jsx)(n.code,{children:"(rowFrame, unboundedPreceding, currentRow)"})," can be used with ranking functions."]})}),"\n","\n",(0,i.jsxs)(o.A,{children:[(0,i.jsx)(d.A,{value:"py",label:"Python",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'def rank_cust_orders(spark: SparkSession, in0: DataFrame) -> DataFrame:\n    return in0\\\n        .withColumn(\n            "order_number",\n            row_number().over(\n                Window.partitionBy(col("customer_id")).orderBy(col("order_date").asc())\n            )\n        )\\\n        .withColumn(\n            "order_recency",\n             ntile(2).over(\n                 Window.partitionBy(col("customer_id")).orderBy(col("order_date").asc())\n             )\n         )\n'})})}),(0,i.jsx)(d.A,{value:"scala",label:"Scala",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:'object rank_cust_orders {\n\n  def apply(spark: SparkSession, in1: DataFrame): DataFrame = {\n    import org.apache.spark.sql.expressions.{Window, WindowSpec}\n    in1\n      .withColumn(\n        "order_number",\n        row_number().over(\n          Window.partitionBy(col("customer_id")).orderBy(col("order_date").asc)\n        )\n      )\n      .withColumn(\n        "order_recency",\n        ntile(2).over(\n          Window.partitionBy(col("customer_id")).orderBy(col("order_date").asc)\n        )\n      )\n  }\n}\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"analytical-functions-with-window",children:"Analytical Functions with Window"}),"\n",(0,i.jsxs)(n.p,{children:["Examples of analytical functions are: ",(0,i.jsx)(n.code,{children:"lead()"}),", ",(0,i.jsx)(n.code,{children:"lag()"}),", ",(0,i.jsx)(n.code,{children:"cume_dist()"}),", etc."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Window frame for ",(0,i.jsx)(n.code,{children:"lead()"})," and ",(0,i.jsx)(n.code,{children:"lag()"})," can not be specified."]}),"\n",(0,i.jsxs)(n.li,{children:["Only the default window frame ",(0,i.jsx)(n.code,{children:"(rangeFrame, unboundedPreceding, currentRow)"})," can be used with ",(0,i.jsx)(n.code,{children:"cume_dist()"}),"."]}),"\n"]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Example usage of Window - Analytical",src:r(80232).A+"",width:"1920",height:"1080"})}),"\n",(0,i.jsxs)(o.A,{children:[(0,i.jsx)(d.A,{value:"py",label:"Python",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'def analyse_orders(spark: SparkSession, in0: DataFrame) -> DataFrame:\n    return in0\\\n        .withColumn(\n          "previous_order_date",\n          lag(col("order_date")).over(\n            Window.partitionBy(col("customer_id")).orderBy(col("order_id").asc())\n          )\n        )\\\n        .withColumn(\n            "next_order_date",\n            lead(col("order_date")).over(\n                Window.partitionBy(col("customer_id")).orderBy(col("order_id").asc())\n            )\n        )\n'})})}),(0,i.jsx)(d.A,{value:"scala",label:"Scala",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:'object analyse_orders {\n  def apply(spark: SparkSession, in1: DataFrame): DataFrame = {\n    import org.apache.spark.sql.expressions.{Window, WindowSpec}\n    in1\n      .withColumn(\n        "previous_order_date",\n        lag(col("order_date")).over(\n          Window.partitionBy(col("customer_id")).orderBy(col("order_date").asc)\n        )\n      )\n      .withColumn(\n        "next_order_date",\n        lead(col("order_date")).over(\n          Window.partitionBy(col("customer_id")).orderBy(col("order_date").asc)\n        )\n      )\n  }\n}\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"aggregate-functions-with-window",children:"Aggregate Functions with Window"}),"\n",(0,i.jsxs)(n.p,{children:["Examples of aggregate functions are: ",(0,i.jsx)(n.code,{children:"min()"}),", ",(0,i.jsx)(n.code,{children:"max()"}),", ",(0,i.jsx)(n.code,{children:"avg()"}),", etc."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Example usage of Window - Aggregate",src:r(45843).A+"",width:"1847",height:"1016"})}),"\n",(0,i.jsxs)(o.A,{children:[(0,i.jsx)(d.A,{value:"py",label:"Python",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'def agg_orders(spark: SparkSession, in0: DataFrame) -> DataFrame:\n    return in0\\\n        .withColumn(\n          "running_avg_spend",\n          avg(col("amount"))\\\n            .over(Window.partitionBy(col("customer_id"))\\\n                    .rowsBetween(Window.unboundedPreceding, Window.currentRow))\n        )\\\n        .withColumn("running_max_spend", max(col("amount"))\\\n        .over(Window.partitionBy(col("customer_id"))\\\n                .rowsBetween(Window.unboundedPreceding, Window.currentRow)))\n'})})}),(0,i.jsx)(d.A,{value:"scala",label:"Scala",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scala",children:'object agg_orders {\n  def apply(spark: SparkSession, in1: DataFrame): DataFrame = {\n    import org.apache.spark.sql.expressions.{Window, WindowSpec}\n    in1\n      .withColumn("running_avg_spend",\n                  avg(col("amount")).over(\n                    Window\n                      .partitionBy(col("customer_id"))\n                      .rowsBetween(Window.unboundedPreceding, Window.currentRow)\n                  )\n      )\n      .withColumn("running_max_spend",\n                  max(col("amount")).over(\n                    Window\n                      .partitionBy(col("customer_id"))\n                      .rowsBetween(Window.unboundedPreceding, Window.currentRow)\n                  )\n      )\n  }\n}\n'})})})]})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}},45843:(e,n,r)=>{r.d(n,{A:()=>a});const a=r.p+"assets/images/window_eg_agg-8a34b6829ab9ac882ccba44db524a903.png"},49235:(e,n,r)=>{r.d(n,{A:()=>i});r(96540);var a=r(74848);function i(e){return(0,a.jsxs)("div",{children:[e.python_package_name&&e.python_package_version&&(0,a.jsx)("a",{href:"https://docs.prophecy.io/engineers/package-hub/",children:(0,a.jsxs)("span",{className:"badge badge-dependency",children:[e.python_package_name," ",e.python_package_version]})}),e.scala_package_name&&e.scala_package_version&&(0,a.jsx)("a",{href:"https://docs.prophecy.io/engineers/package-hub",children:(0,a.jsxs)("span",{className:"badge badge-dependency",children:[e.scala_package_name," ",e.scala_package_version]})}),e.python_lib&&(0,a.jsx)("a",{href:"https://docs.prophecy.io/extensibility/dependencies/prophecy-libraries",children:(0,a.jsxs)("span",{className:"badge badge-dependency",children:["ProphecyLibsPython ",e.python_lib]})}),e.scala_lib&&(0,a.jsx)("a",{href:"https://docs.prophecy.io/extensibility/dependencies/prophecy-libraries",children:(0,a.jsxs)("span",{className:"badge badge-dependency",children:["ProphecyLibsScala ",e.scala_lib]})}),e.uc_single&&(0,a.jsx)("a",{href:"https://docs.prophecy.io/administration/fabrics/Spark-fabrics/databricks/ucshared",children:(0,a.jsxs)("span",{className:"badge badge-spark",children:["UC Dedicated Cluster ",e.uc_single]})}),e.uc_shared&&(0,a.jsx)("a",{href:"https://docs.prophecy.io/administration/fabrics/Spark-fabrics/databricks/ucshared",children:(0,a.jsxs)("span",{className:"badge badge-spark",children:["UC Standard Cluster ",e.uc_shared]})}),e.livy&&(0,a.jsx)("a",{href:"https://docs.prophecy.io/administration/fabrics/Spark-fabrics/livy",children:(0,a.jsxs)("span",{className:"badge badge-spark",children:["Livy ",e.livy]})}),(0,a.jsx)("br",{}),(0,a.jsx)("br",{})]})}},65537:(e,n,r)=>{r.d(n,{A:()=>v});var a=r(96540),i=r(18215),t=r(65627),s=r(56347),o=r(50372),d=r(30604),l=r(11861),c=r(78749);function u(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:r}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:r,attributes:a,default:i}}=e;return{value:n,label:r,attributes:a,default:i}}))}(r);return function(e){const n=(0,l.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,r])}function p(e){let{value:n,tabValues:r}=e;return r.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:r}=e;const i=(0,s.W6)(),t=function(e){let{queryString:n=!1,groupId:r}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:n,groupId:r});return[(0,d.aZ)(t),(0,a.useCallback)((e=>{if(!t)return;const n=new URLSearchParams(i.location.search);n.set(t,e),i.replace({...i.location,search:n.toString()})}),[t,i])]}function x(e){const{defaultValue:n,queryString:r=!1,groupId:i}=e,t=h(e),[s,d]=(0,a.useState)((()=>function(e){let{defaultValue:n,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const a=r.find((e=>e.default))??r[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:t}))),[l,u]=m({queryString:r,groupId:i}),[x,g]=function(e){let{groupId:n}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,t]=(0,c.Dv)(r);return[i,(0,a.useCallback)((e=>{r&&t.set(e)}),[r,t])]}({groupId:i}),w=(()=>{const e=l??x;return p({value:e,tabValues:t})?e:null})();(0,o.A)((()=>{w&&d(w)}),[w]);return{selectedValue:s,selectValue:(0,a.useCallback)((e=>{if(!p({value:e,tabValues:t}))throw new Error(`Can't select invalid tab value=${e}`);d(e),u(e),g(e)}),[u,g,t]),tabValues:t}}var g=r(9136);const w={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=r(74848);function b(e){let{className:n,block:r,selectedValue:a,selectValue:s,tabValues:o}=e;const d=[],{blockElementScrollPositionUntilNextRender:l}=(0,t.a_)(),c=e=>{const n=e.currentTarget,r=d.indexOf(n),i=o[r].value;i!==a&&(l(n),s(i))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const r=d.indexOf(e.currentTarget)+1;n=d[r]??d[0];break}case"ArrowLeft":{const r=d.indexOf(e.currentTarget)-1;n=d[r]??d[d.length-1];break}}n?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":r},n),children:o.map((e=>{let{value:n,label:r,attributes:t}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:a===n?0:-1,"aria-selected":a===n,ref:e=>{d.push(e)},onKeyDown:u,onClick:c,...t,className:(0,i.A)("tabs__item",w.tabItem,t?.className,{"tabs__item--active":a===n}),children:r??n},n)}))})}function f(e){let{lazy:n,children:r,selectedValue:t}=e;const s=(Array.isArray(r)?r:[r]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===t));return e?(0,a.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function y(e){const n=x(e);return(0,j.jsxs)("div",{className:(0,i.A)("tabs-container",w.tabList),children:[(0,j.jsx)(b,{...n,...e}),(0,j.jsx)(f,{...n,...e})]})}function v(e){const n=(0,g.A)();return(0,j.jsx)(y,{...e,children:u(e.children)},String(n))}},79329:(e,n,r)=>{r.d(n,{A:()=>s});r(96540);var a=r(18215);const i={tabItem:"tabItem_Ymn6"};var t=r(74848);function s(e){let{children:n,hidden:r,className:s}=e;return(0,t.jsx)("div",{role:"tabpanel",className:(0,a.A)(i.tabItem,s),hidden:r,children:n})}},80232:(e,n,r)=>{r.d(n,{A:()=>a});const a=r.p+"assets/images/window_eg_analytical-f61582f4e18249a8c33cf5a3210326e4.png"}}]);