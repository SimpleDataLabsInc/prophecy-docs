"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[73590],{2244:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/1-create-connection-32e780af5ae3aae96d48e0f88b34cf15.png"},7153:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/2-add-gem-51174acca3a1248cd4d1527fdc38260a.png"},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var a=t(96540);const s={},i=a.createContext(s);function o(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(i.Provider,{value:n},e.children)}},40876:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"administration/metadata-connections","title":"Metadata connections","description":"Sync catalogs, tables, schemas, etc into Prophecy\'s project viewer","source":"@site/docs/administration/metadata-connections.md","sourceDirName":"administration","slug":"/administration/metadata-connections","permalink":"/administration/metadata-connections","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"metadata","permalink":"/tags/metadata"},{"inline":true,"label":"datasets","permalink":"/tags/datasets"},{"inline":true,"label":"tables","permalink":"/tags/tables"},{"inline":true,"label":"connections","permalink":"/tags/connections"},{"inline":true,"label":"data","permalink":"/tags/data"}],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Metadata connections","id":"metadata-connections","description":"Sync catalogs, tables, schemas, etc into Prophecy\'s project viewer","sidebar_position":1,"tags":["metadata","datasets","tables","connections","data"]},"sidebar":"adminSidebar","previous":{"title":"Secret Management For Spark Fabrics","permalink":"/administration/secret-management/"},"next":{"title":"Settings","permalink":"/administration/settings/"}}');var s=t(74848),i=t(28453);const o={title:"Metadata connections",id:"metadata-connections",description:"Sync catalogs, tables, schemas, etc into Prophecy's project viewer",sidebar_position:1,tags:["metadata","datasets","tables","connections","data"]},c=void 0,r={},d=[{value:"Metadata connection setup",id:"metadata-connection-setup",level:2},{value:"Metadata connection usage",id:"metadata-connection-usage",level:2},{value:"Execution environment requirements",id:"execution-environment-requirements",level:2},{value:"SQL warehouses or clusters",id:"sql-warehouses-or-clusters",level:3},{value:"Provider tokens",id:"provider-tokens",level:3},{value:"Permissions",id:"permissions",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["When you create a metadata connection in a ",(0,s.jsx)(n.a,{href:"/concepts/fabrics/",children:"fabric"}),", Prophecy can connect to the data provider (like Databricks) and ",(0,s.jsx)(n.strong,{children:"cache metadata on a regular basis"}),". If you have thousands of objects, such as tables or views, this continuous sync can make fetching objects much faster in Prophecy\u2014particularly in the Environment tab of the ",(0,s.jsx)(n.a,{href:"/concepts/project/#project-editor",children:"Project Editor"}),"."]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Different from metadata connections, Prophecy also supports Airflow connections which perform a similar function for Airflow jobs."})}),"\n",(0,s.jsx)(n.h2,{id:"metadata-connection-setup",children:"Metadata connection setup"}),"\n",(0,s.jsx)(n.p,{children:"Metadata connections are set up inside individual fabrics. This means that anyone with access to the fabric can take advantage of the metadata connection."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Initiate the creation of a new fabric."}),"\n",(0,s.jsxs)(n.li,{children:["In the ",(0,s.jsx)(n.strong,{children:"Connections"})," tab, add a new connection."]}),"\n",(0,s.jsxs)(n.li,{children:["Define a ",(0,s.jsx)(n.strong,{children:"Connection Name"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Give the connection a ",(0,s.jsx)(n.strong,{children:"Description"})," (optional)."]}),"\n",(0,s.jsxs)(n.li,{children:["Add the ",(0,s.jsx)(n.strong,{children:"Workspace URL"})," for the connection. For example, this could be a Databricks workspace URL. In this case, the connection would sync all accessible Data Catalogs."]}),"\n",(0,s.jsxs)(n.li,{children:["If you choose to define a ",(0,s.jsx)(n.strong,{children:"JDBC URL"})," different than that defined in the fabric, the Metadata Connection JDBC will be the only JDBC included in the syncing."]}),"\n",(0,s.jsxs)(n.li,{children:["Add the ",(0,s.jsx)(n.strong,{children:"Access Token"})," for the connection (if different from the fabric). More information on access tokens can be found below."]}),"\n",(0,s.jsxs)(n.li,{children:["Fill in the ",(0,s.jsx)(n.strong,{children:"Refresh Frequency"})," at which you want Prophecy to sync the metadata."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enable"})," the metadata connection."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Add"})," the metadata connection to save it."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"CreateConnection",src:t(2244).A+"",width:"2880",height:"1726"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"While you can create multiple metadata connections per fabric, only one connection can be enabled at a time."})}),"\n",(0,s.jsx)(n.h2,{id:"metadata-connection-usage",children:"Metadata connection usage"}),"\n",(0,s.jsx)(n.p,{children:"To use a metadata connection in a project:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Attach to a fabric that has a metadata connection."}),"\n",(0,s.jsx)(n.li,{children:"Open the Environment tab to access the data."}),"\n",(0,s.jsx)(n.li,{children:"Note the workspace that is synced at the frequency defined in the metadata connection."}),"\n",(0,s.jsx)(n.li,{children:"Add a table to the canvas as a dataset."}),"\n",(0,s.jsxs)(n.li,{children:["Define whether your dataset should be added as a ",(0,s.jsx)(n.a,{href:"/Spark/gems/source-target/",children:"Source or Target"})," gem."]}),"\n",(0,s.jsx)(n.li,{children:"Now the dataset appears on the canvas, ready for transformations."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"AddGem",src:t(7153).A+"",width:"2880",height:"1726"})}),"\n",(0,s.jsx)(n.h2,{id:"execution-environment-requirements",children:"Execution environment requirements"}),"\n",(0,s.jsx)(n.h3,{id:"sql-warehouses-or-clusters",children:"SQL warehouses or clusters"}),"\n",(0,s.jsxs)(n.p,{children:["Prophecy supports metadata collection through SQL warehouses and clusters on Databricks and Snowflake. In general, we recommend creating a ",(0,s.jsx)(n.a,{href:"https://docs.databricks.com/en/sql/admin/create-sql-warehouse.html#create-a-sql-warehouse",children:"SQL warehouse"})," or cluster dedicated to the metadata connection. Using this approach, the recurring metadata syncs can have a cluster defined with appropriate resources, whereas execution clusters defined in the ",(0,s.jsx)(n.a,{href:"/concepts/fabrics/",children:"fabric"})," would have a separate resource profile."]}),"\n",(0,s.jsx)(n.h3,{id:"provider-tokens",children:"Provider tokens"}),"\n",(0,s.jsxs)(n.p,{children:["Prophecy metadata connections use APIs to make calls to your data provider accounts. For this access, a service principal is recommended. For Databricks providers, follow these ",(0,s.jsx)(n.a,{href:"https://docs.databricks.com/en/dev-tools/service-principals.html#provision-a-service-principal-for-databricks-automation---databricks-ui",children:"instructions"})," to create a service principal and associated token. If you are unable to set up a service principal, use a standard Personal Access Token."]}),"\n",(0,s.jsx)(n.h3,{id:"permissions",children:"Permissions"}),"\n",(0,s.jsx)(n.p,{children:"Regardless of the type of credentials you use, those credentials will need to come with access on the environment side to all workspaces, warehouses, or clusters you want to see with the metadata connection."}),"\n",(0,s.jsx)(n.p,{children:"To grant permissions to the service principal on the Unity Catalog (granting the same permission on all schemas within that catalog), run the command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT SELECT ON CATALOG <catalog> TO <service_principal>;\n"})}),"\n",(0,s.jsx)(n.p,{children:"To grant permissions to the service principal for Hive Metastore, run the command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT USAGE, READ_METADATA, SELECT ON CATALOG <hive_metastore> TO <service_principal>;\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);