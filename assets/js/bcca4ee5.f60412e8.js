"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[6626],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return m}});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),d=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=d(e.components);return r.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=d(a),m=n,f=u["".concat(s,".").concat(m)]||u[m]||c[m]||o;return a?r.createElement(f,i(i({ref:t},p),{},{components:a})):r.createElement(f,i({ref:t},p))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var d=2;d<o;d++)i[d]=a[d];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},2360:function(e,t,a){a.d(t,{Z:function(){return i}});var r=a(7294),n=a(6010),o="tabItem_OmH5";function i(e){var t=e.children,a=e.hidden,i=e.className;return r.createElement("div",{role:"tabpanel",className:(0,n.Z)(o,i),hidden:a},t)}},9877:function(e,t,a){a.d(t,{Z:function(){return m}});var r=a(7462),n=a(7294),o=a(2389),i=a(7392),l=a(7094),s=a(2466),d=a(6010),p="tabList_uSqn",c="tabItem_LplD";function u(e){var t,a,o,u=e.lazy,m=e.block,f=e.defaultValue,h=e.values,g=e.groupId,b=e.className,k=n.Children.map(e.children,(function(e){if((0,n.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),N=null!=h?h:k.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),y=(0,i.l)(N,(function(e,t){return e.value===t.value}));if(y.length>0)throw new Error('Docusaurus error: Duplicate values "'+y.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var w=null===f?f:null!=(t=null!=f?f:null==(a=k.find((function(e){return e.props.default})))?void 0:a.props.value)?t:null==(o=k[0])?void 0:o.props.value;if(null!==w&&!N.some((function(e){return e.value===w})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+w+'" but none of its children has the corresponding value. Available values are: '+N.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var v=(0,l.U)(),T=v.tabGroupChoices,C=v.setTabGroupChoices,D=(0,n.useState)(w),E=D[0],S=D[1],j=[],B=(0,s.o5)().blockElementScrollPositionUntilNextRender;if(null!=g){var x=T[g];null!=x&&x!==E&&N.some((function(e){return e.value===x}))&&S(x)}var _=function(e){var t=e.currentTarget,a=j.indexOf(t),r=N[a].value;r!==E&&(B(t),S(r),null!=g&&C(g,r))},O=function(e){var t,a=null;switch(e.key){case"ArrowRight":var r=j.indexOf(e.currentTarget)+1;a=j[r]||j[0];break;case"ArrowLeft":var n=j.indexOf(e.currentTarget)-1;a=j[n]||j[j.length-1]}null==(t=a)||t.focus()};return n.createElement("div",{className:(0,d.Z)("tabs-container",p)},n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,d.Z)("tabs",{"tabs--block":m},b)},N.map((function(e){var t=e.value,a=e.label,o=e.attributes;return n.createElement("li",(0,r.Z)({role:"tab",tabIndex:E===t?0:-1,"aria-selected":E===t,key:t,ref:function(e){return j.push(e)},onKeyDown:O,onFocus:_,onClick:_},o,{className:(0,d.Z)("tabs__item",c,null==o?void 0:o.className,{"tabs__item--active":E===t})}),null!=a?a:t)}))),u?(0,n.cloneElement)(k.filter((function(e){return e.props.value===E}))[0],{className:"margin-top--md"}):n.createElement("div",{className:"margin-top--md"},k.map((function(e,t){return(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==E})}))))}function m(e){var t=(0,o.Z)();return n.createElement(u,(0,r.Z)({key:String(t)},e))}},3467:function(e,t,a){a.r(t),a.d(t,{assets:function(){return u},contentTitle:function(){return p},default:function(){return h},frontMatter:function(){return d},metadata:function(){return c},toc:function(){return m}});var r=a(7462),n=a(3366),o=(a(7294),a(3905)),i=a(9877),l=a(2360),s=["components"],d={title:"JDBC",id:"jdbc",description:"JDBC",sidebar_position:4,tags:["gems","warehouse","jdbc"]},p=void 0,c={unversionedId:"low-code-spark/gems/source-target/warehouse/jdbc",id:"low-code-spark/gems/source-target/warehouse/jdbc",title:"JDBC",description:"JDBC",source:"@site/docs/low-code-spark/gems/source-target/warehouse/jdbc.md",sourceDirName:"low-code-spark/gems/source-target/warehouse",slug:"/low-code-spark/gems/source-target/warehouse/jdbc",permalink:"/low-code-spark/gems/source-target/warehouse/jdbc",draft:!1,tags:[{label:"gems",permalink:"/tags/gems"},{label:"warehouse",permalink:"/tags/warehouse"},{label:"jdbc",permalink:"/tags/jdbc"}],version:"current",sidebarPosition:4,frontMatter:{title:"JDBC",id:"jdbc",description:"JDBC",sidebar_position:4,tags:["gems","warehouse","jdbc"]},sidebar:"defaultSidebar",previous:{title:"Teradata",permalink:"/low-code-spark/gems/source-target/warehouse/teradata"},next:{title:"Oracle",permalink:"/low-code-spark/gems/source-target/warehouse/oracle"}},u={},m=[{value:"Source",id:"source",level:2},{value:"Source Parameters",id:"source-parameters",level:3},{value:"Source Example",id:"source-example",level:3},{value:"Spark Code",id:"spark-code",level:3},{value:"Target",id:"target",level:2},{value:"Target Parameters",id:"target-parameters",level:3},{value:"Target Example",id:"target-example",level:3},{value:"Spark Code",id:"spark-code-1",level:3}],f={toc:m};function h(e){var t=e.components,a=(0,n.Z)(e,s);return(0,o.kt)("wrapper",(0,r.Z)({},f,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Reads data from other databases using JDBC tables and writes data into other databases using jdbc ."),(0,o.kt)("h2",{id:"source"},"Source"),(0,o.kt)("h3",{id:"source-parameters"},"Source Parameters"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Required"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Default"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Credential Type"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Credential Type provider (Databricks Secrets or Username/Password). These can be set in the config options/via databricks secrets for security purpose, so that it's not visible in code."),(0,o.kt)("td",{parentName:"tr",align:"left"},"True"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Credential Scope"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Scope to use for databricks secrets"),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"url"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The JDBC URL of the form jdbc:subprotocol:subname to connect to. The source-specific connection properties may be specified in the URL. e.g., ",(0,o.kt)("br",null)," ",(0,o.kt)("inlineCode",{parentName:"td"},"jdbc:postgresql://test.us-east-1.rds.amazonaws.com:5432/postgres"),",",(0,o.kt)("br",null),"  ",(0,o.kt)("inlineCode",{parentName:"td"},"jdbc:mysql://database-mysql.test.us-east-1.rds.amazonaws.com:3306/mysql")),(0,o.kt)("td",{parentName:"tr",align:"left"},"True"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"dbtable"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The JDBC table that should be read from. Note that when using it in the read path anything that is valid in a FROM clause of a SQL query can be used. For example, instead of a full table you could also use a subquery in parentheses. It is not allowed to specify dbtable and query options at the same time. e.g., ",(0,o.kt)("inlineCode",{parentName:"td"},"db_name.table_name")," or ",(0,o.kt)("inlineCode",{parentName:"td"},"(select col1, col2 from table) as A")),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"query"),(0,o.kt)("td",{parentName:"tr",align:"left"},"A query that will be used to read data into Spark. The specified query will be parenthesized and used as a subquery in the FROM clause. Spark will also assign an alias to the subquery clause. As an example, spark will issue a query of the following form to the JDBC Source.  SELECT columns FROM (<user","_","specified","_","query>) spark","_","gen","_","alias. ",(0,o.kt)("br",null)," ",(0,o.kt)("br",null)," Below are a couple of restrictions while using this option.",(0,o.kt)("br",null)," 1. It is not allowed to specify query and partitionColumn options at the same time. ",(0,o.kt)("br",null),' 2. When specifying partitionColumn option is required, the subquery can be specified using dbtable option instead and partition columns can be qualified using the subquery alias provided as part of dbtable. Example: spark.read.format("jdbc") .option("url", jdbcUrl) .option("query", "select c1, c2 from t1") .load()'),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"driver"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The class name of the JDBC driver to use to connect to this URL. e.g., ",(0,o.kt)("br",null)," For postgres : ",(0,o.kt)("inlineCode",{parentName:"td"},"org.postgresql.Driver")," ",(0,o.kt)("br",null)," For mysql: ",(0,o.kt)("inlineCode",{parentName:"td"},"com.mysql.cj.jdbc.Driver")),(0,o.kt)("td",{parentName:"tr",align:"left"},"True"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Partition Column, Lower Bound, Upper Bound"),(0,o.kt)("td",{parentName:"tr",align:"left"},"These options must all be specified if any of them is specified. In addition, numPartitions must be specified. They describe how to partition the table when reading in parallel from multiple workers. partitionColumn must be a numeric, date, or timestamp column from the table in question. Notice that lowerBound and upperBound are just used to decide the partition stride, not for filtering the rows in table. So all rows in the table will be partitioned and returned. This option applies only to reading. ",(0,o.kt)("br",null)," ",(0,o.kt)("inlineCode",{parentName:"td"},"Note: Dropdown to choose column in partition column would come only once schema is inferred.")),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Number of partitions"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The maximum number of partitions that can be used for parallelism in table reading. This also determines the maximum number of concurrent JDBC connections."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Query Timeout"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The number of seconds the driver will wait for a Statement object to execute to the given number of seconds. Zero means there is no limit. In the write path, this option depends on how JDBC drivers implement the API setQueryTimeout, e.g., the h2 JDBC driver checks the timeout of each query instead of an entire JDBC batch."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"0")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Fetch size"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The JDBC fetch size, which determines how many rows to fetch per round trip. This can help performance on JDBC drivers which default to low fetch size (e.g. Oracle with 10 rows)."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"0")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Session Init Statement"),(0,o.kt)("td",{parentName:"tr",align:"left"},'After each database session is opened to the remote DB and before starting to read data, this option executes a custom SQL statement (or a PL/SQL block). Use this to implement session initialization code. Example: option("sessionInitStatement", """BEGIN execute immediate \'alter session set "',"_","serial","_","direct","_",'read"=true\'; END;""")'),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Push-Down Predicate"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The option to enable or disable predicate push-down into the JDBC data source. The default value is true, in which case Spark will push down filters to the JDBC data source as much as possible. Otherwise, if set to false, no filter will be pushed down to the JDBC data source and thus all filters will be handled by Spark. Predicate push-down is usually turned off when the predicate filtering is performed faster by Spark than by the JDBC data source."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"TRUE")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Push-Down Aggregate"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The option to enable or disable aggregate push-down in V2 JDBC data source. The default value is false, in which case Spark will not push down aggregates to the JDBC data source. Otherwise, if sets to true, aggregates will be pushed down to the JDBC data source. Aggregate push-down is usually turned off when the aggregate is performed faster by Spark than by the JDBC data source. Please note that aggregates can be pushed down if and only if all the aggregate functions and the related filters can be pushed down. Spark assumes that the data source can't fully complete the aggregate and does a final aggregate over the data source output."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"FALSE")))),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Please add the jdbc driver carefully. If you get ",(0,o.kt)("inlineCode",{parentName:"p"},"class not found")," error during running of pipeline then your dependency might be missing in the cluster.\nTo read more about how to add dependencies for specific jdbc jar ",(0,o.kt)("a",{parentName:"p",href:"/low-code-spark/extensibility/dependencies"},(0,o.kt)("strong",{parentName:"a"},"click here"))))),(0,o.kt)("h3",{id:"source-example"},"Source Example"),(0,o.kt)("div",{class:"wistia_responsive_padding",style:{padding:"56.25% 0 0 0",position:"relative"}},(0,o.kt)("div",{class:"wistia_responsive_wrapper",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"}},(0,o.kt)("iframe",{src:"https://user-images.githubusercontent.com/103921419/173814656-1c857949-cd5a-4032-922b-5a621d77fd75.mp4",title:"JDBC source",allow:"autoplay;fullscreen",allowtransparency:"true",frameborder:"0",scrolling:"no",class:"wistia_embed",name:"wistia_embed",msallowfullscreen:!0,width:"100%",height:"100%"}))),(0,o.kt)("h3",{id:"spark-code"},"Spark Code"),(0,o.kt)(i.Z,{mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'def Source(spark: SparkSession) -> DataFrame:\n    return spark.read\\\n        .format("jdbc")\\\n        .option("url", f"{Config.jdbc_url}")\\\n        .option("user", f"{Config.jdbc_username}")\\\n        .option("password", f"{Config.jdbc_password}")\\\n        .option("dbtable", "public.demo_customers_raw")\\\n        .option("pushDownPredicate", True)\\\n        .option("driver", "org.postgresql.Driver")\\\n        .load()\n\n'))),(0,o.kt)(l.Z,{value:"scala",label:"Scala",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},'object Source {\n\n  def apply(spark: SparkSession): DataFrame = {\n    var reader = spark.read\n      .format("jdbc")\n      .option("url",  s"${Config.jdbc_url}")\n      .option("user", s"${Config.jdbc_username}")\n      .option("password", s"${Config.jdbc_password}")\n      .option("dbtable", "public.demo_customers_raw")\n    reader = reader\n      .option("pushDownPredicate", true)\n      .option("driver", "org.postgresql.Driver")\n    reader.load()\n  }\n\n}\n')))),(0,o.kt)("h2",{id:"target"},"Target"),(0,o.kt)("h3",{id:"target-parameters"},"Target Parameters"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Required"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Default"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Credential Type"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Credential Type provider (Databricks Secrets or Username/Password). These can be set in the config options/via databricks secrets for security purpose, so that it's not visible in code."),(0,o.kt)("td",{parentName:"tr",align:"left"},"True"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Credential Scope"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Scope to use for databricks secrets"),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"url"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The JDBC URL of the form jdbc:subprotocol:subname to connect to. The source-specific connection properties may be specified in the URL. e.g., ",(0,o.kt)("br",null)," ",(0,o.kt)("inlineCode",{parentName:"td"},"jdbc:postgresql://test.us-east-1.rds.amazonaws.com:5432/postgres"),",",(0,o.kt)("br",null),"  ",(0,o.kt)("inlineCode",{parentName:"td"},"jdbc:mysql://database-mysql.test.us-east-1.rds.amazonaws.com:3306/mysql")),(0,o.kt)("td",{parentName:"tr",align:"left"},"True"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"table"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The JDBC table that should be written into."),(0,o.kt)("td",{parentName:"tr",align:"left"},"True"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"driver"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The class name of the JDBC driver to use to connect to this URL. e.g., ",(0,o.kt)("br",null)," For postgres : ",(0,o.kt)("inlineCode",{parentName:"td"},"org.postgresql.Driver")," ",(0,o.kt)("br",null)," For mysql: ",(0,o.kt)("inlineCode",{parentName:"td"},"com.mysql.cj.jdbc.Driver")),(0,o.kt)("td",{parentName:"tr",align:"left"},"True"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"numPartitions"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The maximum number of partitions that can be used for parallelism in table writing. This also determines the maximum number of concurrent JDBC connections. If the number of partitions to write exceeds this limit, we decrease it to this limit by calling coalesce(numPartitions) before writing."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"queryTimeout"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The number of seconds the driver will wait for a Statement object to execute to the given number of seconds. Zero means there is no limit. In the write path, this option depends on how JDBC drivers implement the API setQueryTimeout, e.g., the h2 JDBC driver checks the timeout of each query instead of an entire JDBC batch."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"0")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"batchsize"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The JDBC batch size, which determines how many rows to insert per round trip. This can help performance on JDBC drivers. This option applies only to writing."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"1000")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"isolationLevel"),(0,o.kt)("td",{parentName:"tr",align:"left"},"The transaction isolation level, which applies to current connection. It can be one of NONE, READ","_","COMMITTED, READ","_","UNCOMMITTED, REPEATABLE","_","READ, or SERIALIZABLE, corresponding to standard transaction isolation levels defined by JDBC's Connection object, with default of READ","_","UNCOMMITTED. Please refer the documentation in java.sql.Connection."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"READ","_","UNCOMMITTED")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"truncate"),(0,o.kt)("td",{parentName:"tr",align:"left"},"When SaveMode.Overwrite is enabled, this option causes Spark to truncate an existing table instead of dropping and recreating it. This can be more efficient, and prevents the table metadata (e.g., indices) from being removed. However, it will not work in some cases, such as when the new data has a different schema. In case of failures, users should turn off truncate option to use DROP TABLE again. Also, due to the different behavior of TRUNCATE TABLE among DBMS, it's not always safe to use this. MySQLDialect, DB2Dialect, MsSqlServerDialect, DerbyDialect, and OracleDialect supports this while PostgresDialect and default JDBCDirect doesn't. For unknown and unsupported JDBCDirect, the user option truncate is ignored."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"FALSE")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"cascadeTruncate"),(0,o.kt)("td",{parentName:"tr",align:"left"},"If enabled and supported by the JDBC database (PostgreSQL and Oracle at the moment), this options allows execution of a TRUNCATE TABLE t CASCADE (in the case of PostgreSQL a TRUNCATE TABLE ONLY t CASCADE is executed to prevent inadvertently truncating descendant tables). This will affect other tables, and thus should be used with care."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"the default cascading truncate behaviour of the JDBC database in question, specified in the isCascadeTruncate in each JDBCDialect")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"createTableOptions"),(0,o.kt)("td",{parentName:"tr",align:"left"},"If specified, this option allows setting of database-specific table and partition options when creating a table (e.g., CREATE TABLE t (name string) ENGINE=InnoDB.)."),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"})),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"createTableColumnTypes"),(0,o.kt)("td",{parentName:"tr",align:"left"},'The database column data types to use instead of the defaults, when creating the table. Data type information should be specified in the same format as CREATE TABLE columns syntax (e.g: "name CHAR(64), comments VARCHAR(1024)"). The specified types should be valid spark sql data types.'),(0,o.kt)("td",{parentName:"tr",align:"left"},"False"),(0,o.kt)("td",{parentName:"tr",align:"left"},"(none)")))),(0,o.kt)("p",null,"Below are different type of write modes which prophecy provided hive catalog supports."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"Write Mode"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"overwrite"),(0,o.kt)("td",{parentName:"tr",align:"left"},"If data already exists, existing data is expected to be overwritten by the contents of the DataFrame.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"append"),(0,o.kt)("td",{parentName:"tr",align:"left"},"If data already exists, contents of the DataFrame are expected to be appended to existing data.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"ignore"),(0,o.kt)("td",{parentName:"tr",align:"left"},"If data already exists, the save operation is expected not to save the contents of the DataFrame and not to change the existing data. This is similar to a CREATE TABLE IF NOT EXISTS in SQL.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"error"),(0,o.kt)("td",{parentName:"tr",align:"left"},"If data already exists, an exception is expected to be thrown.")))),(0,o.kt)("h3",{id:"target-example"},"Target Example"),(0,o.kt)("div",{class:"wistia_responsive_padding",style:{padding:"56.25% 0 0 0",position:"relative"}},(0,o.kt)("div",{class:"wistia_responsive_wrapper",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"}},(0,o.kt)("iframe",{src:"https://user-images.githubusercontent.com/103921419/173814665-f932bbae-cc4a-4b4b-90e8-09749b714a76.mp4",title:"JDBC target",allow:"autoplay;fullscreen",allowtransparency:"true",frameborder:"0",scrolling:"no",class:"wistia_embed",name:"wistia_embed",msallowfullscreen:!0,width:"100%",height:"100%"}))),(0,o.kt)("h3",{id:"spark-code-1"},"Spark Code"),(0,o.kt)(i.Z,{mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'def Target(spark: SparkSession, in0: DataFrame):\n   in0.write\\\n      .format("jdbc")\\\n      .option("url", f"{Config.jdbc_url}")\\\n      .option("dbtable", "public.demo_customers_raw_output")\\\n      .option("user", f"{Config.jdbc_username}")\\\n      .option("password", f"{Config.jdbc_password}")\\\n      .option("driver", "org.postgresql.Driver")\\\n      .save()\n\n'))),(0,o.kt)(l.Z,{value:"scala",label:"Scala",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},'object Target {\n\n  def apply(spark: SparkSession, in: DataFrame): Unit = {\n    in.write\n      .format("jdbc")\n      .option("url", s"${Config.jdbc_url}")\n      .option("dbtable", "public.demo_customers_raw_output")\n      .option("user", s"${Config.jdbc_username}")\n      .option("password", s"${Config.jdbc_password}")\n      .option("driver", "org.postgresql.Driver")\n      .save()\n  }\n\n}\n\n')))))}h.isMDXComponent=!0}}]);