<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-SQL/gems/Transformations/sql-aggregate" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Aggregate | Prophecy</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.prophecy.io/SQL/gems/Transformations/sql-aggregate"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Aggregate | Prophecy"><meta data-rh="true" name="description" content="Understand how to use transformation gems, use expressions, and use variables"><meta data-rh="true" property="og:description" content="Understand how to use transformation gems, use expressions, and use variables"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.prophecy.io/SQL/gems/Transformations/sql-aggregate"><link data-rh="true" rel="alternate" href="https://docs.prophecy.io/SQL/gems/Transformations/sql-aggregate" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.prophecy.io/SQL/gems/Transformations/sql-aggregate" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ZWUS3CKBSL-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Prophecy" href="/opensearch.xml">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/assets/css/styles.13d6b2d9.css">
<link rel="preload" href="/assets/js/runtime~main.cbb5faef.js" as="script">
<link rel="preload" href="/assets/js/main.0d8e9991.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Prophecy Logo.png" alt="Prophecy Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/Prophecy Logo White.png" alt="Prophecy Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a href="https://www.prophecy.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Docs</a><a href="https://transpiler.docs.prophecy.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Transpiler Docs</a><a href="https://www.prophecy.io/blogs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/getting-started/getting-help">Help</a><a href="http://app.prophecy.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Login</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Prophecy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/feature-matrix">Product Feature Matrix</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/getting-started/">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/concepts/">Prophecy Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Prophecy Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/metadata/">Metadata</a><button aria-label="Toggle the collapsible sidebar category &#x27;Metadata&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Spark/">Spark</a><button aria-label="Toggle the collapsible sidebar category &#x27;Spark&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/SQL/">SQL</a><button aria-label="Toggle the collapsible sidebar category &#x27;SQL&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/SQL/development/">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/SQL/gems/">Gems</a><button aria-label="Toggle the collapsible sidebar category &#x27;Gems&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/SQL/gems/Transformations/sql-transformations">Transformations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/SQL/gems/Transformations/sql-transformations">SQL Transformations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/SQL/gems/Transformations/sql-aggregate">Aggregate</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/SQL/gems/datasources/">Data Sources</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data Sources&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SQL/gems/data-joins">Joins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SQL/gems/custom/">Custom</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SQL/gems/subgraph/">Subgraph</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/SQL/execution/">Execution</a><button aria-label="Toggle the collapsible sidebar category &#x27;Execution&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/SQL/fabrics/">Fabrics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Fabrics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/SQL/data-tests/">Data tests</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data tests&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/SQL/extensibility/">Extensibility</a><button aria-label="Toggle the collapsible sidebar category &#x27;Extensibility&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Orchestration/">Orchestration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Orchestration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/deployment/">Deployment</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deployment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/package-hub/">Package Hub</a><button aria-label="Toggle the collapsible sidebar category &#x27;Package Hub&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/settings/">Settings</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/architecture/">Architecture</a><button aria-label="Toggle the collapsible sidebar category &#x27;Architecture&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/release_notes/">Release Notes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Release Notes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/tutorials/">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/SQL/"><span itemprop="name">SQL</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/SQL/gems/"><span itemprop="name">Gems</span></a><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Transformations</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Aggregate</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Aggregate</h1></header><p>Together let&#x27;s deconstruct a commonly used Transformation, the Aggregate Gem. Follow along in the <code>HelloWorld_SQL</code> Project.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-gem">Using the Gem<a href="#using-the-gem" class="hash-link" aria-label="Direct link to Using the Gem" title="Direct link to Using the Gem">​</a></h2><p><img loading="lazy" alt="1" src="/assets/images/Snow4.6.1_Aggregate-8acc945fe1ed46a97b9624d9d586f46f.png" width="2880" height="1084" class="img_ev3q"></p><ol><li><strong>Open</strong> the HelloWorld_SQL <a href="https://app.prophecy.io/metadata" target="_blank" rel="noopener noreferrer">Project</a>.</li><li>From the list of Models, select the <strong>Orders</strong> Model. A Model is a series of transformation steps (Gems) that describe how to create a single table or view. The Orders Model defines the steps to create the Orders table.</li><li>Open the <strong>Transformation</strong> dropdown to see the available Transformation Gems. The Aggregate Gem has already been dragged to the canvas and configured in this HelloWorld_SQL example.</li><li>Click the arrow to <strong>Run upto the Aggregate Gem</strong>.</li><li>Preview a <strong>data sample</strong> before the Aggregate Gem.</li><li>This is the <code>payments</code> data sample before the Aggregate Gem. There is one row per payment.</li><li>Click to <strong>Run upto the Join Gem</strong>.</li><li>Preview a <strong>data sample</strong> after the Aggregate Gem.</li><li>This is the <code>order_payments</code> data sample after the Aggregate Gem. The individual rows of <code>payments</code> have been grouped according to <code>ORDER_ID</code>, and the amounts have been summed according to the payment type.</li><li>Let&#x27;s see how to use expressions. Click to <strong>Open</strong>.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-expressions">Using Expressions<a href="#using-expressions" class="hash-link" aria-label="Direct link to Using Expressions" title="Direct link to Using Expressions">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="groupby-expression">GroupBy expression<a href="#groupby-expression" class="hash-link" aria-label="Direct link to GroupBy expression" title="Direct link to GroupBy expression">​</a></h3><p><img loading="lazy" alt="2" src="/assets/images/Snow4.6.2_Aggregate-d8437ffd92ca9d25cdf3d0d28560f2aa.png" width="2880" height="1958" class="img_ev3q"></p><ol><li>There is one <strong>Input</strong> Dataset, <code>payments</code>, and we can see the columns and datatypes below.</li><li>Open the <strong>GroupBy</strong> tab.</li><li>We can see the Gem is configured to group according to the <code>order_id</code> column. Just click any column name listed in <strong>(1) Input</strong> to add a column to the GroupBy expressions.</li><li>Syntax <strong>errors</strong> are surfaced here as you&#x27;re designing your Gem (and Model) on the canvas. That&#x27;s handy so you don&#x27;t have to run a Job to discover a typo.</li><li>The <strong>Run</strong> button is available here to test and view data samples. This way you can make sure your Aggregate Gem is configured as desired.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="aggregate-expressions">Aggregate expressions<a href="#aggregate-expressions" class="hash-link" aria-label="Direct link to Aggregate expressions" title="Direct link to Aggregate expressions">​</a></h3><p>Next we&#x27;ll walk through the Aggregate tab, where we have a lot more bells and knobs to turn.
<img loading="lazy" alt="3" src="/assets/images/Snow4.6.3_Aggregate-3d1d43a68de60bfd3b4e60124fe100a7.png" width="2880" height="1958" class="img_ev3q"></p><ol><li>Click the <strong>Aggregate</strong> tab, where we&#x27;ll define our new column names and data manipulation expressions.</li><li>The list of <strong>Expressions</strong> describe how to manipulate a particular column from the input Dataset.</li><li>The list of <strong>Target Columns</strong> is the list of column names to be manipulated by the Aggregate Gem and included in the Gem&#x27;s output.</li><li>Click <strong>Output</strong> to see the schema of the Dataset resulting from the Aggregate Gem.</li><li>The <code>order_id</code> column is getting passed through the Aggregate step without being changed. Recall this is the column that will be used to group the data. To add any column, just click the column name from the Input list, or start typing the column name and Prophecy Copilot will provide suggestions.</li><li>Since the <code>order_id</code> column was <strong>(5)selected,</strong> then this column appears in the output Dataset. It has a number datatype.</li><li>Here is an <strong>expression</strong> that includes some data manipulation logic. The amount is summed according to the payment method. <code>payment_method</code> is being passed as a configurable variable surrounded by curly braces <code>{{ }}</code>. We&#x27;ll see how to configure the variables <code>credit_card</code>, <code>coupon</code>, <code>bank_transfer</code>, <code>gift_card</code> in the next section.</li><li>These are the <strong>output columns</strong> according to the <strong>(3)Target Column.</strong> <code>{{ payment_method }}</code> is a configurable parameter, and each of the payment methods (e.g. GIFT_CARD) has been appended with the string <code>amount</code>. Now we are starting to see how the data sample output from the Aggregate Gem will be constructed.</li><li>Let&#x27;s <strong>AskAI</strong> to help write a new expression. Type &quot;Calculate customer size based on the amount purchased.&quot; Copilot AI generates a SQL expression and we can keep or reject the suggestion.</li><li>The new expression will be reflected in the Aggregate Gem output, <code>CUSTOMER_SIZE</code> column.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-variables">Using Variables<a href="#using-variables" class="hash-link" aria-label="Direct link to Using Variables" title="Direct link to Using Variables">​</a></h2><p>Now let&#x27;s see how to configure the <code>payment_methods</code> variable.</p><p><img loading="lazy" alt="4" src="/assets/images/Snow4.6.4_Aggregate-46e41f2a516d25465ced483161c528c9.png" width="2880" height="1084" class="img_ev3q"></p><ol><li>Click <strong>Config</strong> to open the configuration screen.</li><li>We see the option to apply a configuration at several different <strong>levels:</strong> apply to the entire Model, all the Models in the GitHub folder, or all the Models in the Project. Here we can see there are Configurations that apply to this particular <code>Orders</code> Model.</li><li>See the list of <a href="https://docs.getdbt.com/reference/configs-and-properties" target="_blank" rel="noopener noreferrer">DBT Defined Configs</a>. These are configs every user could employ with their DBT Projects, such as whether to materialize the model as table, view, ephemeral, or incremental. Click the dropdown to select the config of interest, then enter the appropriate value. Hover over the &quot;i&quot; icon for a short description of each DBT Config.</li><li>See the list of user-defined <strong>Variables</strong>. In our HelloWorld_SQL project, the <code>payment_methods</code> variable has been defined with the four <strong>values</strong> shown.</li><li>Click <strong>Save</strong> after editing the Config for the Model, Folder, or Project.</li></ol><p>Click the code view to see the Config encoded in the <code>dbt_project.yml</code> file or the <code>schema.yml/properties.yml</code> file. Further information can be found in DBT documentation, as Prophecy&#x27;s Model Config is based on DBT&#x27;s <a href="https://docs.getdbt.com/reference/model-configs" target="_blank" rel="noopener noreferrer">Model Configurations</a>.</p><p>Using Config variables (and DBT Defined Configs) within a Gem is easy. Just wrap the variable name (e.g. <code>payment_method</code>) in curly braces <code>{{ }}</code> like this: <code>{{ payment_method }}</code>.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>To learn more about the Aggregate Gem UI, see <a href="/concepts/project/gems">this page</a> which illustrates features common to all <a href="/SQL/gems/">Gems</a>.</p></div></div><p>Here we used the Aggregate Gem from the HelloWorld_SQL Project as a learning guide. What types of Aggregations will you build? <a href="/getting-started/getting-help">Reach out</a> with questions and to let us know how you&#x27;re using Prophecy.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/aggregate">aggregate</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/groupby">groupby</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/data">data</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/gem">gem</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/transformation">transformation</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/SQL/gems/Transformations/sql-transformations"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SQL Transformations</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/SQL/gems/datasources/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Data Sources</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#using-the-gem" class="table-of-contents__link toc-highlight">Using the Gem</a></li><li><a href="#using-expressions" class="table-of-contents__link toc-highlight">Using Expressions</a><ul><li><a href="#groupby-expression" class="table-of-contents__link toc-highlight">GroupBy expression</a></li><li><a href="#aggregate-expressions" class="table-of-contents__link toc-highlight">Aggregate expressions</a></li></ul></li><li><a href="#using-variables" class="table-of-contents__link toc-highlight">Using Variables</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/prophecy-io-support/shared_invite/zt-1dwuvkakg-JcavnQuoukyZ3q5jkSkKCg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://app.prophecy.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Login<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2024 Prophecy Inc All Rights Reserved <a href="https://legal.prophecy.io/privacy" target="_blank">Privacy Policy</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.cbb5faef.js"></script>
<script src="/assets/js/main.0d8e9991.js"></script>
</body>
</html>