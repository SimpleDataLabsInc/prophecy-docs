"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[65778],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var r=s(96540);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},46391:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>x,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"analysts/development/gems/source-target/file/s3-gem","title":"Amazon S3 gem","description":"Use S3 as a file source or target in a gem","source":"@site/docs/analysts/development/gems/source-target/file/s3.md","sourceDirName":"analysts/development/gems/source-target/file","slug":"/analysts/s3-gem","permalink":"/analysts/s3-gem","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Amazon S3 gem","id":"s3-gem","sidebar_label":"Amazon S3","slug":"/analysts/s3-gem","description":"Use S3 as a file source or target in a gem","tags":[]},"sidebar":"mySidebar","previous":{"title":"Text","permalink":"/analysts/text"},"next":{"title":"Databricks Volumes","permalink":"/analysts/databricks-volumes-gem"}}');var t=s(74848),i=s(28453),o=s(77956);const l={title:"Amazon S3 gem",id:"s3-gem",sidebar_label:"Amazon S3",slug:"/analysts/s3-gem",description:"Use S3 as a file source or target in a gem",tags:[]},a=void 0,c={},d=[{value:"Supported file formats",id:"supported-file-formats",level:2},{value:"Create an S3 gem",id:"create-an-s3-gem",level:2},{value:"Source location",id:"source-location",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Target location",id:"target-location",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.A,{execution_engine:"Prophecy Automate",sql_package_name:"",sql_package_version:""}),"\n",(0,t.jsx)(n.p,{children:"Use a Source and Target gem to read from or write to S3 locations in Prophecy pipelines. This page covers supported file formats, how to create the gem, and how to configure connection details and paths for both Source and Target gems."}),"\n",(0,t.jsx)(n.h2,{id:"supported-file-formats",children:"Supported file formats"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Format"}),(0,t.jsx)(n.th,{children:"Read"}),(0,t.jsx)(n.th,{children:"Write"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/analysts/csv",children:"CSV"})}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"Yes"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/analysts/fixed-width",children:"Fixed width"})}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"No"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/analysts/json",children:"JSON"})}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"Yes"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/analysts/parquet",children:"Parquet"})}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"Yes"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/analysts/excel",children:"XLSX"})}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"Yes"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/analysts/xml",children:"XML"})}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"Yes"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"create-an-s3-gem",children:"Create an S3 gem"}),"\n",(0,t.jsx)(n.p,{children:"To create an S3 Source or Target gem in your pipeline:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Set up your ",(0,t.jsx)(n.a,{href:"/administration/fabrics/prophecy-fabrics/connections/s3",children:"S3 connection"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Add a new Source or Target gem to your pipeline canvas and open the configuration."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["In the ",(0,t.jsx)(n.strong,{children:"Type"})," tab, select ",(0,t.jsx)(n.strong,{children:"S3"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["In the ",(0,t.jsx)(n.strong,{children:"Location"})," tab, choose your ",(0,t.jsx)(n.a,{href:"#supported-file-formats",children:"file format"})," and location."]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["For more information on how to configure this screen, jump to ",(0,t.jsx)(n.a,{href:"#source-location",children:"Source location"})," and ",(0,t.jsx)(n.a,{href:"#target-location",children:"Target location"}),"."]})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["In the ",(0,t.jsx)(n.strong,{children:"Properties"})," tab, set the file properties. These vary based on the file type that you are working with."]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["See the list of properties per ",(0,t.jsx)(n.a,{href:"/analysts/file-types",children:"file type"}),"."]})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["(Source only) In the ",(0,t.jsx)(n.strong,{children:"Preview"})," tab, load a sample of the data and verify that it looks correct."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"source-location",children:"Source location"}),"\n",(0,t.jsx)(n.p,{children:"When setting up an S3 Source gem, you need to decide how Prophecy should locate files at runtime. There are two modes:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Filepath"}),": Always read from a specific file path. You can use wildcards in your path definition. If multiple files match, they are unioned into a single output table."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Configuration"}),": Dynamically read files provided by a ",(0,t.jsx)(n.a,{href:"/analysts/triggers",children:"file arrival/change trigger"})," in the pipeline\u2019s schedule. When new or updated files are detected in the monitored directory, the trigger starts the pipeline and passes those files to the S3 Source gem, which unions them into a single output table."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Use the table below to understand how to configure each option."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Format type"}),(0,t.jsxs)(n.td,{children:["Type of file to read, such as ",(0,t.jsx)(n.code,{children:"csv"})," or ",(0,t.jsx)(n.code,{children:"json"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Select or create connection"}),(0,t.jsxs)(n.td,{children:["Select an existing S3 connection or ",(0,t.jsx)(n.a,{href:"/administration/fabrics/prophecy-fabrics/connections/s3",children:"create a new one"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Choose Path or Configuration"}),(0,t.jsxs)(n.td,{children:["Choose between the following options.",(0,t.jsxs)("ul",{children:[(0,t.jsxs)("li",{children:[(0,t.jsx)(n.strong,{children:"Filepath"}),": Read one file from a specified file path."]}),(0,t.jsxs)("li",{children:[(0,t.jsx)(n.strong,{children:"Configuration"}),": Dynamically read files provided by a ",(0,t.jsx)(n.a,{href:"/analysts/triggers",children:"file arrival/change trigger"}),"."]})]})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:["Filepath",(0,t.jsx)("br",{}),(0,t.jsx)(n.em,{children:"Filepath option only"})]}),(0,t.jsxs)(n.td,{children:["Path to the file in the S3 bucket. Supports wildcards. ",(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)(n.code,{children:"/temp/dir/*.csv"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:["Select Configuration",(0,t.jsx)("br",{}),(0,t.jsx)(n.em,{children:"Configuration option only"})]}),(0,t.jsxs)(n.td,{children:["File arrival/change trigger ",(0,t.jsx)(n.a,{href:"/analysts/triggers#trigger-configuration",children:"configuration"})," that provides the added or modified files for that run."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Include filename Column"}),(0,t.jsx)(n.td,{children:"Appends a column containing the source filename for each row in the output table."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Delete files after successfully processed"}),(0,t.jsx)(n.td,{children:"Deletes objects after they are successfully read."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Move files after successfully processed"}),(0,t.jsx)(n.td,{children:"Moves objects to a specified directory after they are successfully read."})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["If you select ",(0,t.jsx)(n.strong,{children:"Configuration"}),", the gem will only run successfully during a ",(0,t.jsx)(n.strong,{children:"triggered pipeline run"}),". This is because the gem expects files from the trigger. In other cases, such as an interactive run or an API-triggered run, there will be no files to read. In these situations, you will encounter the following error:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Failed due to: Unable to detect modified files for provided File Trigger\n"})}),"\n",(0,t.jsxs)(n.p,{children:["For the same reason, you'll see an error if you try to infer the schema in the ",(0,t.jsx)(n.strong,{children:"Properties"})," tab or load a preview in the ",(0,t.jsx)(n.strong,{children:"Preview"})," tab of the Source gem."]}),"\n",(0,t.jsx)(n.h2,{id:"target-location",children:"Target location"}),"\n",(0,t.jsx)(n.p,{children:"When setting up an S3 Target gem, you need to set the location and file type to correctly write the file."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Format type"}),(0,t.jsxs)(n.td,{children:["Type of file to write, such as ",(0,t.jsx)(n.code,{children:"csv"})," or ",(0,t.jsx)(n.code,{children:"json"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Select or create connection"}),(0,t.jsxs)(n.td,{children:["Select an existing S3 connection or ",(0,t.jsx)(n.a,{href:"/administration/fabrics/prophecy-fabrics/connections/s3",children:"create a new one"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Filepath"}),(0,t.jsxs)(n.td,{children:["S3 path where the output file will be written. ",(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)(n.code,{children:"s3://my-bucket/data/orders.csv"})]})]})]})]})]})}function x(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},77956:(e,n,s)=>{s.d(n,{A:()=>t});s(96540);var r=s(74848);function t(e){return(0,r.jsxs)("div",{children:[e.execution_engine&&(0,r.jsx)("a",{href:"https://docs.prophecy.io/administration/fabrics/prophecy-fabrics/",children:(0,r.jsx)("span",{className:"badge badge-runtime",children:e.execution_engine})}),e.sql_package_name&&e.sql_package_version&&(0,r.jsx)("a",{href:"https://docs.prophecy.io/engineers/package-hub/",children:(0,r.jsxs)("span",{className:"badge badge-dependency",children:[e.sql_package_name," ",e.sql_package_version]})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{})]})}}}]);