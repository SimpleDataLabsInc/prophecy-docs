"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[13760],{28453:(e,s,t)=>{t.d(s,{R:()=>i,x:()=>l});var n=t(96540);const r={},a=n.createContext(r);function i(e){const s=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(a.Provider,{value:s},e.children)}},51838:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"analysts/development/gems/custom/rest-api","title":"RestAPI gem","description":"Call APIs from your pipeline","source":"@site/docs/analysts/development/gems/custom/rest-api.md","sourceDirName":"analysts/development/gems/custom","slug":"/analysts/rest-api","permalink":"/analysts/rest-api","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"gems","permalink":"/tags/gems"},{"inline":true,"label":"analyst","permalink":"/tags/analyst"},{"inline":true,"label":"custom","permalink":"/tags/custom"}],"version":"current","frontMatter":{"title":"RestAPI gem","sidebar_label":"RestAPI","id":"rest-api","slug":"/analysts/rest-api","description":"Call APIs from your pipeline","tags":["gems","analyst","custom"]},"sidebar":"platformSidebar","previous":{"title":"Macro","permalink":"/analysts/macro"},"next":{"title":"Script","permalink":"/analysts/script"}}');var r=t(74848),a=t(28453),i=t(77956);const l={title:"RestAPI gem",sidebar_label:"RestAPI",id:"rest-api",slug:"/analysts/rest-api",description:"Call APIs from your pipeline",tags:["gems","analyst","custom"]},o=void 0,d={},c=[{value:"Use cases",id:"use-cases",level:2},{value:"Input and Output",id:"input-and-output",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Parse JSON responses",id:"parse-json-responses",level:3},{value:"Authentication methods",id:"authentication-methods",level:3}];function h(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.A,{execution_engine:"Prophecy Automate",sql_package_name:"",sql_package_version:""}),"\n",(0,r.jsx)(s.p,{children:"Use the RestAPI gem to make API calls from your pipeline."}),"\n",(0,r.jsx)(s.admonition,{title:"Interactive Gem Example",type:"info",children:(0,r.jsxs)(s.p,{children:["The RestAPI gem has a corresponding interactive gem example. See ",(0,r.jsx)(s.a,{href:"/analysts/gems#interactive-gem-examples",children:"Interactive gem examples"})," to learn how to run sample pipelines for this and other gems."]})}),"\n",(0,r.jsx)(s.h2,{id:"use-cases",children:"Use cases"}),"\n",(0,r.jsx)(s.p,{children:"While RestAPIs vary greatly in functionality, we can highlight a few use cases that may be particularly helpful for your pipelines."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Use case"}),(0,r.jsx)(s.th,{children:"Example"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Bringing in more data from external systems"}),(0,r.jsx)(s.td,{children:"Retrieve active users from an internal user database."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Enriching data with specific APIs"}),(0,r.jsx)(s.td,{children:"Send data to LLMs to analyze text and return the sentiments of a column."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Sending notifications or alerts"}),(0,r.jsx)(s.td,{children:"Send real-time messages to a Slack channel when an event occurs in your pipeline."})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"input-and-output",children:"Input and Output"}),"\n",(0,r.jsx)(s.p,{children:"The RestAPI gem uses the following input and output ports."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Port"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"in0"})}),(0,r.jsx)(s.td,{children:"(Optional) Input table. Prophecy will make one API call per row."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"out"})}),(0,r.jsx)(s.td,{children:"Output table that includes input columns (if applicable) and the API response."})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["By default, the RestAPI gem does not include an input port. To add a port, click the ",(0,r.jsx)(s.code,{children:"+"})," button next to ",(0,r.jsx)(s.strong,{children:"Ports"}),". Alternatively, connect a previous gem to the RestAPI gem directly to add a new input port."]}),"\n",(0,r.jsx)(s.admonition,{type:"info",children:(0,r.jsxs)(s.p,{children:["The number of inputs and outputs can be changed as needed by clicking the ",(0,r.jsx)(s.code,{children:"+"})," button on the respective tab in the left panel.\nTo learn more about adding and removing ports, see ",(0,r.jsx)(s.a,{href:"/analysts/gems#gem-ports",children:"Gem ports"}),"."]})}),"\n",(0,r.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(s.p,{children:"Configure the RestAPI gem using the following parameters."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Parameter"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Target Column Name"}),(0,r.jsxs)(s.td,{children:["Name of the output column that will contain the API response.",(0,r.jsx)("br",{}),"Default: ",(0,r.jsx)(s.code,{children:"api_data"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"URL"}),(0,r.jsx)(s.td,{children:"API endpoint URL where the request will be sent."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Method"}),(0,r.jsxs)(s.td,{children:["HTTP method that determines the action to perform. ",(0,r.jsx)("br",{}),"Common values include ",(0,r.jsx)(s.code,{children:"GET"})," (retrieve data), ",(0,r.jsx)(s.code,{children:"POST"})," (create data), ",(0,r.jsx)(s.code,{children:"PUT"})," (update data), ",(0,r.jsx)(s.code,{children:"DELETE"})," (remove data)."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Parse API response as JSON"}),(0,r.jsxs)(s.td,{children:["Automatically parse JSON responses into separate columns instead of a single string column. ",(0,r.jsx)("br",{}),"See ",(0,r.jsx)(s.a,{href:"#parse-json-responses",children:"Parse JSON Responses"})," for details."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Authentication"}),(0,r.jsxs)(s.td,{children:["Method to send credentials to the RestAPI. ",(0,r.jsx)("br",{}),"See ",(0,r.jsx)(s.a,{href:"#authentication-methods",children:"Authentication methods"})," for details."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Params"}),(0,r.jsxs)(s.td,{children:["Query parameters to append to the request URL as key-value pairs. ",(0,r.jsx)("br",{}),"Commonly used for filtering, sorting, or pagination. ",(0,r.jsx)("br",{}),"Example: ",(0,r.jsx)(s.code,{children:"page:2"})," and ",(0,r.jsx)(s.code,{children:"limit:10"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Body"}),(0,r.jsxs)(s.td,{children:["Request payload sent with ",(0,r.jsx)(s.code,{children:"POST"}),", ",(0,r.jsx)(s.code,{children:"PUT"}),", or ",(0,r.jsx)(s.code,{children:"PATCH"})," methods. ",(0,r.jsx)("br",{}),"Contains the data to be processed by the API, typically in JSON format."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Headers"}),(0,r.jsxs)(s.td,{children:["Additional metadata sent with the request as key-value pairs. ",(0,r.jsx)("br",{}),"Used for authentication, content type specification, and other request attributes. ",(0,r.jsx)("br",{}),"Supports hard-coded values, configurations (pipeline parameters), and secrets."]})]})]})]}),"\n",(0,r.jsxs)(s.admonition,{type:"tip",children:[(0,r.jsx)(s.p,{children:"You can populate these parameters with hard-coded values, or you can reference columns. To reference a column, use curly brackets. You can reference columns in any field."}),(0,r.jsxs)(s.p,{children:["For example, if your dataset has a column named ",(0,r.jsx)(s.code,{children:"AccountID"}),", you can call an API like this:\n",(0,r.jsx)("br",{}),(0,r.jsx)(s.code,{children:"https://api.company.com/users/{{AccountID}}"})]})]}),"\n",(0,r.jsx)(s.h3,{id:"parse-json-responses",children:"Parse JSON responses"}),"\n",(0,r.jsx)(s.p,{children:"Enable JSON parsing to automatically extract the response into separate columns."}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Check the ",(0,r.jsx)(s.strong,{children:"Parse API response as JSON"})," checkbox in the gem configuration."]}),"\n",(0,r.jsxs)(s.li,{children:["Open the output port panel and enable the ",(0,r.jsx)(s.strong,{children:"Custom Schema"})," toggle."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Infer from Cluster"})," to retrieve the schema from the JSON response."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"When JSON parsing is enabled:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"The API response is automatically parsed into individual columns based on the JSON structure."}),"\n",(0,r.jsxs)(s.li,{children:["The ",(0,r.jsx)(s.strong,{children:"Target Column Name"})," parameter is hidden since column names come from the JSON field names."]}),"\n",(0,r.jsx)(s.li,{children:"If your input has multiple rows, each row triggers a separate API call, and the results are unioned into a single output table."}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["This feature is enabled by default for new gems using the ",(0,r.jsx)(s.code,{children:"GET"})," method. Changing the method will disable it, but you can always re-enable the checkbox."]}),"\n",(0,r.jsx)(s.admonition,{type:"note",children:(0,r.jsx)(s.p,{children:"JSON parsing requires the API to return valid JSON responses. If the response format is inconsistent or not JSON, disable this option and parse the response manually in subsequent gems."})}),"\n",(0,r.jsx)(s.h3,{id:"authentication-methods",children:"Authentication methods"}),"\n",(0,r.jsx)(s.p,{children:"The RestAPI gem supports three authentication methods."}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"None"}),": No automatic authentication. Enter authentication information manually in the ",(0,r.jsx)(s.strong,{children:"Headers"})," parameter."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Basic Auth"}),": Automatically sends Base64-encoded username and password from a ",(0,r.jsx)(s.a,{href:"/analysts/secrets",children:"Username & Password secret"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Bearer Token"}),": Automatically sends an OAuth bearer token that Prophecy generates from an ",(0,r.jsx)(s.a,{href:"/analysts/secrets",children:"M2M OAuth secret"}),"."]}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},77956:(e,s,t)=>{t.d(s,{A:()=>r});t(96540);var n=t(74848);function r(e){return(0,n.jsxs)("div",{children:[e.execution_engine&&(0,n.jsx)("a",{href:"https://docs.prophecy.io/administration/fabrics/prophecy-fabrics/",children:(0,n.jsx)("span",{className:"badge badge-runtime",children:e.execution_engine})}),e.sql_package_name&&e.sql_package_version&&(0,n.jsx)("a",{href:"https://docs.prophecy.io/engineers/package-hub/",children:(0,n.jsxs)("span",{className:"badge badge-dependency",children:[e.sql_package_name," ",e.sql_package_version]})}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{})]})}}}]);