"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[302],{23534:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>r});const s=JSON.parse('{"id":"analysts/development/functions/functions","title":"Functions","description":"Build functions with SQL macros to be used in gem expressions","source":"@site/docs/analysts/development/functions/functions.md","sourceDirName":"analysts/development/functions","slug":"/analysts/functions","permalink":"/analysts/functions","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"gems","permalink":"/tags/gems"},{"inline":true,"label":"analyst","permalink":"/tags/analyst"},{"inline":true,"label":"function","permalink":"/tags/function"}],"version":"current","frontMatter":{"title":"Functions","id":"functions","slug":"/analysts/functions","description":"Build functions with SQL macros to be used in gem expressions","tags":["gems","analyst","function"]},"sidebar":"mySidebar","previous":{"title":"Data exploration","permalink":"/analysts/data-explorer"},"next":{"title":"Collaboration","permalink":"/analysts/collaboration"}}');var i=t(74848),l=t(28453);const a={title:"Functions",id:"functions",slug:"/analysts/functions",description:"Build functions with SQL macros to be used in gem expressions",tags:["gems","analyst","function"]},o=void 0,c={},r=[{value:"Create a function",id:"create-a-function",level:2},{value:"Build the function",id:"build-the-function",level:2},{value:"Example: Concatenate columns",id:"example-concatenate-columns",level:2}];function d(n){const e={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,l.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.p,{children:"In SQL projects, functions are SQL macros that transform data at the column level. Unlike gems, which operate at the table level, functions apply transformations to individual columns, making them useful for data cleansing, formatting, and complex calculations. Functions are compiled into code using the Jinja templating language (standard for dbt macros)."}),"\n",(0,i.jsxs)(e.p,{children:["You will use functions as ",(0,i.jsx)(e.a,{href:"/analysts/visual-expression-builder",children:"expressions"})," in gems."]}),"\n",(0,i.jsx)(e.h2,{id:"create-a-function",children:"Create a function"}),"\n",(0,i.jsx)(e.p,{children:"To add a new function to your project, perform the following steps."}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Open a SQL project."}),"\n",(0,i.jsxs)(e.li,{children:["Click ",(0,i.jsx)(e.strong,{children:"Add Entity"})," in the project sidebar."]}),"\n",(0,i.jsxs)(e.li,{children:["Select ",(0,i.jsx)(e.strong,{children:"Function"}),"."]}),"\n",(0,i.jsx)(e.li,{children:"Name the function."}),"\n",(0,i.jsxs)(e.li,{children:["Keep the function in the ",(0,i.jsx)(e.code,{children:"macros"})," directory."]}),"\n",(0,i.jsxs)(e.li,{children:["Click ",(0,i.jsx)(e.strong,{children:"Create"}),"."]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"This opens the function configuration screen."}),"\n",(0,i.jsx)(e.h2,{id:"build-the-function",children:"Build the function"}),"\n",(0,i.jsx)(e.p,{children:"You can build functions visually by populating the following fields."}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"Field"}),(0,i.jsx)(e.th,{children:"Description"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Description"}),(0,i.jsx)(e.td,{children:"A summary of what the function will do."})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Parameters"}),(0,i.jsx)(e.td,{children:"The parameters (arguments) that will be passed to the function. Parameters can be values or table names."})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Definition"}),(0,i.jsx)(e.td,{children:"SQL code that will be executed by the function."})]})]})]}),"\n",(0,i.jsx)(e.h2,{id:"example-concatenate-columns",children:"Example: Concatenate columns"}),"\n",(0,i.jsxs)(e.p,{children:["Use the following example to learn how to build a function and use it in your pipeline. This example demonstrates a function that concatenates values from a ",(0,i.jsx)(e.code,{children:"first_name"})," and ",(0,i.jsx)(e.code,{children:"last_name"})," column in a customer table."]}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["Click ",(0,i.jsx)(e.strong,{children:"+Add Entity"})," in the project sidebar."]}),"\n",(0,i.jsxs)(e.li,{children:["Select ",(0,i.jsx)(e.strong,{children:"Function"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["Name the function ",(0,i.jsx)(e.code,{children:"concat_name"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["Click ",(0,i.jsx)(e.strong,{children:"Create"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["Add the following description: ",(0,i.jsx)(e.code,{children:"Concatenates customer first and last names in a new column"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["Add two parameters to the function: ",(0,i.jsx)(e.code,{children:"first_name"})," and ",(0,i.jsx)(e.code,{children:"last_name"}),"."]}),"\n",(0,i.jsx)(e.li,{children:"Add the following to the macro body"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-jinja",children:"{% macro concat_name(first_name, last_name) %}\nCONCAT(\n    UPPER(LEFT({{ first_name }}, 1)),\n    LOWER(SUBSTRING({{ first_name }}, 2)),\n    ' ',\n    UPPER(LEFT({{ last_name }}, 1)),\n    LOWER(SUBSTRING({{ last_name }}, 2))\n)\n{% endmacro %}\n"})}),"\n",(0,i.jsx)(e.p,{children:"To use this function in your pipeline:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Add a Reformat gem to the pipeline canvas."}),"\n",(0,i.jsxs)(e.li,{children:["For the target column, create a new column named ",(0,i.jsx)(e.code,{children:"full_name"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["For the expression, select ",(0,i.jsx)(e.strong,{children:"Function > concat_name"}),"."]}),"\n",(0,i.jsx)(e.li,{children:"For the function parameters, choose a first name columns and a last name column."}),"\n",(0,i.jsx)(e.li,{children:"Save and run the gem."}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["In summary, this function inside of the Reformat gem let us combine customer first and last names into a new column: ",(0,i.jsx)(e.code,{children:"full_name"}),"."]})]})}function u(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>o});var s=t(96540);const i={},l=s.createContext(i);function a(n){const e=s.useContext(l);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:a(n.components),s.createElement(l.Provider,{value:e},n.children)}}}]);