"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[2589],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>b});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),u=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=u(r),m=n,b=d["".concat(s,".").concat(m)]||d[m]||c[m]||o;return r?a.createElement(b,i(i({ref:t},p),{},{components:r})):a.createElement(b,i({ref:t},p))}));function b(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:n,i[1]=l;for(var u=2;u<o;u++)i[u]=r[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},72360:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(67294),n=r(86010);const o={tabItem:"tabItem_OmH5"};function i(e){let{children:t,hidden:r,className:i}=e;return a.createElement("div",{role:"tabpanel",className:(0,n.Z)(o.tabItem,i),hidden:r},t)}},9877:(e,t,r)=>{r.d(t,{Z:()=>c});var a=r(83117),n=r(67294),o=r(72389),i=r(67392),l=r(7094),s=r(12466),u=r(86010);const p={tabList:"tabList_uSqn",tabItem:"tabItem_LplD"};function d(e){const{lazy:t,block:r,defaultValue:o,values:d,groupId:c,className:m}=e,b=n.Children.map(e.children,(e=>{if((0,n.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),f=d??b.map((e=>{let{props:{value:t,label:r,attributes:a}}=e;return{value:t,label:r,attributes:a}})),v=(0,i.l)(f,((e,t)=>e.value===t.value));if(v.length>0)throw new Error(`Docusaurus error: Duplicate values "${v.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const g=null===o?o:o??b.find((e=>e.props.default))?.props.value??b[0]?.props.value;if(null!==g&&!f.some((e=>e.value===g)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${g}" but none of its children has the corresponding value. Available values are: ${f.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:k,setTabGroupChoices:h}=(0,l.U)(),[w,y]=(0,n.useState)(g),N=[],{blockElementScrollPositionUntilNextRender:D}=(0,s.o5)();if(null!=c){const e=k[c];null!=e&&e!==w&&f.some((t=>t.value===e))&&y(e)}const O=e=>{const t=e.currentTarget,r=N.indexOf(t),a=f[r].value;a!==w&&(D(t),y(a),null!=c&&h(c,a))},T=e=>{let t=null;switch(e.key){case"ArrowRight":{const r=N.indexOf(e.currentTarget)+1;t=N[r]||N[0];break}case"ArrowLeft":{const r=N.indexOf(e.currentTarget)-1;t=N[r]||N[N.length-1];break}}t?.focus()};return n.createElement("div",{className:(0,u.Z)("tabs-container",p.tabList)},n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,u.Z)("tabs",{"tabs--block":r},m)},f.map((e=>{let{value:t,label:r,attributes:o}=e;return n.createElement("li",(0,a.Z)({role:"tab",tabIndex:w===t?0:-1,"aria-selected":w===t,key:t,ref:e=>N.push(e),onKeyDown:T,onFocus:O,onClick:O},o,{className:(0,u.Z)("tabs__item",p.tabItem,o?.className,{"tabs__item--active":w===t})}),r??t)}))),t?(0,n.cloneElement)(b.filter((e=>e.props.value===w))[0],{className:"margin-top--md"}):n.createElement("div",{className:"margin-top--md"},b.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==w})))))}function c(e){const t=(0,o.Z)();return n.createElement(d,(0,a.Z)({key:String(t)},e))}},60705:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>b,frontMatter:()=>l,metadata:()=>u,toc:()=>d});var a=r(83117),n=(r(67294),r(3905)),o=r(9877),i=r(72360);const l={sidebar_position:3,title:"Row Distributor",id:"row-distributor",description:"Create multiple DataFrames based on filter conditions",tags:["gems","split","filter","row distributor"]},s=void 0,u={unversionedId:"low-code-spark/gems/join-split/row-distributor",id:"low-code-spark/gems/join-split/row-distributor",title:"Row Distributor",description:"Create multiple DataFrames based on filter conditions",source:"@site/docs/low-code-spark/gems/join-split/row-distributor.md",sourceDirName:"low-code-spark/gems/join-split",slug:"/low-code-spark/gems/join-split/row-distributor",permalink:"/low-code-spark/gems/join-split/row-distributor",draft:!1,tags:[{label:"gems",permalink:"/tags/gems"},{label:"split",permalink:"/tags/split"},{label:"filter",permalink:"/tags/filter"},{label:"row distributor",permalink:"/tags/row-distributor"}],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Row Distributor",id:"row-distributor",description:"Create multiple DataFrames based on filter conditions",tags:["gems","split","filter","row distributor"]},sidebar:"defaultSidebar",previous:{title:"Repartition",permalink:"/low-code-spark/gems/join-split/Repartition"},next:{title:"Custom",permalink:"/low-code-spark/gems/custom/"}},p={},d=[{value:"Parameters",id:"parameters",level:3},{value:"Example",id:"example",level:3},{value:"Generated Code",id:"generated-code",level:3}],c={toc:d},m="wrapper";function b(e){let{components:t,...l}=e;return(0,n.kt)(m,(0,a.Z)({},c,l,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Create multiple DataFrames based on provided filter conditions from an input DataFrame."),(0,n.kt)("p",null,"This is useful for cases where rows from the input DataFrame needs to be distributed into multiple DataFrames in different ways for downstream Gems."),(0,n.kt)("h3",{id:"parameters"},"Parameters"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,n.kt)("th",{parentName:"tr",align:null},"Description"),(0,n.kt)("th",{parentName:"tr",align:null},"Required"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"DataFrame"),(0,n.kt)("td",{parentName:"tr",align:null},"Input DataFrame for which rows needs to be distributed into multiple DataFrames"),(0,n.kt)("td",{parentName:"tr",align:null},"True")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Filter Conditions"),(0,n.kt)("td",{parentName:"tr",align:null},"Boolean Type column or boolean expression for each output tab. Supports SQL, Python and Scala expressions"),(0,n.kt)("td",{parentName:"tr",align:null},"True")))),(0,n.kt)("h3",{id:"example"},"Example"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Row distributor 1",src:r(67277).Z,width:"1748",height:"850"})),(0,n.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"Number of outputs can be changed as needed by clicking the ",(0,n.kt)("inlineCode",{parentName:"p"},"+")," button."))),(0,n.kt)("h3",{id:"generated-code"},"Generated Code"),(0,n.kt)(o.Z,{mdxType:"Tabs"},(0,n.kt)(i.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-py"},'def RowDistributor(spark: SparkSession, in0: DataFrame) -> (DataFrame, DataFrame, DataFrame):\n    df1 = in0.filter((col("order_status") == lit("Started")))\n    df2 = in0.filter((col("order_status") == lit("Approved")))\n    df3 = in0.filter((col("order_status") == lit("Finished")))\n\n    return df1, df2, df3\n'))),(0,n.kt)(i.Z,{value:"scala",label:"Scala",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-scala"},'object RowDistributor {\n\n  def apply(\n    spark: SparkSession,\n    in:    DataFrame\n  ): (DataFrame, DataFrame, DataFrame) =\n    (in.filter(col("order_status") === lit("Started")),\n     in.filter(col("order_status") === lit("Approved")),\n     in.filter(col("order_status") === lit("Finished"))\n    )\n\n}\n')))))}b.isMDXComponent=!0},67277:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/rowdistributor_eg_1-45da3213c2f5f108833af1d18986f6d7.png"}}]);