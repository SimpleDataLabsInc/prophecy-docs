"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[476],{28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>c});var i=n(96540);const s={},r=i.createContext(s);function o(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:t},e.children)}},58853:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>l,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"administration/fabrics/prophecy-fabrics/connections/bigquery","title":"Google BigQuery connection","description":"Learn how to connect with BigQuery","source":"@site/docs/administration/fabrics/prophecy-fabrics/connections/bigquery.md","sourceDirName":"administration/fabrics/prophecy-fabrics/connections","slug":"/administration/fabrics/prophecy-fabrics/connections/bigquery","permalink":"/administration/fabrics/prophecy-fabrics/connections/bigquery","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"connections","permalink":"/tags/connections"},{"inline":true,"label":"sql","permalink":"/tags/sql"},{"inline":true,"label":"bigquery","permalink":"/tags/bigquery"}],"version":"current","frontMatter":{"title":"Google BigQuery connection","sidebar_label":"Google BigQuery","id":"bigquery","description":"Learn how to connect with BigQuery","tags":["connections","sql","bigquery"]},"sidebar":"adminSidebar","previous":{"title":"Databricks","permalink":"/administration/fabrics/prophecy-fabrics/connections/databricks"},"next":{"title":"Microsoft OneDrive","permalink":"/administration/fabrics/prophecy-fabrics/connections/onedrive"}}');var s=n(74848),r=n(28453);const o={title:"Google BigQuery connection",sidebar_label:"Google BigQuery",id:"bigquery",description:"Learn how to connect with BigQuery",tags:["connections","sql","bigquery"]},c=void 0,a={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Connection type",id:"connection-type",level:2},{value:"Feature support",id:"feature-support",level:2},{value:"Connection parameters",id:"connection-parameters",level:2},{value:"Data type mapping",id:"data-type-mapping",level:2},{value:"Authentication methods",id:"authentication-methods",level:2},{value:"OAuth (User-to-Machine)",id:"oauth-user-to-machine",level:3},{value:"Private Key (Machine-to-Machine)",id:"private-key-machine-to-machine",level:3}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"A BigQuery connection allows Prophecy to access tables and compute resources in your BigQuery project. This page explains how to use and configure a Google BigQuery connection in Prophecy."}),"\n",(0,s.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(t.p,{children:"Prophecy connects to BigQuery using the credentials you provide. These credentials are used to authenticate your session and authorize all data operations during pipeline execution, including reading from and writing to tables. To use a BigQuery connection effectively, your user or service account should have:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"OWNER"})," dataset role to be able to read, insert, update, and delete datasets."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["To learn more, visit ",(0,s.jsx)(t.a,{href:"https://cloud.google.com/bigquery/docs/access-control-basic-roles",children:"Basic roles and permissions"})," in the BigQuery documentation."]}),"\n",(0,s.jsx)(t.h2,{id:"connection-type",children:"Connection type"}),"\n",(0,s.jsxs)(t.p,{children:["Prophecy supports BigQuery as both a SQL Warehouse connection and an Ingress/Egress connection. To learn more about these different connection types, visit ",(0,s.jsx)(t.a,{href:"/administration/fabrics/prophecy-fabrics/#connections",children:"Prophecy fabrics"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"feature-support",children:"Feature support"}),"\n",(0,s.jsx)(t.p,{children:"The table below outlines whether the connection supports certain Prophecy features."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Feature"}),(0,s.jsx)(t.th,{children:"Supported"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Run SQL queries"}),(0,s.jsx)(t.td,{children:"Yes \u2014 SQL Warehouse Connection only"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsxs)(t.td,{children:["Read and write data with a ",(0,s.jsx)(t.a,{href:"/analysts/bigquery-table",children:"Table gem"})]}),(0,s.jsx)(t.td,{children:"Yes \u2014 SQL Warehouse Connection only"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsxs)(t.td,{children:["Read data with a ",(0,s.jsx)(t.a,{href:"/analysts/bigquery",children:"Source gem"})]}),(0,s.jsx)(t.td,{children:"Yes"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsxs)(t.td,{children:["Write data with a ",(0,s.jsx)(t.a,{href:"/analysts/bigquery",children:"Target gem"})]}),(0,s.jsx)(t.td,{children:"Yes"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsxs)(t.td,{children:["Browse data in the ",(0,s.jsx)(t.a,{href:"/analysts/project-editor#sidebar",children:"Environment browser"})]}),(0,s.jsx)(t.td,{children:"Yes"})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"connection-parameters",children:"Connection parameters"}),"\n",(0,s.jsx)(t.p,{children:"To create a connection with BigQuery, enter the following parameters."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Parameter"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Connection Name"}),(0,s.jsx)(t.td,{children:"A unique name to identify the connection."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Project ID"}),(0,s.jsxs)(t.td,{children:["The ID of your ",(0,s.jsx)(t.a,{href:"https://cloud.google.com/resource-manager/docs/creating-managing-projects",children:"Google Cloud project"}),"."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Dataset"}),(0,s.jsxs)(t.td,{children:["The default location for target tables and ",(0,s.jsx)(t.a,{href:"/analysts/pipeline-execution#external-data-handling",children:"temporary tables"}),". ",(0,s.jsx)("br",{}),"Requires write permissions."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Authentication Method"}),(0,s.jsxs)(t.td,{children:["The method used to authenticate with BigQuery. ",(0,s.jsx)("br",{}),"See ",(0,s.jsx)(t.a,{href:"#authentication-methods",children:"Authentication methods"})," for details."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Bucket Name"}),(0,s.jsxs)(t.td,{children:["A ",(0,s.jsx)(t.a,{href:"https://cloud.google.com/storage/docs/buckets",children:"Google Cloud Storage bucket"})," used for write optimization (recommended). ",(0,s.jsx)("br",{}),"When specified, Prophecy writes data to the bucket, then loads it into BigQuery. ",(0,s.jsx)("br",{}),"Note: Loading data from a bucket offers better performance than writing with the ",(0,s.jsx)(t.a,{href:"https://cloud.google.com/bigquery/docs/reference/rest",children:"BigQuery API"})," (default)."]})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"data-type-mapping",children:"Data type mapping"}),"\n",(0,s.jsx)(t.p,{children:"When Prophecy processes data from Google BigQuery using an external SQL warehouse, it converts BigQuery data types to a compatible type."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"BigQuery"}),(0,s.jsx)(t.th,{children:"Databricks"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"STRING"}),(0,s.jsxs)(t.td,{children:["STRING",(0,s.jsx)("br",{}),"Alias: String"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"BYTES"}),(0,s.jsxs)(t.td,{children:["BINARY",(0,s.jsx)("br",{}),"Alias: Binary"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"NUMERIC"}),(0,s.jsxs)(t.td,{children:["DECIMAL128(38,9)",(0,s.jsx)("br",{}),"Alias: Bigint"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"BIGNUMERIC"}),(0,s.jsxs)(t.td,{children:["DECIMAL256(38,9)",(0,s.jsx)("br",{}),"Alias: Bigint"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"FLOAT"}),(0,s.jsxs)(t.td,{children:["DOUBLE",(0,s.jsx)("br",{}),"Alias: Double"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"RECORD"}),(0,s.jsxs)(t.td,{children:["STRUCT",(0,s.jsx)("br",{}),"Alias: Struct"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"ARRAY"}),(0,s.jsxs)(t.td,{children:["ARRAY",(0,s.jsx)("br",{}),"Alias: Array"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"INTEGER"}),(0,s.jsxs)(t.td,{children:["INT",(0,s.jsx)("br",{}),"Alias: Integer"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"BOOLEAN"}),(0,s.jsxs)(t.td,{children:["BOOLEAN",(0,s.jsx)("br",{}),"Alias: Boolean"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"DATE"}),(0,s.jsxs)(t.td,{children:["DATE",(0,s.jsx)("br",{}),"Alias: Date"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"DATETIME"}),(0,s.jsxs)(t.td,{children:["TIMESTAMP",(0,s.jsx)("br",{}),"Alias: Timestamp"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"TIME"}),(0,s.jsxs)(t.td,{children:["STRING",(0,s.jsx)("br",{}),"Alias: String"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"GEOGRAPHY"}),(0,s.jsxs)(t.td,{children:["STRING",(0,s.jsx)("br",{}),"Alias: String"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"INTERVAL"}),(0,s.jsxs)(t.td,{children:["STRING",(0,s.jsx)("br",{}),"Alias: String"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"JSON"}),(0,s.jsxs)(t.td,{children:["STRING",(0,s.jsx)("br",{}),"Alias: String"]})]})]})]}),"\n",(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsxs)(t.p,{children:["Learn more in ",(0,s.jsx)(t.a,{href:"/analysts/data-types",children:"Supported data types"}),"."]})}),"\n",(0,s.jsx)(t.h2,{id:"authentication-methods",children:"Authentication methods"}),"\n",(0,s.jsxs)(t.p,{children:["You can authenticate your BigQuery connection using either ",(0,s.jsx)(t.a,{href:"#oauth-user-to-machine",children:"OAuth"})," or a ",(0,s.jsx)(t.a,{href:"#private-key-machine-to-machine",children:"Private Key"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Each method grants Prophecy the ability to read and write data in your BigQuery environment based on the ",(0,s.jsx)(t.a,{href:"https://cloud.google.com/iam/docs/overview",children:"Identity and Access Management (IAM)"})," roles assigned to the authenticated identity."]}),"\n",(0,s.jsx)(t.h3,{id:"oauth-user-to-machine",children:"OAuth (User-to-Machine)"}),"\n",(0,s.jsx)(t.p,{children:"OAuth is a user-based authentication method best suited for interactive pipeline development. It allows each user to sign in with their own Google account, which ensures that data access is governed by their individual IAM roles and permissions."}),"\n",(0,s.jsx)(t.p,{children:"When your fabric is configured to use OAuth, the following occurs when a user attaches the fabric to their project:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"The user is prompted to sign in with their Google account."}),"\n",(0,s.jsx)(t.li,{children:"Prophecy uses the user's credentials to authenticate the connection."}),"\n",(0,s.jsx)(t.li,{children:"The connection operates with the user's IAM roles and permissions."}),"\n",(0,s.jsxs)(t.li,{children:["Token management, including refresh, is handled automatically by Google. The default ",(0,s.jsx)(t.a,{href:"https://developers.google.com/identity/protocols/oauth2#expiration",children:"refresh token expiration"})," time is 7 days."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["For more about OAuth and how it works with Google Cloud, see ",(0,s.jsx)(t.a,{href:"https://developers.google.com/identity/protocols/oauth2",children:"Using OAuth 2.0 to Access Google APIs"}),"."]}),"\n",(0,s.jsx)(t.h3,{id:"private-key-machine-to-machine",children:"Private Key (Machine-to-Machine)"}),"\n",(0,s.jsx)(t.p,{children:"Use a Service Account when you want a non-user identity for authentication. This is ideal for automated or shared processes that require stable, long-term access without re-authentication interruptions."}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Create and download a ",(0,s.jsx)(t.a,{href:"https://developers.google.com/workspace/guides/create-credentials#service-account",children:"Service Account Key"})," from the Google Cloud console."]}),"\n",(0,s.jsxs)(t.li,{children:["Paste the full JSON content into a ",(0,s.jsx)(t.a,{href:"/administration/secrets/secret-providers",children:"Prophecy secret"})," as text. Binary upload is not supported."]}),"\n",(0,s.jsxs)(t.li,{children:["Use this secret in the ",(0,s.jsx)(t.strong,{children:"Service Account Key"})," field of the BigQuery connection setup."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"This method allows all team members with access to the fabric to use the connection in their projects. Those users inherit the access and permissions of the Service Account, as defined in its IAM roles."})]})}function l(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);