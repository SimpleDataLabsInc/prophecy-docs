"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[55093],{15680:(e,t,n)=>{n.d(t,{xA:()=>d,yg:()=>y});var r=n(96540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),g=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=g(e.components);return r.createElement(s.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=g(n),m=a,y=u["".concat(s,".").concat(m)]||u[m]||p[m]||i;return n?r.createElement(y,l(l({ref:t},d),{},{components:n})):r.createElement(y,l({ref:t},d))}));function y(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[u]="string"==typeof e?e:a,l[1]=o;for(var g=2;g<i;g++)l[g]=n[g];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},57673:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>g});var r=n(58168),a=(n(96540),n(15680));const i={title:"Alerts Configuration",id:"configure-alerts",description:"Prophecy alerts configuration",sidebar_position:1,tags:["alerts","alerting","monitoring"]},l=void 0,o={unversionedId:"architecture/self-hosted/configurations/configure-alerts",id:"architecture/self-hosted/configurations/configure-alerts",title:"Alerts Configuration",description:"Prophecy alerts configuration",source:"@site/docs/architecture/self-hosted/configurations/configure-alerts.md",sourceDirName:"architecture/self-hosted/configurations",slug:"/architecture/self-hosted/configurations/configure-alerts",permalink:"/architecture/self-hosted/configurations/configure-alerts",draft:!1,tags:[{label:"alerts",permalink:"/tags/alerts"},{label:"alerting",permalink:"/tags/alerting"},{label:"monitoring",permalink:"/tags/monitoring"}],version:"current",sidebarPosition:1,frontMatter:{title:"Alerts Configuration",id:"configure-alerts",description:"Prophecy alerts configuration",sidebar_position:1,tags:["alerts","alerting","monitoring"]},sidebar:"mySidebar",previous:{title:"Configurations",permalink:"/architecture/self-hosted/configurations/"},next:{title:"Audit Events Configuration",permalink:"/architecture/self-hosted/configurations/configure-audit-logs"}},s={},g=[{value:"Requirements",id:"requirements",level:2},{value:"Alerting features",id:"alerting-features",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Edit Alert Configs",id:"edit-alert-configs",level:3},{value:"JSON format",id:"json-format",level:3},{value:"Supported configuration variables",id:"supported-configuration-variables",level:3},{value:"Alerting guidelines",id:"alerting-guidelines",level:2}],d={toc:g},u="wrapper";function p(e){let{components:t,...n}=e;return(0,a.yg)(u,(0,r.A)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("p",null,"One way to monitor resource usage in Prophecy-managed microservices is to configure alerts. Some configurations include:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Alerting when resource utilization approaches defined thresholds"),(0,a.yg)("li",{parentName:"ul"},"Suspending critical services in the event of resource overflows"),(0,a.yg)("li",{parentName:"ul"},"Resending email alerts at certain time intervals")),(0,a.yg)("p",null,"Resource monitoring is enabled by default, providing insights into CPU, memory, and disk usage for critical services. This feature reports current usage levels alongside defined limits, ensuring admins have a clear view of resource consumption. This feature can be disabled if not necessary."),(0,a.yg)("h2",{id:"requirements"},"Requirements"),(0,a.yg)("p",null,"Alerting is supported for Prophecy version 3.4.1 and above."),(0,a.yg)("h2",{id:"alerting-features"},"Alerting features"),(0,a.yg)("p",null,"Alerts are of two levels:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"WARNING"),": Nearing configured limits"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"CRITICAL"),": At or above configured limits")),(0,a.yg)("p",null,"Different thresholds are tracked:"),(0,a.yg)("table",null,(0,a.yg)("thead",{parentName:"table"},(0,a.yg)("tr",{parentName:"thead"},(0,a.yg)("th",{parentName:"tr",align:null},"Parameter"),(0,a.yg)("th",{parentName:"tr",align:null},"Alerts generated on"))),(0,a.yg)("tbody",{parentName:"table"},(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},"CPU_USAGE"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"CRITICAL"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},"DISK_USAGE"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"WARNING")," or ",(0,a.yg)("inlineCode",{parentName:"td"},"CRITICAL"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},"FILE_COUN"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"WARNING")," or ",(0,a.yg)("inlineCode",{parentName:"td"},"CRITICAL"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},"MEMORY_USAGE"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"CRITICAL"))))),(0,a.yg)("p",null,"To prevent data corruption, certain critical services, such as Metagraph and Gitserver, are automatically suspended when disk usage limits are reached. This feature is enabled by default but can be disabled if needed."),(0,a.yg)("p",null,"By default, alerts are displayed as notification banners in the Prophecy UI, which direct users to a comprehensive view on the monitoring page for detailed insights."),(0,a.yg)("p",null,"We also support email-based alerts, which can be configured by providing the necessary SMTP details. On resolution of alerts, email notifications are sent."),(0,a.yg)("h2",{id:"configuration"},"Configuration"),(0,a.yg)("p",null,"There are certain environment variables that need to be configured in the Prophecy admin UI."),(0,a.yg)("h3",{id:"edit-alert-configs"},"Edit Alert Configs"),(0,a.yg)("p",null,"To edit the alert configurations in Prophecy, follow these steps:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Log in to Prophecy as an admin user."),(0,a.yg)("li",{parentName:"ol"},"Navigate to the ",(0,a.yg)("strong",{parentName:"li"},"Admin")," tab of the Prophecy ",(0,a.yg)("strong",{parentName:"li"},"Settings")," page."),(0,a.yg)("li",{parentName:"ol"},"Within the Admin main tab, select the ",(0,a.yg)("strong",{parentName:"li"},"Config")," subtab."),(0,a.yg)("li",{parentName:"ol"},"Click on the ",(0,a.yg)("strong",{parentName:"li"},"Alert Config")," subtab to configure the alert settings.")),(0,a.yg)("h3",{id:"json-format"},"JSON format"),(0,a.yg)("p",null,"Below are JSON configurations within the Prophecy UI that need to be enabled to support this functionality. You will have to configure only the options which you require. Make sure to maintain a JSON format mentioned below while configuring the different options. Most of the values below are defaults or sample values."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},'{\n  "alertConfigs": [\n    {\n      "maxAllowedOccurrenceCount": 20,\n      "metricsType": "CPU_USAGE",\n      "thresholdValue": 0.95\n    },\n    {\n      "maxAllowedOccurrenceCount": 3,\n      "metricsType": "DISK_USAGE",\n      "thresholdValue": 0.95\n    },\n    {\n      "maxAllowedOccurrenceCount": 3,\n      "metricsType": "FILE_COUNT",\n      "thresholdValue": 0.95\n    },\n    {\n      "maxAllowedOccurrenceCount": 20,\n      "metricsType": "MEMORY_USAGE",\n      "thresholdValue": 0.8\n    }\n  ],\n  "enableAlerts": true,\n  "enableServiceSuspend": true,\n  "notificationEmailIDs": [\n    "customer1@test.com",\n    "customer2@test.com"\n  ],\n  "reAlertIntervalinMinutes": 120,\n  "relativeWarningThreshold": 0.05,\n  "smtp": {\n    "password": "********",\n    "senderEmailID": "sender@test.com",\n    "serverHostname": "smtp.test.com",\n    "serverPort": 587\n  },\n  "suspensionWindowinMinutes": 60\n}\n')),(0,a.yg)("h3",{id:"supported-configuration-variables"},"Supported configuration variables"),(0,a.yg)("table",null,(0,a.yg)("thead",{parentName:"table"},(0,a.yg)("tr",{parentName:"thead"},(0,a.yg)("th",{parentName:"tr",align:null},"Configuration variable name"),(0,a.yg)("th",{parentName:"tr",align:null},"Description"),(0,a.yg)("th",{parentName:"tr",align:null},"Default value"))),(0,a.yg)("tbody",{parentName:"table"},(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"alertConfigs.maxAllowedOccurrenceCount")),(0,a.yg)("td",{parentName:"tr",align:null},"Number of consecutive occurrences to hit before triggering an alert (warning/critical). Every interval defaults to 30s."),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"20 (or) 10mins")," for CPU/Memory, ",(0,a.yg)("inlineCode",{parentName:"td"},"3 (or) 1.5mins")," for Disk Usage/File Count")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"alertConfigs.metricsType")),(0,a.yg)("td",{parentName:"tr",align:null},"The metric type tracked"),(0,a.yg)("td",{parentName:"tr",align:null},"CPU_USAGE, DISK_USAGE, FILE_COUNT, MEMORY_USAGE")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"alertConfigs.thresholdValue")),(0,a.yg)("td",{parentName:"tr",align:null},"The threshold value beyond which alert is triggered. This is a fractional value between 0 and 1"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"0.8")," for MEMORY_USAGE and ",(0,a.yg)("inlineCode",{parentName:"td"},"0.95")," for others")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"enableAlerts")),(0,a.yg)("td",{parentName:"tr",align:null},"Enabling of alerting system"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"true"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"notificationEmailIDs")),(0,a.yg)("td",{parentName:"tr",align:null},"List of emails to notify in case of hitting alerts, this list is comma separated"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"[]"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"reAlertIntervalinMinutes")),(0,a.yg)("td",{parentName:"tr",align:null},"How often should triggered alerts resend the email in minutes"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"120"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"relativeWarningThreshold")),(0,a.yg)("td",{parentName:"tr",align:null},"It is the (configured threshold - relativeWarningThreshold) value after which ",(0,a.yg)("inlineCode",{parentName:"td"},"WARNING")," is generated before hitting ",(0,a.yg)("inlineCode",{parentName:"td"},"CRITICAL")," state. This is a fractional value between 0 and 1. Defaulted to 5% less than threshold value."),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"0.05"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"smtp.password")),(0,a.yg)("td",{parentName:"tr",align:null},"The password of the SMTP server credential. This is an encrypted value. Setting this to ",(0,a.yg)("inlineCode",{parentName:"td"},"NULL")," will disable email alerting."),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"NULL"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"smtp.senderEmailID")),(0,a.yg)("td",{parentName:"tr",align:null},"The send email ID at the SMTP server. Setting this to ",(0,a.yg)("inlineCode",{parentName:"td"},"NULL")," will disable SMTP email alerting."),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"NULL"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"smtp.serverHostname")),(0,a.yg)("td",{parentName:"tr",align:null},"The SMTP hostname of the server."),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"smtp.gmail.com"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"smtp.serverPort")),(0,a.yg)("td",{parentName:"tr",align:null},"The SMTP port of the server credential. Setting this to ",(0,a.yg)("inlineCode",{parentName:"td"},"0")," will disable SMTP email alerting."),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"587"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"suspensionWindowinMinutes")),(0,a.yg)("td",{parentName:"tr",align:null},"Time after which suspension of critical services is to be done in minutes"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"60"))))),(0,a.yg)("h2",{id:"alerting-guidelines"},"Alerting guidelines"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"The default configured values satisfy most use cases."),(0,a.yg)("li",{parentName:"ul"},"If you set ",(0,a.yg)("inlineCode",{parentName:"li"},"enableAlerts")," to false, this will disable the alerting system. Monitoring will still work and be visible from the Admin Monitoring subtab.")))}p.isMDXComponent=!0}}]);