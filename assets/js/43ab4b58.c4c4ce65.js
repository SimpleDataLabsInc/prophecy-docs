"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[75736],{15680:(e,t,a)=>{a.d(t,{xA:()=>u,yg:()=>m});var i=a(96540);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,i,n=function(e,t){if(null==e)return{};var a,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)a=r[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)a=r[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=i.createContext({}),p=function(e){var t=i.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},u=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},g=i.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),c=p(a),g=n,m=c["".concat(l,".").concat(g)]||c[g]||d[g]||r;return a?i.createElement(m,s(s({ref:t},u),{},{components:a})):i.createElement(m,s({ref:t},u))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,s=new Array(r);s[0]=g;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[c]="string"==typeof e?e:n,s[1]=o;for(var p=2;p<r;p++)s[p]=a[p];return i.createElement.apply(null,s)}return i.createElement.apply(null,a)}g.displayName="MDXCreateElement"},39945:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var i=a(58168),n=(a(96540),a(15680));const r={title:"Unit Testing",id:"tests",description:"Unit testing for Spark",sidebar_position:6,tags:["spark","development","CICD","testing","unit tests"]},s=void 0,o={unversionedId:"Spark/tests",id:"Spark/tests",title:"Unit Testing",description:"Unit testing for Spark",source:"@site/docs/Spark/tests.md",sourceDirName:"Spark",slug:"/Spark/tests",permalink:"/Spark/tests",draft:!1,tags:[{label:"spark",permalink:"/tags/spark"},{label:"development",permalink:"/tags/development"},{label:"CICD",permalink:"/tags/cicd"},{label:"testing",permalink:"/tags/testing"},{label:"unit tests",permalink:"/tags/unit-tests"}],version:"current",sidebarPosition:6,frontMatter:{title:"Unit Testing",id:"tests",description:"Unit testing for Spark",sidebar_position:6,tags:["spark","development","CICD","testing","unit tests"]},sidebar:"mySidebar",previous:{title:"Expression Builder",permalink:"/Spark/expression-builder"},next:{title:"Pipeline Monitoring",permalink:"/Spark/pipeline-monitoring/"}},l={},p=[{value:"Output rows equality",id:"output-rows-equality",level:2},{value:"Example",id:"output-rows-equality",level:3},{value:"Output predicates",id:"output-predicates",level:2},{value:"Example",id:"output-predicates",level:3},{value:"Generating sample data for test cases automatically",id:"generating-sample-data-for-test-cases-automatically",level:2},{value:"Generated code",id:"generated-code",level:2},{value:"Renaming the name of unit test",id:"renaming-the-name-of-unit-test",level:2}],u={toc:p},c="wrapper";function d(e){let{components:t,...a}=e;return(0,n.yg)(c,(0,i.A)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,n.yg)("p",null,"Writing good unit tests is one of the key stages of the CI/CD process. It ensures that the changes made by developers to projects will be verified and all the functionality will work correctly after deployment."),(0,n.yg)("p",null,"Prophecy makes the process of writing unit cases easier by giving an interactive environment via which unit test cases can be configured across each component."),(0,n.yg)("p",null,"There are two types of unit test cases which can be configured through Prophecy UI:"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Output rows equality"),(0,n.yg)("li",{parentName:"ol"},"Output predicates")),(0,n.yg)("p",null,"Let us understand both types in detail:"),(0,n.yg)("h2",{id:"output-rows-equality"},"Output rows equality"),(0,n.yg)("p",null,"Automatically takes a snapshot of the data for the component and allows to continuously test that the logic performs as intended. This would simply check the equality of the output rows."),(0,n.yg)("h3",{id:"output-rows-equality"},"Example"),(0,n.yg)("p",null,"In the below example we would create below unit tests:"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"To check the join condition correctly for one-to-one mappings."),(0,n.yg)("li",{parentName:"ol"},"To check the join condition correctly for one-to-many mappings.")),(0,n.yg)("div",{class:"wistia_responsive_padding",style:{padding:"56.25% 0 0 0",position:"relative"}},(0,n.yg)("div",{class:"wistia_responsive_wrapper",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"}},(0,n.yg)("iframe",{src:"https://user-images.githubusercontent.com/103921419/174785192-7d99a6e1-d8bf-445f-bf51-981526e3a1e6.mp4",title:"Output rows equality",allow:"autoplay;fullscreen",allowtransparency:"true",frameborder:"0",scrolling:"no",class:"wistia_embed",name:"wistia_embed",msallowfullscreen:!0,width:"100%",height:"100%"}))),(0,n.yg)("h2",{id:"output-predicates"},"Output predicates"),(0,n.yg)("p",null,"These are more advanced unit tests where multiple rules need to pass in order for the test as a whole to pass. Requires Spark expression to be used as predicates."),(0,n.yg)("h3",{id:"output-predicates"},"Example"),(0,n.yg)("p",null,"In the below example we will create below unit tests:"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Check that the value of amount column is ",(0,n.yg)("inlineCode",{parentName:"li"},">0"),"."),(0,n.yg)("li",{parentName:"ol"},"Check whether first name is not equal to last name.")),(0,n.yg)("div",{class:"wistia_responsive_padding",style:{padding:"56.25% 0 0 0",position:"relative"}},(0,n.yg)("div",{class:"wistia_responsive_wrapper",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"}},(0,n.yg)("iframe",{src:"https://user-images.githubusercontent.com/103921419/174785268-5266a044-087f-40cb-a846-f7b548275986.mp4",title:"Output predicates",allow:"autoplay;fullscreen",allowtransparency:"true",frameborder:"0",scrolling:"no",class:"wistia_embed",name:"wistia_embed",msallowfullscreen:!0,width:"100%",height:"100%"}))),(0,n.yg)("h2",{id:"generating-sample-data-for-test-cases-automatically"},"Generating sample data for test cases automatically"),(0,n.yg)("p",null,"To generate sample input data automatically from the source DataFrame, this option can be enabled while creating unit test."),(0,n.yg)("admonition",{type:"note"},(0,n.yg)("p",{parentName:"admonition"},"Pipeline needs to run once, to generate units test based on auto-generated sample data.")),(0,n.yg)("p",null,"Let's generate sample data automatically for the unit test case we created in above example."),(0,n.yg)("div",{class:"wistia_responsive_padding",style:{padding:"56.25% 0 0 0",position:"relative"}},(0,n.yg)("div",{class:"wistia_responsive_wrapper",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"}},(0,n.yg)("iframe",{src:"https://user-images.githubusercontent.com/103921419/174785504-6ee9b766-958a-4dd8-8fc8-9835a3fb4294.mp4",title:"Generate sample data",allow:"autoplay;fullscreen",allowtransparency:"true",frameborder:"0",scrolling:"no",class:"wistia_embed",name:"wistia_embed",msallowfullscreen:!0,width:"100%",height:"100%"}))),(0,n.yg)("h2",{id:"generated-code"},"Generated code"),(0,n.yg)("p",null,"Behind the scenes, the code for unit tests is automatically generated in our repository.\nLet's have a look at the generated code for our unit test above."),(0,n.yg)("div",{class:"wistia_responsive_padding",style:{padding:"56.25% 0 0 0",position:"relative"}},(0,n.yg)("div",{class:"wistia_responsive_wrapper",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"}},(0,n.yg)("iframe",{src:"https://user-images.githubusercontent.com/103921419/174785480-294ca5de-9fd2-4e17-94a7-078a3619dddc.mp4",title:"Generate code",allow:"autoplay;fullscreen",allowtransparency:"true",frameborder:"0",scrolling:"no",class:"wistia_embed",name:"wistia_embed",msallowfullscreen:!0,width:"100%",height:"100%"}))),(0,n.yg)("h2",{id:"renaming-the-name-of-unit-test"},"Renaming the name of unit test"),(0,n.yg)("div",{class:"wistia_responsive_padding",style:{padding:"56.25% 0 0 0",position:"relative"}},(0,n.yg)("div",{class:"wistia_responsive_wrapper",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"}},(0,n.yg)("iframe",{src:"https://user-images.githubusercontent.com/103921419/174785461-8d717efb-87a7-44d2-82a0-d0db6e833b29.mp4",title:"Generate code",allow:"autoplay;fullscreen",allowtransparency:"true",frameborder:"0",scrolling:"no",class:"wistia_embed",name:"wistia_embed",msallowfullscreen:!0,width:"100%",height:"100%"}))))}d.isMDXComponent=!0}}]);