<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-analysts/development/gems/source-target/table/write-options" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Write Options | Prophecy</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.prophecy.io/table-write-options"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Write Options | Prophecy"><meta data-rh="true" name="description" content="Determine how to store processed data and handle changes over time"><meta data-rh="true" property="og:description" content="Determine how to store processed data and handle changes over time"><link data-rh="true" rel="icon" href="/img/favicon2.png"><link data-rh="true" rel="canonical" href="https://docs.prophecy.io/table-write-options"><link data-rh="true" rel="alternate" href="https://docs.prophecy.io/table-write-options" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.prophecy.io/table-write-options" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Pipeline development","item":"https://docs.prophecy.io/analysts/pipeline-development"},{"@type":"ListItem","position":2,"name":"Gems","item":"https://docs.prophecy.io/analysts/gems"},{"@type":"ListItem","position":3,"name":"Source and Target","item":"https://docs.prophecy.io/analysts/source-target"},{"@type":"ListItem","position":4,"name":"Tables (Warehouse)","item":"https://docs.prophecy.io/analysts/table-gems"},{"@type":"ListItem","position":5,"name":"Write Options","item":"https://docs.prophecy.io/table-write-options"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="Prophecy" href="/opensearch.xml">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/assets/css/styles.fb59e090.css">
<script src="/assets/js/runtime~main.0c9c80e2.js" defer="defer"></script>
<script src="/assets/js/main.2137401c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Prophecy Logo.png" alt="Prophecy Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/Prophecy Logo White.png" alt="Prophecy Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/">Getting started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/guides/index">Guides</a><a class="navbar__item navbar__link" href="/api/">API</a><a href="https://transpiler.docs.prophecy.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Migration</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/getting-help">Help</a><a href="http://app.prophecy.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Login</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="custom-search-container" style="display:flex;align-items:center;gap:10px;height:30px;min-width:0;flex-shrink:1"><div style="flex:1 1 auto;min-width:0"><div id="inkeep-shadowradix-:R5spah:" style="display:contents"></div><span></span></div><div style="flex:0 0 auto"><div id="inkeep-shadowradix-:R6spah:" style="display:contents"></div><span></span></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/guides/index">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><span class="sidebar-divider"></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item sidebar-title">Analysts</li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/administration/fabrics/prophecy-fabrics/">Fabric setup</a><button aria-label="Expand sidebar category &#x27;Fabric setup&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/analysts/pipeline-development">Pipeline development</a><button aria-label="Collapse sidebar category &#x27;Pipeline development&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/pipelines">Pipelines</a><button aria-label="Expand sidebar category &#x27;Pipelines&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/analysts/gems">Gems</a><button aria-label="Collapse sidebar category &#x27;Gems&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/analysts/source-target">Source and Target</a><button aria-label="Collapse sidebar category &#x27;Source and Target&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/analysts/table-gems">Tables (Warehouse)</a><button aria-label="Collapse sidebar category &#x27;Tables (Warehouse)&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/analysts/prophecy-in-memory">Prophecy In Memory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/analysts/databricks-table">Databricks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/analysts/bigquery-table">Google BigQuery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/analysts/upload-file">Upload files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/table-write-options">Write Options</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/table-external-gems">Tables (External systems)</a><button aria-label="Expand sidebar category &#x27;Tables (External systems)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/file-storage">File storage systems</a><button aria-label="Expand sidebar category &#x27;File storage systems&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/analysts/multi-source-table">Troubleshooting</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/transform-gems">Transform</a><button aria-label="Expand sidebar category &#x27;Transform&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/prepare-gems">Prepare</a><button aria-label="Expand sidebar category &#x27;Prepare&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/join-gems">Join</a><button aria-label="Expand sidebar category &#x27;Join&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/spatial-gems">Spatial</a><button aria-label="Expand sidebar category &#x27;Spatial&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/parse-gems">Parse</a><button aria-label="Expand sidebar category &#x27;Parse&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/report-gems">Report</a><button aria-label="Expand sidebar category &#x27;Report&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/custom-gems">Custom</a><button aria-label="Expand sidebar category &#x27;Custom&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/visual-expression-builder">Visual expressions</a><button aria-label="Expand sidebar category &#x27;Visual expressions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/ai-features">Prophecy AI</a><button aria-label="Expand sidebar category &#x27;Prophecy AI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/analysts/connections">Connections</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/data-explorer">Data exploration</a><button aria-label="Expand sidebar category &#x27;Data exploration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/data-tests">Data tests</a><button aria-label="Expand sidebar category &#x27;Data tests&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/analysts/collaboration">Collaboration</a><button aria-label="Expand sidebar category &#x27;Collaboration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/analysts/folders">Organization</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/analysts/versioning">Versioning</a><button aria-label="Expand sidebar category &#x27;Versioning&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/analysts/scheduling">Scheduling</a><button aria-label="Expand sidebar category &#x27;Scheduling&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/analysts/monitoring">Monitoring</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/analysts/extensibility">Extensibility</a><button aria-label="Expand sidebar category &#x27;Extensibility&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/analysts/business-applications">Prophecy Apps</a><button aria-label="Expand sidebar category &#x27;Prophecy Apps&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><span class="sidebar-divider"></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item sidebar-title">Engineers</li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/administration/fabrics">Fabric setup</a><button aria-label="Expand sidebar category &#x27;Fabric setup&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/engineers/pipeline-development">Pipeline development</a><button aria-label="Expand sidebar category &#x27;Pipeline development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/engineers/models">Models</a><button aria-label="Expand sidebar category &#x27;Models&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/engineers/lineage">Lineage</a><button aria-label="Expand sidebar category &#x27;Lineage&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/engineers/ci-cd">CI/CD</a><button aria-label="Expand sidebar category &#x27;CI/CD&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/engineers/orchestration">Orchestration</a><button aria-label="Expand sidebar category &#x27;Orchestration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/engineers/extensibility">Extensibility</a><button aria-label="Expand sidebar category &#x27;Extensibility&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/administration/project-types/">Project types</a><button aria-label="Expand sidebar category &#x27;Project types&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/analysts/pipeline-development"><span>Pipeline development</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/analysts/gems"><span>Gems</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/analysts/source-target"><span>Source and Target</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/analysts/table-gems"><span>Tables (Warehouse)</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Write Options</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Write Options</h1></header><p>When writing data to a table, there are multiple ways to determine how the data will be written. When you configure a target table or target model, the <strong>Write Options</strong> tab lets you determine how you will store your processed data and handle changes to the data over time. The choice of write mode depends on your specific use case.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="write-modes">Write modes<a href="#write-modes" class="hash-link" aria-label="Direct link to Write modes" title="Direct link to Write modes">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wipe-and-replace-table-default">Wipe and Replace Table (default)<a href="#wipe-and-replace-table-default" class="hash-link" aria-label="Direct link to Wipe and Replace Table (default)" title="Direct link to Wipe and Replace Table (default)">​</a></h3>
<p>Replaces all existing data with new data on each run. This is the simplest approach and ensures your target table always reflects the latest state of your source data.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The incoming table must have the same schema as the existing table.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-replace-vehicle-registry">Example: Replace vehicle registry<a href="#example-replace-vehicle-registry" class="hash-link" aria-label="Direct link to Example: Replace vehicle registry" title="Direct link to Example: Replace vehicle registry">​</a></h4>
<p>A full vehicle registry is refreshed each day, replacing all prior records with the latest list.</p>
<div class="table-example"><p><strong>Incoming table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>TYPE</th><th>REGISTERED_AT</th></tr></thead><tbody><tr><td>201</td><td>Bus</td><td>2024-01-15</td></tr><tr><td>202</td><td>Train</td><td>2024-01-16</td></tr></tbody></table><p><strong>Existing table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>TYPE</th><th>REGISTERED_AT</th></tr></thead><tbody><tr><td>101</td><td>Bus</td><td>2023-12-01</td></tr><tr><td>102</td><td>Tram</td><td>2023-12-02</td></tr></tbody></table><p><strong>Updated table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>TYPE</th><th>REGISTERED_AT</th></tr></thead><tbody><tr><td>201</td><td>Bus</td><td>2024-01-15</td></tr><tr><td>202</td><td>Train</td><td>2024-01-16</td></tr></tbody></table><p>Notice that all previous records (vehicles <code>101</code> and <code>102</code>) have been completely removed and replaced with the new incoming data.</p></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="partition-the-target-table-bigquery-only">Partition the target table (BigQuery only)<a href="#partition-the-target-table-bigquery-only" class="hash-link" aria-label="Direct link to Partition the target table (BigQuery only)" title="Direct link to Partition the target table (BigQuery only)">​</a></h4>
<p>The following partitioning parameters are available for the <strong>Wipe and Replace Table</strong> write mode on BigQuery.</p>
<table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Column Name</td><td>The name of the column used for partitioning the target table.</td></tr><tr><td>Data Type</td><td>The data type of the partition column. <br>Supported types: <code>timestamp</code>, <code>date</code>, <code>datetime</code>, and <code>int64</code>.</td></tr><tr><td>Partition By granularity</td><td>Applicable only to <code>timestamp</code>, <code>date</code>, or <code>datetime</code> data type. <br>Defines the time-based partition granularity: <code>hour</code>, <code>day</code>, <code>month</code>, or <code>year</code>.</td></tr><tr><td>Partition Range</td><td>Applicable only to <code>int64</code> data type. <br>Specify a numeric range for partitioning using a <strong>start</strong>, <strong>end</strong>, and <strong>interval</strong> value (e.g., start=<code>0</code>, end=<code>1000</code>, interval=<code>10</code>).<br>You must define an interval value so that Prophecy knows at what intervals to create the partitions.</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Only BigQuery tables can be partitioned at the table level. To learn more about partitioning, jump to <a href="#partitioning">Partitioning</a>.</p></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="append-row">Append Row<a href="#append-row" class="hash-link" aria-label="Direct link to Append Row" title="Direct link to Append Row">​</a></h3>
<p>Adds new rows to the existing table without modifying existing data. No deduplication is performed, so you may end up with duplicate records.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>This strategy is best used when unique keys aren&#x27;t required. For key-based updates, use one of the Merge options instead.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-add-daily-trips">Example: Add daily trips<a href="#example-add-daily-trips" class="hash-link" aria-label="Direct link to Example: Add daily trips" title="Direct link to Example: Add daily trips">​</a></h4>
<p>Daily trips are appended so that historical trips remain intact.</p>
<div class="table-example"><p><strong>Incoming table</strong></p><table><thead><tr><th>TRIP_ID</th><th>VEHICLE_ID</th><th>DATE</th></tr></thead><tbody><tr><td>301</td><td>201</td><td>2024-01-15</td></tr><tr><td>302</td><td>202</td><td>2024-01-15</td></tr></tbody></table><p><strong>Existing table</strong></p><table><thead><tr><th>TRIP_ID</th><th>VEHICLE_ID</th><th>DATE</th></tr></thead><tbody><tr><td>101</td><td>101</td><td>2024-01-14</td></tr><tr><td>102</td><td>102</td><td>2024-01-14</td></tr></tbody></table><p><strong>Updated table</strong></p><table><thead><tr><th>TRIP_ID</th><th>VEHICLE_ID</th><th>DATE</th></tr></thead><tbody><tr><td>101</td><td>101</td><td>2024-01-14</td></tr><tr><td>102</td><td>102</td><td>2024-01-14</td></tr><tr><td>301</td><td>201</td><td>2024-01-15</td></tr><tr><td>302</td><td>202</td><td>2024-01-15</td></tr></tbody></table><p>Notice that the new trips (<code>301</code> and <code>302</code>) are added to the existing table without modifying the original records (<code>101</code> and <code>102</code>).</p></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="merge---upsert-row">Merge - Upsert Row<a href="#merge---upsert-row" class="hash-link" aria-label="Direct link to Merge - Upsert Row" title="Direct link to Merge - Upsert Row">​</a></h3>
<p>If a row with the same key exists, it is updated. Otherwise, a new row is inserted. You can also limit updates to specific columns, so only selected values are changed in matching rows.</p>
<div class="fixed-table"><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Unique Key</td><td>Column(s) used to match existing records in the target dataset. In many cases, the unique key will be equivalent to your table&#x27;s primary key, if applicable.</td></tr><tr><td>Use Predicate</td><td>Lets you add conditions that specify when to apply the merge.</td></tr><tr><td>Use a condition to filter data or incremental runs</td><td>Enables applying conditions for filtering the incoming data into the table.</td></tr><tr><td>Merge Columns</td><td>Specifies which columns to update during the merge. If empty, the merge includes all columns.</td></tr><tr><td>Exclude Columns</td><td>Defines columns that should be excluded from the merge operation.</td></tr><tr><td>(Advanced) On Schema Change</td><td>Specifies how schema changes should be handled during the merge process.<ul><li><strong>ignore</strong>: Newly added columns will not be written to the model. This is the default option.</li><li><strong>fail</strong>: Triggers an error message when the source and target schemas diverge.</li><li><strong>append_new_columns</strong>: Append new columns to the existing table.</li><li><strong>sync_all_columns</strong>: Adds any new columns to the existing table, and removes any columns that are now missing. Includes data type changes. This option uses the output of the previous gem.</li></ul></td></tr></tbody></table></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-update-vehicle-type-only">Example: Update vehicle type only<a href="#example-update-vehicle-type-only" class="hash-link" aria-label="Direct link to Example: Update vehicle type only" title="Direct link to Example: Update vehicle type only">​</a></h4>
<p>When an incoming <code>VEHICLE_ID</code> matches an existing one, vehicle type information is updated while registration dates remain unchanged. The merge column is explicitly set to <code>TYPE</code>.</p>
<div class="table-example"><p><strong>Incoming table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>TYPE</th></tr></thead><tbody><tr><td>101</td><td>Tram</td></tr><tr><td>102</td><td>Bus</td></tr><tr><td>104</td><td>Bus</td></tr></tbody></table><p><strong>Existing table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>TYPE</th><th>REGISTERED_AT</th></tr></thead><tbody><tr><td>101</td><td>Bus</td><td>2023-12-01</td></tr><tr><td>102</td><td>Train</td><td>2023-12-02</td></tr><tr><td>103</td><td>Bus</td><td>2023-12-03</td></tr></tbody></table><p><strong>Updated table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>TYPE</th><th>REGISTERED_AT</th></tr></thead><tbody><tr><td>101</td><td>Tram</td><td>2023-12-01</td></tr><tr><td>102</td><td>Bus</td><td>2023-12-02</td></tr><tr><td>103</td><td>Bus</td><td>2023-12-03</td></tr><tr><td>104</td><td>Bus</td><td>null</td></tr></tbody></table><p>Notice that only the <code>TYPE</code> column was updated for vehicles <code>101</code> and <code>102</code> while the <code>REGISTERED_AT</code> values remained unchanged. Additionally, note that vehicle <code>103</code> remained unchanged since it didn&#x27;t match a vehicle in the incoming data. Finally, vehicle <code>104</code> was inserted, and no data was added to the <code>REGISTERED_AT</code> column.</p></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="merge---wipe-and-replace-partitions">Merge - Wipe and Replace Partitions<a href="#merge---wipe-and-replace-partitions" class="hash-link" aria-label="Direct link to Merge - Wipe and Replace Partitions" title="Direct link to Merge - Wipe and Replace Partitions">​</a></h3>
<p>Replaces entire partitions in the target table. Only partitions containing updated data will be overwritten; other partitions will not be modified.</p>
<div class="fixed-table"><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Partition by</td><td>Defines the partitions of the target table.<ul><li><strong>Databricks</strong>: Each unique value of the partition column corresponds to a partition. You cannot change the granularity of the partitions.</li><li><strong>BigQuery</strong>: You must <a href="#define-partition-granularity-bigquery-only">manually define the granularity</a> of your partitions. BigQuery does not automatically infer how to write the partitions.</li></ul></td></tr><tr><td>(Advanced) On Schema Change</td><td>Specifies how schema changes should be handled during the merge process.<ul><li><strong>ignore</strong>: Newly added columns will not be written to the model. This is the default option.</li><li><strong>fail</strong>: Triggers an error message when the source and target schemas diverge.</li><li><strong>append_new_columns</strong>: Append new columns to the existing table.</li><li><strong>sync_all_columns</strong>: Adds any new columns to the existing table, and removes any columns that are now missing. Includes data type changes. This option uses the output of the previous gem.</li></ul></td></tr></tbody></table></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-update-trips-for-a-specific-day">Example: Update trips for a specific day<a href="#example-update-trips-for-a-specific-day" class="hash-link" aria-label="Direct link to Example: Update trips for a specific day" title="Direct link to Example: Update trips for a specific day">​</a></h4>
<p>In this case, the partition column is the <code>DATE</code> column, where each partition corresponds to a single day. Since the incoming data includes records from <code>2024-01-15</code>, all of the records from that date are dropped from the existing table and replaced with the new data.</p>
<div class="table-example"><p><strong>Incoming table</strong></p><table><thead><tr><th>TRIP_ID</th><th>VEHICLE_ID</th><th>DATE</th></tr></thead><tbody><tr><td>401</td><td>201</td><td>2024-01-15</td></tr><tr><td>402</td><td>202</td><td>2024-01-15</td></tr></tbody></table><p><strong>Existing table</strong></p><table><thead><tr><th>TRIP_ID</th><th>VEHICLE_ID</th><th>DATE</th></tr></thead><tbody><tr><td>101</td><td>101</td><td>2024-01-14</td></tr><tr><td>301</td><td>201</td><td>2024-01-15</td></tr><tr><td>302</td><td>202</td><td>2024-01-15</td></tr></tbody></table><p><strong>Updated table</strong></p><table><thead><tr><th>TRIP_ID</th><th>VEHICLE_ID</th><th>DATE</th></tr></thead><tbody><tr><td>101</td><td>101</td><td>2024-01-14</td></tr><tr><td>401</td><td>201</td><td>2024-01-15</td></tr><tr><td>402</td><td>202</td><td>2024-01-15</td></tr></tbody></table><p>Notice that only the <code>2024-01-15</code> partition was replaced with new data, while the <code>2024-01-14</code> partition remained untouched.</p></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="define-partition-granularity-bigquery-only">Define partition granularity (BigQuery only)<a href="#define-partition-granularity-bigquery-only" class="hash-link" aria-label="Direct link to Define partition granularity (BigQuery only)" title="Direct link to Define partition granularity (BigQuery only)">​</a></h4>
<p>The following partitioning parameters allow you to define the partition granularity for this operation.</p>
<table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Column Name</td><td>The name of the column used for partitioning the target table.</td></tr><tr><td>Data Type</td><td>The data type of the partition column. <br>Supported types: <code>timestamp</code>, <code>date</code>, <code>datetime</code>, and <code>int64</code>.</td></tr><tr><td>Partition By granularity</td><td>Applicable only to <code>timestamp</code>, <code>date</code>, or <code>datetime</code> data type. <br>Defines the time-based partition granularity: <code>hour</code>, <code>day</code>, <code>month</code>, or <code>year</code>.</td></tr><tr><td>Partition Range</td><td>Applicable only to <code>int64</code> data type. <br>Specify a numeric range for partitioning using a <strong>start</strong>, <strong>end</strong>, and <strong>interval</strong> value (e.g., start=<code>0</code>, end=<code>1000</code>, interval=<code>10</code>).<br>You must define an interval value so that Prophecy knows at what intervals to create the partitions.</td></tr></tbody></table>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="merge---scd2">Merge - SCD2<a href="#merge---scd2" class="hash-link" aria-label="Direct link to Merge - SCD2" title="Direct link to Merge - SCD2">​</a></h3>
<p>Tracks historical changes by adding new rows instead of updating existing ones. This lets you preserve a complete history, since every change generates a new entry rather than erasing old information. To be specific:</p>
<ul>
<li>New rows are added for incoming records with unique keys that don&#x27;t exist in the target table.</li>
<li>For records matching existing unique keys, a new row is added only when the incoming data differs from the existing record.</li>
<li>New rows are assigned a start date and a <code>null</code> end date (indicating it&#x27;s currently valid).</li>
<li>If the unique key of the new record matched an existing record, the existing row is assigned an end date to mark when it stopped being valid.</li>
<li>This creates a complete timeline showing how data evolved over time.</li>
</ul>
<div class="fixed-table"><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Unique Key</td><td>Column(s) used to match existing records in the target dataset. In many cases, the unique key will be equivalent to your table&#x27;s primary key, if applicable.</td></tr><tr><td>Invalidate deleted rows</td><td>When enabled, records that match deleted rows will be marked as no longer valid.</td></tr><tr><td>Determine new records by checking timestamp column</td><td>Recognizes new records by the time from the <strong>Updated at</strong> column that you define.</td></tr><tr><td>Determine new records by looking for differences in column values</td><td>Recognizes new records based on a change of values in one or more specified columns.</td></tr></tbody></table></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-route-assignment-history">Example: Route assignment history<a href="#example-route-assignment-history" class="hash-link" aria-label="Direct link to Example: Route assignment history" title="Direct link to Example: Route assignment history">​</a></h4>
<p>Each time a vehicle changes routes, a new row is added to preserve history. In this case, <strong>Determine new records by checking timestamp column</strong> is enabled, and <code>ASSIGNED_AT</code> is the timestamp column.</p>
<div class="table-example"><p><strong>Incoming table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>ROUTE</th><th>ASSIGNED_AT</th></tr></thead><tbody><tr><td>101</td><td>Route B</td><td>2024-01-15</td></tr></tbody></table><p><strong>Existing table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>ROUTE</th><th>ASSIGNED_AT</th><th>valid_from</th><th>valid_to</th></tr></thead><tbody><tr><td>101</td><td>Route A</td><td>2024-01-01</td><td>2024-01-01</td><td>NULL</td></tr></tbody></table><p><strong>Updated table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>ROUTE</th><th>ASSIGNED_AT</th><th>valid_from</th><th>valid_to</th></tr></thead><tbody><tr><td>101</td><td>Route A</td><td>2024-01-01</td><td>2024-01-01</td><td>2024-01-15</td></tr><tr><td>101</td><td>Route B</td><td>2024-01-15</td><td>2024-01-15</td><td>NULL</td></tr></tbody></table><p>Notice that the original Route A record now has an end date (<code>2024-01-15</code> taken from the <code>ASSIGNED_AT</code> column) and a new Route B record was added with a null end date, preserving the complete history of route assignments.</p></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="merge---update-row">Merge - Update Row<a href="#merge---update-row" class="hash-link" aria-label="Direct link to Merge - Update Row" title="Direct link to Merge - Update Row">​</a></h3>
<p>Update records that match conditions defined in the <strong>Use Predicate</strong> parameter. Instead of updating individual rows, it replaces the entire partition of the table that matches the given predicate. The predicate defines which rows in the target table should be fully replaced with the incoming data.</p>
<div class="fixed-table"><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Use Predicate</td><td>Lets you add conditions that specify when to apply the merge.</td></tr><tr><td>Use a condition to filter data or incremental runs</td><td>Enables applying conditions for filtering the incoming data into the table.</td></tr><tr><td>(Advanced) On Schema Change</td><td>Specifies how schema changes should be handled during the merge process.<ul><li><strong>ignore</strong>: Newly added columns will not be written to the model. This is the default option.</li><li><strong>fail</strong>: Triggers an error message when the source and target schemas diverge.</li><li><strong>append_new_columns</strong>: Append new columns to the existing table.</li><li><strong>sync_all_columns</strong>: Adds any new columns to the existing table, and removes any columns that are now missing. Includes data type changes. This option uses the output of the previous gem.</li></ul></td></tr></tbody></table></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-update-trips-from-january-5th-onwards">Example: Update trips from January 5th onwards<a href="#example-update-trips-from-january-5th-onwards" class="hash-link" aria-label="Direct link to Example: Update trips from January 5th onwards" title="Direct link to Example: Update trips from January 5th onwards">​</a></h4>
<p>When any record from January 5th onwards needs updating, ALL records from that date forward are dropped and replaced with the incoming data. Records from before January 5th remain unchanged.</p>
<p><strong>Predicate</strong>: <code>DATE &gt;= &#x27;2024-01-05&#x27;</code></p>
<div class="table-example"><p><strong>Incoming table</strong></p><table><thead><tr><th>TRIP_ID</th><th>STATUS</th><th>DATE</th></tr></thead><tbody><tr><td>201</td><td>Closed</td><td>2024-01-05</td></tr><tr><td>203</td><td>Closed</td><td>2024-01-10</td></tr></tbody></table><p><strong>Existing table</strong></p><table><thead><tr><th>TRIP_ID</th><th>VEHICLE_ID</th><th>DATE</th><th>STATUS</th></tr></thead><tbody><tr><td>201</td><td>101</td><td>2024-01-05</td><td>Open</td></tr><tr><td>202</td><td>102</td><td>2023-12-20</td><td>Open</td></tr><tr><td>203</td><td>103</td><td>2024-01-10</td><td>Open</td></tr><tr><td>204</td><td>104</td><td>2024-01-15</td><td>Open</td></tr></tbody></table><p><strong>Updated table</strong></p><table><thead><tr><th>TRIP_ID</th><th>VEHICLE_ID</th><th>DATE</th><th>STATUS</th></tr></thead><tbody><tr><td>201</td><td>101</td><td>2024-01-05</td><td>Closed</td></tr><tr><td>203</td><td>103</td><td>2024-01-10</td><td>Closed</td></tr><tr><td>202</td><td>102</td><td>2023-12-20</td><td>Open</td></tr></tbody></table><p>Notice that ALL trips from January 5th onwards (<code>201</code>, <code>203</code>, and <code>204</code>) were dropped and replaced with only the incoming records (<code>201</code> and <code>203</code>), while trip <code>202</code> (from December 20th) remained unchanged.</p></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="merge---delete-and-insert">Merge - Delete and Insert<a href="#merge---delete-and-insert" class="hash-link" aria-label="Direct link to Merge - Delete and Insert" title="Direct link to Merge - Delete and Insert">​</a></h3>
<p>For rows in the target table that have keys that match rows in the incoming dataset, deletes matching rows from the existing table and replaces them. For incoming rows with new keys, inserts these normally. This ensures that updated records are fully replaced instead of partially updated.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This strategy helps when your unique key is not truly unique (multiple rows per key need to be fully refreshed).</p></div></div>
<div class="fixed-table"><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td>Unique Key</td><td>Column(s) used to match existing records in the target dataset.</td></tr><tr><td>Use Predicate</td><td>Lets you add conditions that specify when to apply the merge.</td></tr><tr><td>Use a condition to filter data or incremental runs</td><td>Enables applying conditions for filtering the incoming data into the table.</td></tr><tr><td>(Advanced) On Schema Change</td><td>Specifies how schema changes should be handled during the merge process.<ul><li><strong>ignore</strong>: Newly added columns will not be written to the model. This is the default option.</li><li><strong>fail</strong>: Triggers an error message when the source and target schemas diverge.</li><li><strong>append_new_columns</strong>: Append new columns to the existing table.</li><li><strong>sync_all_columns</strong>: Adds any new columns to the existing table, and removes any columns that are now missing. Includes data type changes. This option uses the output of the previous gem.</li></ul></td></tr></tbody></table></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-refresh-vehicle-registry-entries">Example: Refresh vehicle registry entries<a href="#example-refresh-vehicle-registry-entries" class="hash-link" aria-label="Direct link to Example: Refresh vehicle registry entries" title="Direct link to Example: Refresh vehicle registry entries">​</a></h4>
<p>If a vehicle already exists in the fleet, its old record is deleted and replaced with the incoming row. New vehicles are simply inserted.</p>
<div class="table-example"><p><strong>Incoming table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>TYPE</th><th>REGISTERED_AT</th></tr></thead><tbody><tr><td>201</td><td>Train</td><td>2024-01-15</td></tr><tr><td>203</td><td>Bus</td><td>2024-01-16</td></tr></tbody></table><p><strong>Existing table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>TYPE</th><th>REGISTERED_AT</th></tr></thead><tbody><tr><td>201</td><td>Train</td><td>2023-12-01</td></tr><tr><td>202</td><td>Tram</td><td>2023-12-02</td></tr></tbody></table><p><strong>Updated table</strong></p><table><thead><tr><th>VEHICLE_ID</th><th>TYPE</th><th>REGISTERED_AT</th></tr></thead><tbody><tr><td>201</td><td>Train</td><td>2024-01-15</td></tr><tr><td>202</td><td>Tram</td><td>2023-12-02</td></tr><tr><td>203</td><td>Bus</td><td>2024-01-16</td></tr></tbody></table><p>Notice that vehicle <code>201</code>&#x27;s old record was completely replaced with the new data, vehicle <code>202</code> remained unchanged, and vehicle <code>203</code> was added as a new entry.</p></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-write-modes-work">How write modes work<a href="#how-write-modes-work" class="hash-link" aria-label="Direct link to How write modes work" title="Direct link to How write modes work">​</a></h2>
<p>Prophecy simplifies data transformation by providing intuitive write mode options that abstract away the complexity of underlying SQL operations. Behind the scenes, Prophecy generates dbt models that implement these write strategies using SQL warehouse-specific commands.</p>
<table><thead><tr><th>Write mode</th><th>Concept in dbt</th></tr></thead><tbody><tr><td>Wipe and Replace Tables</td><td>Maps to dbt&#x27;s <code>materialized: &#x27;table&#x27;</code> strategy, which creates a new table on each run.</td></tr><tr><td>Append Rows</td><td>Maps to dbt&#x27;s <code>materialized: &#x27;table&#x27;</code> with append-only logic, adding new rows without modifying existing data.</td></tr><tr><td>Merge options</td><td>Maps to dbt&#x27;s <code>materialized: &#x27;incremental&#x27;</code> <a href="https://docs.getdbt.com/docs/build/incremental-models-overview" target="_blank" rel="noopener noreferrer">strategy</a>, which updates tables by only transforming and loading new or changed data since the last run.</td></tr></tbody></table>
<p>When you select a write mode in a Table gem, Prophecy automatically generates the appropriate dbt configuration and SQL logic. This means you can focus on your data transformation logic rather than learning dbt&#x27;s materialization strategies or writing complex SQL merge statements.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>To understand exactly what happens when Prophecy runs these write operations, switch to the <strong>Code</strong> view of your project and inspect the generated dbt model files. These files contain the SQL statements and dbt configuration (like <code>materialized: &#x27;incremental&#x27;</code>) that dbt uses to execute the write operation. To learn more about the specific configuration options available for each SQL warehouse, visit the dbt documentation links below.</p><ul>
<li><a href="https://docs.getdbt.com/reference/resource-configs/bigquery-configs" target="_blank" rel="noopener noreferrer">BigQuery configurations</a></li>
<li><a href="https://docs.getdbt.com/reference/resource-configs/databricks-configs" target="_blank" rel="noopener noreferrer">Databricks configurations</a></li>
<li><a href="https://docs.getdbt.com/reference/resource-configs/snowflake-configs" target="_blank" rel="noopener noreferrer">Snowflake configurations</a></li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="partitioning">Partitioning<a href="#partitioning" class="hash-link" aria-label="Direct link to Partitioning" title="Direct link to Partitioning">​</a></h2>
<p>Depending on the SQL warehouse you use to write tables, partitioning can have different behavior. Let&#x27;s examine the differences between partitioning in Google BigQuery and Databricks.</p>
<ol>
<li>
<p><strong>BigQuery</strong>: Partitioning is a table property.</p>
<p>In BigQuery, partitioning is defined at the table schema level (time, integer range, or column value). Because it is a part of the table architecture, the physical storage in BigQuery is optimized by partitioning automatically.</p>
<p>Once a table is partitioned, every write to that table, full or incremental, respects the partitioning. That means even when you drop and create an entirely new table, BigQuery creates the table with partitions in an optimized way.</p>
</li>
<li>
<p><strong>Databricks</strong>: Partitioning is a write strategy.</p>
<p>Databricks organizes data in folders by column values. Partitioning only makes sense when you’re using the <strong>Wipe and Replace Partitions</strong> write mode because it allows you to overwrite specific directories (partitions) without rewriting the whole table.</p>
<p>For the <strong>Wipe and Replace Table</strong> option, the table is dropped and completely recreated. Partitioning doesn’t add any runtime benefit here, so this is not an option for Databricks.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="write-modes-matrix">Write modes matrix<a href="#write-modes-matrix" class="hash-link" aria-label="Direct link to Write modes matrix" title="Direct link to Write modes matrix">​</a></h2>
<p>The following table describes the write modes that Prophecy supports by SQL warehouse and gem type.</p>
<table><thead><tr><th>Write mode</th><th>Databricks table</th><th>Databricks model</th><th>BigQuery table</th><th>BigQuery model</th><th>Snowflake model</th></tr></thead><tbody><tr><td>Wipe and Replace Table</td><td>✔</td><td>✔</td><td>✔</td><td>✔</td><td>✔</td></tr><tr><td>Append Row</td><td>✔</td><td>✔</td><td>✔</td><td></td><td>✔</td></tr><tr><td>Merge - Upsert Row</td><td>✔</td><td>✔</td><td>✔</td><td>✔</td><td>✔</td></tr><tr><td>Merge - Wipe and Replace Partitions</td><td>✔</td><td>✔</td><td>✔</td><td>✔</td><td></td></tr><tr><td>Merge - SCD2</td><td>✔</td><td>✔</td><td>✔</td><td>✔</td><td>✔</td></tr><tr><td>Merge - Update Row</td><td>✔</td><td>✔</td><td></td><td></td><td></td></tr><tr><td>Merge - Delete and Insert</td><td></td><td></td><td></td><td></td><td>✔</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Schema mismatch errors</summary><div><div class="collapsibleContent_i85q"><p><strong>Problem</strong>: Incoming and existing schemas don&#x27;t align.</p><p><strong>Solution</strong>: Use the &quot;On Schema Change&quot; setting to set behavior or ensure schema compatibility.</p></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Duplicate data</summary><div><div class="collapsibleContent_i85q"><p><strong>Problem</strong>: Unexpected duplicate records appear in the written table.</p><p><strong>Solution</strong>: Consider using merge modes instead of append.</p></div></div></details></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/analysts/upload-file"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Upload files</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/analysts/table-external-gems"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tables from external systems</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#write-modes" class="table-of-contents__link toc-highlight">Write modes</a><ul><li><a href="#wipe-and-replace-table-default" class="table-of-contents__link toc-highlight">Wipe and Replace Table (default)</a></li><li><a href="#append-row" class="table-of-contents__link toc-highlight">Append Row</a></li><li><a href="#merge---upsert-row" class="table-of-contents__link toc-highlight">Merge - Upsert Row</a></li><li><a href="#merge---wipe-and-replace-partitions" class="table-of-contents__link toc-highlight">Merge - Wipe and Replace Partitions</a></li><li><a href="#merge---scd2" class="table-of-contents__link toc-highlight">Merge - SCD2</a></li><li><a href="#merge---update-row" class="table-of-contents__link toc-highlight">Merge - Update Row</a></li><li><a href="#merge---delete-and-insert" class="table-of-contents__link toc-highlight">Merge - Delete and Insert</a></li></ul></li><li><a href="#how-write-modes-work" class="table-of-contents__link toc-highlight">How write modes work</a></li><li><a href="#partitioning" class="table-of-contents__link toc-highlight">Partitioning</a></li><li><a href="#write-modes-matrix" class="table-of-contents__link toc-highlight">Write modes matrix</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Prophecy</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.prophecy.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Home<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.prophecy.io/blogs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/prophecy-io-support/shared_invite/zt-1dwuvkakg-JcavnQuoukyZ3q5jkSkKCg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto:docs@prophecy.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Documentation feedback<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://app.prophecy.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Login<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 Prophecy Inc All Rights Reserved <a href="https://legal.prophecy.io/privacy" target="_blank">Privacy Policy</a></div></div></div></footer></div>
</body>
</html>