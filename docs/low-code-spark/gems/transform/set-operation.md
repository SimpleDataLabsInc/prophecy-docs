---
sidebar_position: 8
title: Set Operation
---

Allows you to perform addition or subtraction of rows from dataframes with identical schemas and different data.

[//]: # '<img src="data:image/png;base64,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" width="40" height="40" />'

### Parameters

| Parameter      | Description                                                                                                                                                                                                                                                                                                                                                                                       | Required |
| :------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :------- |
| Dataframe 1    | First input dataframe                                                                                                                                                                                                                                                                                                                                                                             | True     |
| Dataframe 2    | Second input dataframe                                                                                                                                                                                                                                                                                                                                                                            | True     |
| Dataframe N    | Nth input dataframe                                                                                                                                                                                                                                                                                                                                                                               | False    |
| Operation type | Operation to perform<br/>- `Union`: Returns a dataset containing rows in any one of the input Datasets, while preserving duplicates.<br/>- `Intersect All`: Returns a dataset containing rows in all of the input Datasets, while preserving duplicates. <br/>- `Except All`: Returns a dataset containing rows in the first Dataset, but not in the other datasets, while preserving duplicates. | True     |

:::info
To add more input dataframes, simply click `+` icon on the left sidebar
![Set Operation - Add input dataframe](./img/set_add_inputs.png)
:::

### Examples

---

#### Operation Type - `Union`

![Example usage of Set Operation - Union](./img/set_eg_1.png)

````mdx-code-block
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>

<TabItem value="py" label="Python">

```py
def union(spark: SparkSession, in0: DataFrame, in1: DataFrame, ) -> DataFrame:
    return in0.unionAll(in1)
```

</TabItem>
<TabItem value="scala" label="Scala">

```scala
object union {
  def apply(spark: SparkSession, in0: DataFrame, in1: DataFrame): DataFrame =
    in0.unionAll(in1)
}
```

</TabItem>
</Tabs>

````

---

#### Operation Type - `Intersect All`

![Example usage of Set Operation - Intersect All](./img/set_eg_2.png)

````mdx-code-block


<Tabs>

<TabItem value="py" label="Python">

```py
def intersectAll(spark: SparkSession, in0: DataFrame, in1: DataFrame, ) -> DataFrame:
    return in0.intersectAll(in1)
```

</TabItem>
<TabItem value="scala" label="Scala">

```scala
object intersectAll {
  def apply(spark: SparkSession, in0: DataFrame, in1: DataFrame): DataFrame =
    in0.intersectAll(in1)
}
```

</TabItem>
</Tabs>

````

---

#### Operation Type - `Except All`

![Example usage of Set Operation - Except All](./img/set_eg_3.png)

````mdx-code-block


<Tabs>

<TabItem value="py" label="Python">

```py
def exceptAll(spark: SparkSession, in0: DataFrame, in1: DataFrame, ) -> DataFrame:
    return in0.exceptAll(in1)
```

</TabItem>
<TabItem value="scala" label="Scala">

```scala
object exceptAll {
  def apply(spark: SparkSession, in0: DataFrame, in1: DataFrame): DataFrame =
    in0.exceptAll(in1)
}
```

</TabItem>
</Tabs>

````
