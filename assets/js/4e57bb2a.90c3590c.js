"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[2761],{3905:function(e,t,a){a.d(t,{Zo:function(){return l},kt:function(){return m}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=n.createContext({}),p=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},l=function(e){var t=p(e.components);return n.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=p(a),m=r,h=d["".concat(c,".").concat(m)]||d[m]||u[m]||i;return a?n.createElement(h,o(o({ref:t},l),{},{components:a})):n.createElement(h,o({ref:t},l))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},6198:function(e,t,a){a.r(t),a.d(t,{assets:function(){return l},contentTitle:function(){return c},default:function(){return m},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return u}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),o=["components"],s={title:"Deployment",date:new Date("2022-03-21T21:45:41.000Z"),sidebar_position:1,id:"deployment",description:"Prophecy deployment is flexible and supports multiple mechanisms",tags:["deployment","jobs","databricks"]},c=void 0,p={unversionedId:"architecture/deployment",id:"architecture/deployment",title:"Deployment",description:"Prophecy deployment is flexible and supports multiple mechanisms",source:"@site/docs/architecture/deployment.md",sourceDirName:"architecture",slug:"/architecture/deployment",permalink:"/architecture/deployment",draft:!1,tags:[{label:"deployment",permalink:"/tags/deployment"},{label:"jobs",permalink:"/tags/jobs"},{label:"databricks",permalink:"/tags/databricks"}],version:"current",sidebarPosition:1,frontMatter:{title:"Deployment",date:"2022-03-21T21:45:41.000Z",sidebar_position:1,id:"deployment",description:"Prophecy deployment is flexible and supports multiple mechanisms",tags:["deployment","jobs","databricks"]},sidebar:"defaultSidebar",previous:{title:"Architecture",permalink:"/architecture/"},next:{title:"Authentication",permalink:"/architecture/authentication"}},l={},u=[{value:"Cloud Deployment",id:"cloud-deployment",level:2},{value:"Public SaaS",id:"public-saas",level:3},{value:"Private SaaS (Customer VPC)",id:"private-saas-customer-vpc",level:3},{value:"On-Premise Deployment",id:"on-premise-deployment",level:3},{value:"Connectivity",id:"connectivity",level:2},{value:"Spark",id:"spark",level:3},{value:"Databricks",id:"databricks",level:4},{value:"Git",id:"git",level:3}],d={toc:u};function m(e){var t=e.components,s=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Prophecy deployment is simple and flexible. Prophecy is written as a set of microservices that run on Kubernetes and is\nbuilt to be multi-tenant. There are three primary options"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/architecture/deployment#public-saas"},"Public SaaS")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/architecture/deployment#private-saas-customer-vpc"},"Private SaaS")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/architecture/deployment#on-premise-deployment"},"On-premise"))),(0,i.kt)("h2",{id:"cloud-deployment"},"Cloud Deployment"),(0,i.kt)("p",null,"Prophecy in the cloud connects to your existing Spark and Scheduler/Orchestrator. Prophecy does not store any data, however, it does store metadata about your pipelines, datasets and schedules."),(0,i.kt)("img",{src:a(2590).Z,alt:"Example banner",width:"75%"}),(0,i.kt)("h3",{id:"public-saas"},"Public SaaS"),(0,i.kt)("p",null,"Public SaaS (Prophecy managed SaaS) is the default option when you connect from ",(0,i.kt)("strong",{parentName:"p"},"Databricks Partner Connect")," and is\nfree for one user.\nThis option is heavily used by customers to try Prophecy. Our startup and midsize customers who like the convenience of\na managed service prefer this option. You can also use this by directly going to\nthe ",(0,i.kt)("a",{parentName:"p",href:"https://app.prophecy.io/"},"Prophecy Application")),(0,i.kt)("img",{src:a(9671).Z,alt:"Example banner",width:"75%"}),(0,i.kt)("h3",{id:"private-saas-customer-vpc"},"Private SaaS (Customer VPC)"),(0,i.kt)("p",null,"Our Enterprise customers and midsize/startup customers in segments which deal with very sensitive data primarily use\nthis\noption. Here, Prophecy runs within the ",(0,i.kt)("strong",{parentName:"p"},"Customer VPC")," and connects to the identity, spark clusters and the scheduler\nwithin the VPC"),(0,i.kt)("img",{src:a(7558).Z,alt:"Example banner",width:"75%"}),(0,i.kt)("p",null,"This is the default option when you go through the cloud marketplaces. You can install the software from the ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("a",{parentName:"em",href:"https://azuremarketplace.microsoft.com/en-us/marketplace/apps/simpledatalabsinc1635791235920.prophecy-data-engineering"},"Azure\nMarketplace")),"\n.\nThe install is very simple, takes about 20 minutes, and billing starts after 30 days (and a confirmation popup)"),(0,i.kt)("img",{src:a(1112).Z,alt:"Example banner",width:"75%"}),(0,i.kt)("h3",{id:"on-premise-deployment"},"On-Premise Deployment"),(0,i.kt)("p",null,"On rare occasions Prophecy will deploy on-premise for the large customers who are moving to the cloud. Often the order\nis that the organizations will move pipelines from on-premise legacy ETL tools to Spark, then move it to Spark on the\ncloud. For more information on this reach out to our team by\nusing ",(0,i.kt)("a",{parentName:"p",href:"https://www.prophecy.io/request-a-demo"},"request a demo"),"."),(0,i.kt)("h2",{id:"connectivity"},"Connectivity"),(0,i.kt)("p",null,"Prophecy connects to the following external services:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/architecture/deployment#spark"},"Spark")," - for interactive code execution"),(0,i.kt)("li",{parentName:"ul"},"Schedulers - for code orchestration"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"http://localhost:3000/architecture/deployment#git"},"Git")," - for code storage"),(0,i.kt)("li",{parentName:"ul"},"Identity Providers - for easier user authentication and authorization")),(0,i.kt)("h3",{id:"spark"},"Spark"),(0,i.kt)("p",null,"To allow for interactive code execution Prophecy can connect to either ",(0,i.kt)("a",{parentName:"p",href:"/architecture/deployment#databricks"},"Databricks"),"\nor any other Spark through ",(0,i.kt)("a",{parentName:"p",href:"https://livy.apache.org/"},"Apache Livy")," (e.g. MapR, CDP, HDP, Spark on Kubernetes)."),(0,i.kt)("h4",{id:"databricks"},"Databricks"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Prophecy &lt;&gt; Databricks Connectivity",src:a(2365).Z,width:"3314",height:"1580"})),(0,i.kt)("p",null,"Prophecy connects to Databricks using ",(0,i.kt)("a",{parentName:"p",href:"https://docs.databricks.com/dev-tools/api/latest/index.html"},"Rest API"),". Each\n",(0,i.kt)("a",{parentName:"p",href:"/core-concepts/fabric"},"fabric")," defined in Prophecy refers to a\nsingle ",(0,i.kt)("a",{parentName:"p",href:"https://docs.databricks.com/workspace/index.html"},"Databricks workspace")," and each user is required to\nprovide a ",(0,i.kt)("a",{parentName:"p",href:"https://docs.databricks.com/dev-tools/api/latest/authentication.html"},"personal access token")," to authenticate\nto it."),(0,i.kt)("p",null,"Security-conscious enterprises that use Databricks with limited network access have\nto additionally ",(0,i.kt)("a",{parentName:"p",href:"https://docs.databricks.com/security/network/ip-access-list.html#add-an-ip-access-list"},"whitelist"),"\nthe ",(0,i.kt)("strong",{parentName:"p"},"Prophecy Data Plane IP address")," (",(0,i.kt)("inlineCode",{parentName:"p"},"3.133.35.237"),")."),(0,i.kt)("p",null,"Primarily, Prophecy uses Databricks, for the following functionalities:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Interactive Execution")," - Prophecy allows its users to spin up new clusters or connect to existing clusters.\nWhen a\ncluster connection exists, Prophecy allows the user to run their code in the interactive mode. Interactive code\nqueries are sent to Databricks using\nthe ",(0,i.kt)("a",{parentName:"li",href:"https://docs.databricks.com/dev-tools/api/1.2/index.html"},"Databricks Command API 1.2"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Scheduling")," - Prophecy allows the user to build and orchestrate Databricks Jobs. This works through\nthe ",(0,i.kt)("a",{parentName:"li",href:"https://docs.databricks.com/dev-tools/api/latest/jobs.html"},"Databricks Jobs API 2.1"),".")),(0,i.kt)("p",null,"By default, Prophecy does not store any data samples when executing code using Databricks. Data samples can be\noptionally stored for observability purposes (execution metrics)."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"When using ",(0,i.kt)("strong",{parentName:"p"},"Active Directory"),", Prophecy takes care of auto-generation and refreshing of the Databricks personal access\ntokens. Read more about it ",(0,i.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/databricks/dev-tools/api/latest/aad/"},"here"),"."))),(0,i.kt)("h3",{id:"git"},"Git"),(0,i.kt)("p",null,"Supported Git providers:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Prophecy Managed")," - Prophecy automatically setups the connectivity between itself and the repositories. Prophecy\nManaged is based on open-source ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/go-gitea/gitea"},"GitTea"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"GitHub")," (including GitHub Enterprise) - authenticates using per-user personal access\ntokens. ",(0,i.kt)("a",{parentName:"li",href:"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token"},"How to generate PAT?")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Bitbucket")," (including Bitbucket self-hosted) - authenticates using per-user personal access\ntokens. ",(0,i.kt)("a",{parentName:"li",href:"https://confluence.atlassian.com/bitbucketserver072/personal-access-tokens-1005335924.html"},"How to generate PAT?")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"GitLab")," (including GitLab self-hosted) - authenticates using per-user personal access\ntokens. ",(0,i.kt)("a",{parentName:"li",href:"https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html"},"How to generate PAT?")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Azure DevOps")," - authenticates using per-user personal access\ntokens. ",(0,i.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?view=azure-devops&tabs=Windows"},"How to generate PAT?"))),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Coming Soon")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The users are going to be able to connect to common Git providers, by leveraging their respective OAuth functionalities.\nE.g. ",(0,i.kt)("a",{parentName:"p",href:"https://docs.github.com/en/developers/apps/building-oauth-apps/authorizing-oauth-apps"},"GitHub OAuth")," or Azure AD."))))}m.isMDXComponent=!0},7558:function(e,t,a){t.Z=a.p+"assets/images/arch_customervpc-9606898420e67c54bfda2880228e6f3a.png"},2590:function(e,t,a){t.Z=a.p+"assets/images/arch_general-32c8841bc2ae1f4053f6662018a756d9.png"},9671:function(e,t,a){t.Z=a.p+"assets/images/arch_separate_vpc-0fd8afc057178ba04bf50999084516ea.png"},1112:function(e,t,a){t.Z=a.p+"assets/images/prophecy_azure-1b6d764b1d555da3ca7b2d02604b3e75.png"},2365:function(e,t,a){t.Z=a.p+"assets/images/connectivity-databricks-dcca423712f2d3c9a433990c98bdd0b2.png"}}]);