"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[51827],{28453:(e,i,t)=>{t.d(i,{R:()=>s,x:()=>c});var a=t(96540);const r={},n=a.createContext(r);function s(e){const i=a.useContext(n);return a.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(n.Provider,{value:i},e.children)}},69132:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"administration/fabrics/Spark-fabrics/databricks/databricks","title":"Databricks","description":"Configuring Databricks Fabric","source":"@site/docs/administration/fabrics/Spark-fabrics/databricks/databricks.md","sourceDirName":"administration/fabrics/Spark-fabrics/databricks","slug":"/administration/fabrics/Spark-fabrics/databricks/","permalink":"/administration/fabrics/Spark-fabrics/databricks/","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"concepts","permalink":"/tags/concepts"},{"inline":true,"label":"fabric","permalink":"/tags/fabric"},{"inline":true,"label":"databricks","permalink":"/tags/databricks"},{"inline":true,"label":"livy","permalink":"/tags/livy"},{"inline":true,"label":"prophecyManaged","permalink":"/tags/prophecy-managed"}],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Databricks","id":"databricks","description":"Configuring Databricks Fabric","sidebar_position":2,"tags":["concepts","fabric","databricks","livy","prophecyManaged"]},"sidebar":"adminSidebar","previous":{"title":"Spark fabrics","permalink":"/administration/fabrics/Spark-fabrics/Fabrics"},"next":{"title":"UC cluster compatibility","permalink":"/administration/fabrics/Spark-fabrics/databricks/ucshared"}}');var r=t(74848),n=t(28453);const s={title:"Databricks",id:"databricks",description:"Configuring Databricks Fabric",sidebar_position:2,tags:["concepts","fabric","databricks","livy","prophecyManaged"]},c=void 0,o={},l=[{value:"Fields",id:"fields",level:2},{value:"Team",id:"team",level:3},{value:"Credentials",id:"credentials",level:3},{value:"Databricks Workspace URL",id:"databricks-workspace-url",level:4},{value:"Authentication Method",id:"authentication-method",level:4},{value:"Service Principal Configuration",id:"service-principal-configuration",level:4},{value:"Job Sizes",id:"job-sizes",level:3},{value:"Prophecy Library",id:"prophecy-library",level:3},{value:"Public Central (Default)",id:"public-central-default",level:4},{value:"Custom Artifactory",id:"custom-artifactory",level:4},{value:"File System",id:"file-system",level:4},{value:"Artifacts",id:"artifacts",level:3},{value:"Databricks execution",id:"databricks-execution",level:2}];function d(e){const i={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.p,{children:"Create a Databricks fabric to connect Prophecy to your existing Databricks workspace. With a Databricks fabric, you can connect to existing Spark clusters or create new ones, run Spark pipelines, and read or write data, depending on your Databricks permissions."}),"\n",(0,r.jsx)(i.h2,{id:"fields",children:"Fields"}),"\n",(0,r.jsx)(i.p,{children:"Learn about different fields to configure your Databricks Spark fabric."}),"\n",(0,r.jsx)(i.h3,{id:"team",children:"Team"}),"\n",(0,r.jsx)(i.p,{children:"Each fabric is associated with one team. All team members will be able to access the fabric in their projects."}),"\n",(0,r.jsx)(i.h3,{id:"credentials",children:"Credentials"}),"\n",(0,r.jsx)(i.p,{children:"Provide the following information to verify your Databricks credentials."}),"\n",(0,r.jsx)(i.h4,{id:"databricks-workspace-url",children:"Databricks Workspace URL"}),"\n",(0,r.jsx)(i.p,{children:"The URL that points to the workspace that the fabric will use as the execution environment."}),"\n",(0,r.jsx)(i.h4,{id:"authentication-method",children:"Authentication Method"}),"\n",(0,r.jsxs)(i.p,{children:["Prophecy supports authentication via ",(0,r.jsx)(i.a,{href:"https://docs.databricks.com/dev-tools/api/latest/authentication.html#generate-a-personal-access-token",children:"Personal Access Token"})," (PAT) and ",(0,r.jsx)(i.a,{href:"/databricks-oauth-authentication",children:"OAuth"}),"."]}),"\n",(0,r.jsx)(i.admonition,{type:"caution",children:(0,r.jsx)(i.p,{children:"Each user in the team will have to authenticate individually using the method you select. An individual user's credentials will determine the level of access they have to Databricks from Prophecy. At minimum, you must have permission to attach clusters in Databricks to use the fabric."})}),"\n",(0,r.jsx)(i.admonition,{type:"note",children:(0,r.jsxs)(i.p,{children:["When using ",(0,r.jsx)(i.strong,{children:"Active Directory"}),", Prophecy takes care of the auto-generation and refreshing of the Databricks personal access tokens. Read more about it ",(0,r.jsx)(i.a,{href:"https://docs.microsoft.com/en-us/azure/databricks/dev-tools/api/latest/aad/",children:"here"}),"."]})}),"\n",(0,r.jsx)(i.h4,{id:"service-principal-configuration",children:"Service Principal Configuration"}),"\n",(0,r.jsxs)(i.p,{children:["You must provide the Service Principal Client Secret and Service Principal Client ID when you use ",(0,r.jsx)(i.a,{href:"/databricks-oauth-authentication/#machine-to-machine-m2m",children:"OAuth for project deployment"}),"."]}),"\n",(0,r.jsx)(i.h3,{id:"job-sizes",children:"Job Sizes"}),"\n",(0,r.jsx)(i.p,{children:"Job sizes define the cluster configurations that Prophecy can spawn to run pipelines. We recommend choosing the smallest machine types and the fewest nodes necessary for your use case to optimize cost and performance."}),"\n",(0,r.jsxs)(i.p,{children:["By default, Prophecy includes a single job size that uses ",(0,r.jsx)(i.a,{href:"https://docs.databricks.com/aws/en/compute#databricks-runtime",children:"Databricks Runtime 14.3"}),". You can modify this default configuration or define additional job sizes using the Prophecy UI."]}),"\n",(0,r.jsx)(i.p,{children:"To create or update a job size, use the form view or switch to the JSON editor to paste your existing compute configuration from Databricks."}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.img,{alt:"Job Size configuration",src:t(90041).A+"",width:"2870",height:"1610"})}),"\n",(0,r.jsx)(i.admonition,{type:"note",children:(0,r.jsxs)(i.p,{children:["The job size configuration mirrors the compute configuration in Databricks. To learn more about compute configuration in Databricks, visit their ",(0,r.jsx)(i.a,{href:"https://docs.databricks.com/aws/en/compute/configure",children:"reference"})," guide."]})}),"\n",(0,r.jsx)(i.admonition,{type:"caution",children:(0,r.jsxs)(i.p,{children:["When using Unity Catalog clusters with standard (formerly shared) access mode, note their ",(0,r.jsx)(i.a,{href:"https://docs.databricks.com/en/compute/access-mode-limitations.html#shared-access-mode-limitations-on-unity-catalog",children:"particular limitations"}),". You can see all supported Prophecy features in our ",(0,r.jsx)(i.a,{href:"./ucshared",children:"UC standard cluster support"})," documentation."]})}),"\n",(0,r.jsx)(i.h3,{id:"prophecy-library",children:"Prophecy Library"}),"\n",(0,r.jsx)(i.p,{children:"Prophecy libraries are Scala and Python libraries that extend the functionality of Apache Spark. These libraries are automatically installed in your Spark execution environment when you attach to a cluster or create a new one."}),"\n",(0,r.jsx)(i.admonition,{title:"Whitelist Prophecy libraries",type:"info",children:(0,r.jsxs)(i.p,{children:["To use Prophecy libraries in Databricks environments that have enabled Unity Catalog, you must whitelist the required Maven coordinates or JAR paths. Find instructions ",(0,r.jsx)(i.a,{href:"/admin/dbx-whitelist-plibs",children:"here"}),"."]})}),"\n",(0,r.jsx)(i.h4,{id:"public-central-default",children:"Public Central (Default)"}),"\n",(0,r.jsxs)(i.p,{children:["Retrieve Prophecy libraries from the public artifact repository. Use ",(0,r.jsx)(i.a,{href:"https://mvnrepository.com/artifact/io.prophecy/prophecy-libs",children:"Maven"})," for Scala projects and ",(0,r.jsx)(i.a,{href:"https://pypi.org/project/prophecy-libs/",children:"PyPI"})," for Python projects."]}),"\n",(0,r.jsx)(i.h4,{id:"custom-artifactory",children:"Custom Artifactory"}),"\n",(0,r.jsx)(i.p,{children:"Retrieve Prophecy libraries from an Artifactory URL."}),"\n",(0,r.jsx)(i.h4,{id:"file-system",children:"File System"}),"\n",(0,r.jsx)(i.p,{children:"Retrieve Prophecy libraries from a file system."}),"\n",(0,r.jsxs)(i.p,{children:["For example, you can add the public S3 bucket path: ",(0,r.jsx)(i.code,{children:"s3://prophecy-public-bucket/prophecy-libs/"})]}),"\n",(0,r.jsx)(i.admonition,{type:"note",children:(0,r.jsxs)(i.p,{children:["A full list of public paths can be found in the documentation on ",(0,r.jsx)(i.a,{href:"/engineers/prophecy-libraries#download-prophecy-libraries",children:"Prophecy libraries"}),". You also can set up ",(0,r.jsx)(i.a,{href:"/admin/dbx-volumes-plibs",children:"Prophecy libraries in your Databricks volumes"}),"."]})}),"\n",(0,r.jsx)(i.h3,{id:"artifacts",children:"Artifacts"}),"\n",(0,r.jsx)(i.p,{children:"Prophecy supports Databricks volumes. When you run a Python or Scala pipeline via a job, you must bundle them as whl/jar artifacts. These artifacts must then be made accessible to the Databricks job in order to use them as a library installed on the cluster. You can designate a path to a volume for uploading the whl/jar files under Artifacts."}),"\n",(0,r.jsx)(i.h2,{id:"databricks-execution",children:"Databricks execution"}),"\n",(0,r.jsx)(i.p,{children:"To learn about Databricks execution, visit:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/engineers/execution",children:"Interactive Execution"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/engineers/execution-metrics",children:"Execution Metrics"})}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,n.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},90041:(e,i,t)=>{t.d(i,{A:()=>a});const a=t.p+"assets/images/dbx-job-size-a150c981e85785c5088e93ef4dc3a84e.png"}}]);