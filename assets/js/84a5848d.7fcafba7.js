"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[7512],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>k});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function u(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),i=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=i(e.components);return r.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,c=u(e,["components","mdxType","originalType","parentName"]),p=i(a),m=n,k=p["".concat(s,".").concat(m)]||p[m]||d[m]||o;return a?r.createElement(k,l(l({ref:t},c),{},{components:a})):r.createElement(k,l({ref:t},c))}));function k(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,l=new Array(o);l[0]=m;var u={};for(var s in t)hasOwnProperty.call(t,s)&&(u[s]=t[s]);u.originalType=e,u[p]="string"==typeof e?e:n,l[1]=u;for(var i=2;i<o;i++)l[i]=a[i];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},85162:(e,t,a)=>{a.d(t,{Z:()=>l});var r=a(67294),n=a(86010);const o={tabItem:"tabItem_Ymn6"};function l(e){let{children:t,hidden:a,className:l}=e;return r.createElement("div",{role:"tabpanel",className:(0,n.Z)(o.tabItem,l),hidden:a},t)}},74866:(e,t,a)=>{a.d(t,{Z:()=>N});var r=a(87462),n=a(67294),o=a(86010),l=a(12466),u=a(16550),s=a(91980),i=a(67392),c=a(50012);function p(e){return function(e){return n.Children.map(e,(e=>{if((0,n.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:a,attributes:r,default:n}}=e;return{value:t,label:a,attributes:r,default:n}}))}function d(e){const{values:t,children:a}=e;return(0,n.useMemo)((()=>{const e=t??p(a);return function(e){const t=(0,i.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function m(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function k(e){let{queryString:t=!1,groupId:a}=e;const r=(0,u.k6)(),o=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,s._X)(o),(0,n.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(r.location.search);t.set(o,e),r.replace({...r.location,search:t.toString()})}),[o,r])]}function b(e){const{defaultValue:t,queryString:a=!1,groupId:r}=e,o=d(e),[l,u]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=a.find((e=>e.default))??a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:o}))),[s,i]=k({queryString:a,groupId:r}),[p,b]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,o]=(0,c.Nk)(a);return[r,(0,n.useCallback)((e=>{a&&o.set(e)}),[a,o])]}({groupId:r}),g=(()=>{const e=s??p;return m({value:e,tabValues:o})?e:null})();(0,n.useLayoutEffect)((()=>{g&&u(g)}),[g]);return{selectedValue:l,selectValue:(0,n.useCallback)((e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);u(e),i(e),b(e)}),[i,b,o]),tabValues:o}}var g=a(72389);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function y(e){let{className:t,block:a,selectedValue:u,selectValue:s,tabValues:i}=e;const c=[],{blockElementScrollPositionUntilNextRender:p}=(0,l.o5)(),d=e=>{const t=e.currentTarget,a=c.indexOf(t),r=i[a].value;r!==u&&(p(t),s(r))},m=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const a=c.indexOf(e.currentTarget)+1;t=c[a]??c[0];break}case"ArrowLeft":{const a=c.indexOf(e.currentTarget)-1;t=c[a]??c[c.length-1];break}}t?.focus()};return n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":a},t)},i.map((e=>{let{value:t,label:a,attributes:l}=e;return n.createElement("li",(0,r.Z)({role:"tab",tabIndex:u===t?0:-1,"aria-selected":u===t,key:t,ref:e=>c.push(e),onKeyDown:m,onClick:d},l,{className:(0,o.Z)("tabs__item",f.tabItem,l?.className,{"tabs__item--active":u===t})}),a??t)})))}function h(e){let{lazy:t,children:a,selectedValue:r}=e;if(a=Array.isArray(a)?a:[a],t){const e=a.find((e=>e.props.value===r));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return n.createElement("div",{className:"margin-top--md"},a.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==r}))))}function v(e){const t=b(e);return n.createElement("div",{className:(0,o.Z)("tabs-container",f.tabList)},n.createElement(y,(0,r.Z)({},e,t)),n.createElement(h,(0,r.Z)({},e,t)))}function N(e){const t=(0,g.Z)();return n.createElement(v,(0,r.Z)({key:String(t)},e))}},96823:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>k,frontMatter:()=>u,metadata:()=>i,toc:()=>p});var r=a(87462),n=(a(67294),a(3905)),o=a(74866),l=a(85162);const u={title:"Lookup",id:"lookup",description:"Lookup",sidebar_position:4,tags:["gems","lookup"]},s=void 0,i={unversionedId:"low-code-spark/gems/source-target/lookup",id:"low-code-spark/gems/source-target/lookup",title:"Lookup",description:"Lookup",source:"@site/docs/low-code-spark/gems/source-target/lookup.md",sourceDirName:"low-code-spark/gems/source-target",slug:"/low-code-spark/gems/source-target/lookup",permalink:"/low-code-spark/gems/source-target/lookup",draft:!1,tags:[{label:"gems",permalink:"/tags/gems"},{label:"lookup",permalink:"/tags/lookup"}],version:"current",sidebarPosition:4,frontMatter:{title:"Lookup",id:"lookup",description:"Lookup",sidebar_position:4,tags:["gems","lookup"]},sidebar:"defaultSidebar",previous:{title:"Delta Table",permalink:"/low-code-spark/gems/source-target/catalog-table/delta"},next:{title:"Transform",permalink:"/low-code-spark/gems/transform/"}},c={},p=[{value:"Using Lookups",id:"using-lookups",level:2},{value:"Column-based lookups",id:"column-based-lookups",level:3},{value:"Literal lookups",id:"literal-lookups",level:3}],d={toc:p},m="wrapper";function k(e){let{components:t,...u}=e;return(0,n.kt)(m,(0,r.Z)({},d,u,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Lookups are a special kind of Gem that allow you to mark a particular DataFrame as a ",(0,n.kt)("em",{parentName:"p"},"Broadcast")," DataFrame. Spark will ensure that this data is available on every computation node so that these lookups can be done without shuffling data. This is useful for looking up values in tables, hence the name."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Lookup Gem",src:a(87182).Z,width:"230",height:"207"})),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Lookup UI",src:a(63117).Z,width:"1283",height:"770"})),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"center"}),(0,n.kt)("th",{parentName:"tr",align:null},"Name"),(0,n.kt)("th",{parentName:"tr",align:null},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"center"},"1"),(0,n.kt)("td",{parentName:"tr",align:null},"Key Columns"),(0,n.kt)("td",{parentName:"tr",align:null},"Specify one or more columns to use as the lookup key in the source DataFrame")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"center"},"2"),(0,n.kt)("td",{parentName:"tr",align:null},"Value Columns"),(0,n.kt)("td",{parentName:"tr",align:null},"Pick which columns can be referenced wherever this Lookup is used")))),(0,n.kt)("h2",{id:"using-lookups"},"Using Lookups"),(0,n.kt)("p",null,"Lookups can be used wherever any other Expression can be used, but usage depends on your Expression language of choice. Lookup references follow a certain pattern:"),(0,n.kt)(o.Z,{mdxType:"Tabs"},(0,n.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-py"},'lookup("<LOOKUP NAME>", <KEY COLUMN>).getField(<VALUE COLUMN>)\n'))),(0,n.kt)(l.Z,{value:"scala",label:"Scala",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-scala"},'lookup("<LOOKUP NAME>", <KEY COLUMN>).getField(<VALUE COLUMN>)\n'))),(0,n.kt)(l.Z,{value:"sql",label:"SQL",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"<LOOKUP NAME>(<KEY COLUMN>)['<VALUE COLUMN>']\n")))),(0,n.kt)("h3",{id:"column-based-lookups"},"Column-based lookups"),(0,n.kt)("p",null,"So, based on our above ",(0,n.kt)("inlineCode",{parentName:"p"},"MyLookup")," example we'd use:"),(0,n.kt)(o.Z,{mdxType:"Tabs"},(0,n.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-py"},'lookup("MyLookup", col("customer_id")).getField("order_category")\n'))),(0,n.kt)(l.Z,{value:"scala",label:"Scala",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-scala"},'lookup("MyLookup", col("customer_id")).getField("order_category")\n'))),(0,n.kt)(l.Z,{value:"sql",label:"SQL",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"MyLookup(customer_id)['order_category']\n")))),(0,n.kt)("p",null,"For example, let's look at a ",(0,n.kt)("a",{parentName:"p",href:"/low-code-spark/gems/transform/reformat"},"Reformat")," component:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Reformat example",src:a(81872).Z,width:"1260",height:"182"})),(0,n.kt)("p",null,"Here we have a column named ",(0,n.kt)("inlineCode",{parentName:"p"},"category")," that is set to the value of ",(0,n.kt)("inlineCode",{parentName:"p"},"MyLookup(customer_id)['order_category']")," in SQL Expression mode. Whatever the value of ",(0,n.kt)("inlineCode",{parentName:"p"},"order_category")," is for the key found in the ",(0,n.kt)("inlineCode",{parentName:"p"},"c_id")," column (compared to the source ",(0,n.kt)("inlineCode",{parentName:"p"},"customer_id")," key column) will be used for the new column."),(0,n.kt)("h3",{id:"literal-lookups"},"Literal lookups"),(0,n.kt)("p",null,"Since any column reference can be used in Lookup expressions, you can use Lookups with static keys:"),(0,n.kt)(o.Z,{mdxType:"Tabs"},(0,n.kt)(l.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-py"},'lookup("MyLookup", lit("0000")).getField("order_category")\n'))),(0,n.kt)(l.Z,{value:"scala",label:"Scala",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-scala"},'lookup("MyLookup", lit("0000")).getField("order_category")\n'))),(0,n.kt)(l.Z,{value:"sql",label:"SQL",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"MyLookup('0000')['order_category']\n")))),(0,n.kt)("p",null,"In this case, the expression evaluates to the value of ",(0,n.kt)("inlineCode",{parentName:"p"},"order_category")," where ",(0,n.kt)("inlineCode",{parentName:"p"},"customer_id")," is ",(0,n.kt)("inlineCode",{parentName:"p"},"0000"),". This can be useful in situations when you want to have a table of predefined keys and their values available in Expressions."))}k.isMDXComponent=!0},87182:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/lookup-adb6f51a0f1bfd87b22ed4328e57a140.png"},63117:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/lookup_ui-dee0b6773250bea2c99b94dbeda25a86.png"},81872:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/lookup_use-606f0c4b09ceef3346b9f8e946c5cccb.png"}}]);