"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[60032],{390:(e,t,l)=>{l.d(t,{A:()=>s});const s=l.p+"assets/images/deduplicate_row_to_keep-d77d5f3a3d4592a545e78c80f5da1c7a.png"},28453:(e,t,l)=>{l.d(t,{R:()=>d,x:()=>r});var s=l(96540);const i={},n=s.createContext(i);function d(e){const t=s.useContext(n);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(n.Provider,{value:t},e.children)}},34859:(e,t,l)=>{l.r(t),l.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>o,frontMatter:()=>d,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"SQL/gems/transform/deduplicate","title":"Deduplicate","description":"Remove rows with duplicate values of specified columns","source":"@site/docs/SQL/gems/transform/deduplicate.md","sourceDirName":"SQL/gems/transform","slug":"/SQL/gems/transform/deduplicate","permalink":"/SQL/gems/transform/deduplicate","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"gems","permalink":"/tags/gems"},{"inline":true,"label":"dedupe","permalink":"/tags/dedupe"},{"inline":true,"label":"distinct","permalink":"/tags/distinct"},{"inline":true,"label":"unique","permalink":"/tags/unique"}],"version":"current","frontMatter":{"title":"Deduplicate","id":"deduplicate","description":"Remove rows with duplicate values of specified columns","tags":["gems","dedupe","distinct","unique"]},"sidebar":"mySidebar","previous":{"title":"Aggregate","permalink":"/SQL/gems/transform/sql-aggregate"},"next":{"title":"Filter","permalink":"/SQL/gems/transform/filter"}}');var i=l(74848),n=l(28453);const d={title:"Deduplicate",id:"deduplicate",description:"Remove rows with duplicate values of specified columns",tags:["gems","dedupe","distinct","unique"]},r=void 0,c={},h=[{value:"Parameters",id:"parameters",level:2},{value:"Row to keep options",id:"row-to-keep-options",level:2},{value:"Example",id:"example",level:2}];function x(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",hr:"hr",img:"img",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h3",{children:(0,i.jsx)("span",{class:"badge",children:"SQL Gem"})}),"\n",(0,i.jsx)(t.p,{children:"Removes rows with duplicate values of specified columns."}),"\n",(0,i.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Required"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Source"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Input source"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"True"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Row to keep"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["- ",(0,i.jsx)(t.code,{children:"Distinct Rows"}),": Keeps all distinct rows. This is equivalent to performing a ",(0,i.jsx)(t.code,{children:"select distinct"})," operation ",(0,i.jsx)("br",{}),"- ",(0,i.jsx)(t.code,{children:"Unique Only"}),": Keeps rows that don't have duplicates ",(0,i.jsx)("br",{}),"- ",(0,i.jsx)(t.code,{children:"First"}),": Keeps first occurrence of the duplicate row ",(0,i.jsx)("br",{}),"- ",(0,i.jsx)(t.code,{children:"Last"}),": Keeps last occurrence of the duplicate row ",(0,i.jsx)("br",{}),"Default is ",(0,i.jsx)(t.code,{children:"Distinct Rows"})]}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"True"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Deduplicate On Columns"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["Columns to consider while removing duplicate rows (not required for ",(0,i.jsx)(t.code,{children:"Distinct Rows"}),")"]}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"True"})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"row-to-keep-options",children:"Row to keep options"}),"\n",(0,i.jsxs)(t.p,{children:["As mentioned in the previous parameters, there are four ",(0,i.jsx)(t.strong,{children:"Row to keep"})," options that you can use in your deduplicate gem."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Deduplicate row to keep",src:l(390).A+"",width:"2620",height:"1507"})}),"\n",(0,i.jsxs)(t.p,{children:["In the Code view, you can see that the Deduplicate gem contains ",(0,i.jsx)(t.code,{children:"SELECT DISTINCT *"})," when using the ",(0,i.jsx)(t.code,{children:"Distinct Rows"})," option."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Deduplicate code view",src:l(86027).A+"",width:"2620",height:"1539"})}),"\n",(0,i.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,i.jsx)(t.p,{children:"Suppose you're deduplicating the following table."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"First_Name"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Last_Name"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Contact"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"John"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Doe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"phone"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"123-456-7890"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"John"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Doe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"phone"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"123-456-7890"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"John"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Doe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"phone"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"123-456-7890"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Alice"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Johnson"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"phone"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"246-135-0987"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Alice"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Johnson"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"phone"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"246-135-0987"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Alice"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Johnson"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"email"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.a,{href:"mailto:alice@johnson.com",children:"alice@johnson.com"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Alice"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Johnson"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"email"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.a,{href:"mailto:alice@johnson.com",children:"alice@johnson.com"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Bob"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Smith"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"email"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.a,{href:"mailto:bob@smith.com",children:"bob@smith.com"})})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:["For ",(0,i.jsx)(t.code,{children:"Distinct Rows"}),", the interim data will show the following:"]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"First_Name"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Last_Name"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Contact"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"John"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Doe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"phone"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"123-456-7890"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Alice"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Johnson"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"phone"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"246-135-0987"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Alice"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Johnson"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"email"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.a,{href:"mailto:alice@johnson.com",children:"alice@johnson.com"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Bob"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Smith"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"email"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.a,{href:"mailto:bob@smith.com",children:"bob@smith.com"})})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"First"})," and ",(0,i.jsx)(t.code,{children:"Last"})," options work similarly to ",(0,i.jsx)(t.code,{children:"Distinct Rows"}),", but they keep the first and last occurrence of the duplicate rows respectively."]}),"\n",(0,i.jsxs)(t.p,{children:["For ",(0,i.jsx)(t.code,{children:"Unique Only"}),", the interim data will look like the following:"]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"First_Name"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Last_Name"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Contact"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Bob"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Smith"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"email"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.a,{href:"mailto:bob@smith.com",children:"bob@smith.com"})})]})})]}),"\n",(0,i.jsx)(t.p,{children:"You'll be left with only one unique row since the rest were all duplicates."}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsxs)(t.p,{children:["You can add ",(0,i.jsx)(t.code,{children:"First_Name"})," and ",(0,i.jsx)(t.code,{children:"Last_Name"})," to Deduplicate On Columns if you want to further deduplicate the table."]}),"\n",(0,i.jsxs)(t.p,{children:["For ",(0,i.jsx)(t.code,{children:"Distinct Rows"}),", the interim data will show the following:"]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"First_Name"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Last_Name"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"John"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Doe"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Alice"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Johnson"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Bob"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Smith"})]})]})]}),"\n",(0,i.jsxs)(t.admonition,{type:"note",children:[(0,i.jsxs)(t.p,{children:["For ",(0,i.jsx)(t.code,{children:"First"}),", ",(0,i.jsx)(t.code,{children:"Last"}),", and ",(0,i.jsx)(t.code,{children:"Unique Only"}),", the interim data will contain all columns, irrespective of the columns that were added."]}),(0,i.jsxs)(t.p,{children:["For ",(0,i.jsx)(t.code,{children:"First"})," and ",(0,i.jsx)(t.code,{children:"Last"}),", the interim data will look like the following:"]}),(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"First_Name"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Last_Name"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Contact"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"John"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Doe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"phone"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"123-456-7890"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Alice"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Johnson"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"phone"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"246-135-0987"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Alice"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Johnson"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"email"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.a,{href:"mailto:alice@johnson.com",children:"alice@johnson.com"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Bob"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Smith"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"email"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.a,{href:"mailto:bob@smith.com",children:"bob@smith.com"})})]})]})]}),(0,i.jsxs)(t.p,{children:["For ",(0,i.jsx)(t.code,{children:"Unique Only"}),", the interim data will look like the following:"]}),(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"First_Name"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Last_Name"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Contact"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Bob"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Smith"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"email"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.a,{href:"mailto:bob@smith.com",children:"bob@smith.com"})})]})})]})]})]})}function o(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(x,{...e})}):x(e)}},86027:(e,t,l)=>{l.d(t,{A:()=>s});const s=l.p+"assets/images/deduplicate_code_view-0547325e0c346a5613414aeeb7ac6292.png"}}]);