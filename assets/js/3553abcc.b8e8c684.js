"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[52452],{15680:(e,n,t)=>{t.d(n,{xA:()=>u,yg:()=>y});var r=t(96540);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),p=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(t),m=a,y=c["".concat(l,".").concat(m)]||c[m]||d[m]||o;return t?r.createElement(y,i(i({ref:n},u),{},{components:t})):r.createElement(y,i({ref:n},u))}));function y(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[c]="string"==typeof e?e:a,i[1]=s;for(var p=2;p<o;p++)i[p]=t[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},54994:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var r=t(58168),a=(t(96540),t(15680));const o={title:"Self-hosted",id:"self-hosted",description:"Deploy Prophecy in your own VPC",sidebar_class_name:"hidden",tags:["deployment","installation","self-hosted"]},i=void 0,s={unversionedId:"administration/self-hosted/self-hosted",id:"administration/self-hosted/self-hosted",title:"Self-hosted",description:"Deploy Prophecy in your own VPC",source:"@site/docs/administration/self-hosted/self-hosted.md",sourceDirName:"administration/self-hosted",slug:"/administration/self-hosted/",permalink:"/administration/self-hosted/",draft:!1,tags:[{label:"deployment",permalink:"/tags/deployment"},{label:"installation",permalink:"/tags/installation"},{label:"self-hosted",permalink:"/tags/self-hosted"}],version:"current",frontMatter:{title:"Self-hosted",id:"self-hosted",description:"Deploy Prophecy in your own VPC",sidebar_class_name:"hidden",tags:["deployment","installation","self-hosted"]},sidebar:"adminSidebar",previous:{title:"Syncing audit logs from SaaS",permalink:"/administration/saas/audit-logging"},next:{title:"Installation via Helm",permalink:"/administration/self-hosted/installation-helm/"}},l={},p=[{value:"Spark",id:"spark",level:2},{value:"Airflow",id:"airflow",level:2},{value:"Logging / Metrics",id:"logging--metrics",level:2},{value:"Prophecy services",id:"prophecy-services",level:2},{value:"Running Services API",id:"running-services-api",level:3}],u={toc:p},c="wrapper";function d(e){let{components:n,...t}=e;return(0,a.yg)(c,(0,r.A)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.yg)("p",null,"Prophecy is written as a set of microservices that run on a Kubernetes cluster. Our recommended platforms to run Kubernetes are:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Amazon Web Services managed EKS"),(0,a.yg)("li",{parentName:"ul"},"Microsoft Azure managed AKS"),(0,a.yg)("li",{parentName:"ul"},"Google Cloud Platform managed GKE")),(0,a.yg)("p",null,"There are a couple of ways to install a self-hosted Prophecy deployment:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Installation via ",(0,a.yg)("a",{parentName:"li",href:"https://helm.sh/docs/intro/quickstart/"},"Helm")),(0,a.yg)("li",{parentName:"ul"},"Installation via Marketplaces")),(0,a.yg)("p",null,"Once Prophecy is installed, you'll have to manually perform upgrades, backups, restores, etc."),(0,a.yg)("admonition",{type:"info"},(0,a.yg)("p",{parentName:"admonition"},"For personalized help, contact ",(0,a.yg)("a",{parentName:"p",href:"https://prophecy.zendesk.com/"},"support"),". If applicable, send along your ",(0,a.yg)("a",{parentName:"p",href:"/administration/self-hosted/download-logs"},"logs")," to help us troubleshoot.")),(0,a.yg)("h2",{id:"spark"},"Spark"),(0,a.yg)("p",null,"After installation, Prophecy requires the following for interactive development:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Databricks API 1.2")," for Databricks-based Spark deployments, or"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Livy 0.7.x")," for any other Spark deployment support (like CDP, HDP, MapR, Spark on Kubernetes).")),(0,a.yg)("h2",{id:"airflow"},"Airflow"),(0,a.yg)("p",null,"For interactive and jobs deployment to Airflow, Prophecy requires a customer-managed ",(0,a.yg)("strong",{parentName:"p"},"Airflow deployment version 2.x.x")," (latest recommended). ",(0,a.yg)("strong",{parentName:"p"},"Astronomer"),"'s managed Airflow offering is supported."),(0,a.yg)("h2",{id:"logging--metrics"},"Logging / Metrics"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Prophecy comes with a built-in ",(0,a.yg)("strong",{parentName:"li"},"lightweight infrastructure for monitoring")," (based on Loki & Grafana)\nand ",(0,a.yg)("strong",{parentName:"li"},"logging")," (based on Prometheus, Grafana and alert-manager, etc.)."),(0,a.yg)("li",{parentName:"ul"},"You can optionally ",(0,a.yg)("strong",{parentName:"li"},"redirect the logs and metrics")," to your own logging services.")),(0,a.yg)("h2",{id:"prophecy-services"},"Prophecy services"),(0,a.yg)("p",null,"You can use the Running Services API to retrieve the status of your Prophecy services. 200 denotes that the service is running, while 404 denotes that the service is disabled. Any other error code denotes a service failure."),(0,a.yg)("h3",{id:"running-services-api"},"Running Services API"),(0,a.yg)("p",null,"Example:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"curl 'https://<prophecy-env-url>/athena/api/v1/prophecy/status'\n")),(0,a.yg)("details",null,(0,a.yg)("summary",null,"Response:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},'{\n "anyServiceDown": false,\n "data": {\n  "services": [\n   {\n    "isPrimary": true,\n    "name": "App",\n    "statusCode": 200\n   },\n   {\n    "isPrimary": true,\n    "name": "Metadata",\n    "statusCode": 200\n   },\n   {\n    "isPrimary": false,\n    "name": "Pipeline/Jobs Editor",\n    "statusCode": 200\n   },\n   {\n    "isPrimary": false,\n    "name": "Prophecy Managed Git",\n    "statusCode": 200\n   },\n   {\n    "isPrimary": false,\n    "name": "Execution",\n    "statusCode": 200\n   },\n   {\n    "isPrimary": false,\n    "name": "CI / CD",\n    "statusCode": 200\n   },\n   {\n    "isPrimary": false,\n    "name": "Lineage",\n    "statusCode": 200\n   },\n   {\n    "isPrimary": false,\n    "name": "Search",\n    "statusCode": 404\n   },\n   {\n    "isPrimary": false,\n    "name": "Kafka",\n    "statusCode": 404\n   },\n   {\n    "isPrimary": false\n   },\n   {\n    "isPrimary": false,\n    "name": "Transpiler",\n    "statusCode": 404\n   },\n   {\n    "isPrimary": false,\n    "name": "Data Quality",\n    "statusCode": 404\n   },\n   {\n    "isPrimary": false,\n    "name": "Data Copilot",\n    "statusCode": 404\n   },\n   {\n    "isPrimary": false,\n    "name": "Sandboxing",\n    "statusCode": 200\n   },\n   {\n    "isPrimary": false,\n    "name": "Database Connectivity",\n    "statusCode": 200\n   }\n  ]\n },\n "isProphecyDown": false,\n "success": true\n}\n'))))}d.isMDXComponent=!0}}]);