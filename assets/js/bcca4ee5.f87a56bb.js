"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[6626],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>k});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),u=d(a),c=r,k=u["".concat(s,".").concat(c)]||u[c]||m[c]||l;return a?n.createElement(k,i(i({ref:t},p),{},{components:a})):n.createElement(k,i({ref:t},p))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[u]="string"==typeof e?e:r,i[1]=o;for(var d=2;d<l;d++)i[d]=a[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},72360:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(67294),r=a(86010);const l={tabItem:"tabItem_OmH5"};function i(e){let{children:t,hidden:a,className:i}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(l.tabItem,i),hidden:a},t)}},9877:(e,t,a)=>{a.d(t,{Z:()=>m});var n=a(83117),r=a(67294),l=a(72389),i=a(67392),o=a(7094),s=a(12466),d=a(86010);const p={tabList:"tabList_uSqn",tabItem:"tabItem_LplD"};function u(e){const{lazy:t,block:a,defaultValue:l,values:u,groupId:m,className:c}=e,k=r.Children.map(e.children,(e=>{if((0,r.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),h=u??k.map((e=>{let{props:{value:t,label:a,attributes:n}}=e;return{value:t,label:a,attributes:n}})),g=(0,i.l)(h,((e,t)=>e.value===t.value));if(g.length>0)throw new Error(`Docusaurus error: Duplicate values "${g.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const b=null===l?l:l??k.find((e=>e.props.default))?.props.value??k[0]?.props.value;if(null!==b&&!h.some((e=>e.value===b)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${b}" but none of its children has the corresponding value. Available values are: ${h.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:N,setTabGroupChoices:f}=(0,o.U)(),[w,y]=(0,r.useState)(b),v=[],{blockElementScrollPositionUntilNextRender:C}=(0,s.o5)();if(null!=m){const e=N[m];null!=e&&e!==w&&h.some((t=>t.value===e))&&y(e)}const T=e=>{const t=e.currentTarget,a=v.indexOf(t),n=h[a].value;n!==w&&(C(t),y(n),null!=m&&f(m,n))},D=e=>{let t=null;switch(e.key){case"ArrowRight":{const a=v.indexOf(e.currentTarget)+1;t=v[a]||v[0];break}case"ArrowLeft":{const a=v.indexOf(e.currentTarget)-1;t=v[a]||v[v.length-1];break}}t?.focus()};return r.createElement("div",{className:(0,d.Z)("tabs-container",p.tabList)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,d.Z)("tabs",{"tabs--block":a},c)},h.map((e=>{let{value:t,label:a,attributes:l}=e;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:w===t?0:-1,"aria-selected":w===t,key:t,ref:e=>v.push(e),onKeyDown:D,onFocus:T,onClick:T},l,{className:(0,d.Z)("tabs__item",p.tabItem,l?.className,{"tabs__item--active":w===t})}),a??t)}))),t?(0,r.cloneElement)(k.filter((e=>e.props.value===w))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},k.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==w})))))}function m(e){const t=(0,l.Z)();return r.createElement(u,(0,n.Z)({key:String(t)},e))}},23467:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>k,frontMatter:()=>o,metadata:()=>d,toc:()=>u});var n=a(83117),r=(a(67294),a(3905)),l=a(9877),i=a(72360);const o={title:"JDBC",id:"jdbc",description:"JDBC",sidebar_position:4,tags:["gems","warehouse","jdbc"]},s=void 0,d={unversionedId:"low-code-spark/gems/source-target/warehouse/jdbc",id:"low-code-spark/gems/source-target/warehouse/jdbc",title:"JDBC",description:"JDBC",source:"@site/docs/low-code-spark/gems/source-target/warehouse/jdbc.md",sourceDirName:"low-code-spark/gems/source-target/warehouse",slug:"/low-code-spark/gems/source-target/warehouse/jdbc",permalink:"/low-code-spark/gems/source-target/warehouse/jdbc",draft:!1,tags:[{label:"gems",permalink:"/tags/gems"},{label:"warehouse",permalink:"/tags/warehouse"},{label:"jdbc",permalink:"/tags/jdbc"}],version:"current",sidebarPosition:4,frontMatter:{title:"JDBC",id:"jdbc",description:"JDBC",sidebar_position:4,tags:["gems","warehouse","jdbc"]},sidebar:"defaultSidebar",previous:{title:"Teradata",permalink:"/low-code-spark/gems/source-target/warehouse/teradata"},next:{title:"Oracle",permalink:"/low-code-spark/gems/source-target/warehouse/oracle"}},p={},u=[{value:"Source",id:"source",level:2},{value:"Source Parameters",id:"source-parameters",level:3},{value:"Source Table",id:"source-table",level:3},{value:"Source Query",id:"source-query",level:3},{value:"Example",id:"source-example",level:3},{value:"Generated Code",id:"source-code",level:3},{value:"Target",id:"target",level:2},{value:"Target Parameters",id:"target-parameters",level:3},{value:"Supported Write Modes",id:"supported-write-modes",level:3},{value:"Target Example",id:"target-example",level:3},{value:"Generated Code",id:"target-code",level:3}],m={toc:u},c="wrapper";function k(e){let{components:t,...a}=e;return(0,r.kt)(c,(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Reads and writes data from other databases using JDBC."),(0,r.kt)("h2",{id:"source"},"Source"),(0,r.kt)("h3",{id:"source-parameters"},"Source Parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Required"),(0,r.kt)("th",{parentName:"tr",align:null},"Default"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Credential Type"),(0,r.kt)("td",{parentName:"tr",align:null},"Credential Type provider (Databricks Secrets or Username/Password). These can be set in the config options/via Databricks secrets for security purpose, so that it's not visible in code."),(0,r.kt)("td",{parentName:"tr",align:null},"True"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Credential Scope"),(0,r.kt)("td",{parentName:"tr",align:null},"Scope to use for Databricks secrets"),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"url"),(0,r.kt)("td",{parentName:"tr",align:null},"The JDBC URL in the form ",(0,r.kt)("inlineCode",{parentName:"td"},"jdbc:subprotocol:subname")," to connect to. The source-specific connection properties may be specified in the URL. e.g., ",(0,r.kt)("br",null)," ",(0,r.kt)("inlineCode",{parentName:"td"},"jdbc:postgresql://test.us-east-1.rds.amazonaws.com:5432/postgres"),",",(0,r.kt)("br",null)," ",(0,r.kt)("inlineCode",{parentName:"td"},"jdbc:mysql://database-mysql.test.us-east-1.rds.amazonaws.com:3306/mysql")),(0,r.kt)("td",{parentName:"tr",align:null},"True"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"dbtable"),(0,r.kt)("td",{parentName:"tr",align:null},"The JDBC table that should be read from. See ",(0,r.kt)("a",{parentName:"td",href:"#source-table"},"here")," for more details."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"query"),(0,r.kt)("td",{parentName:"tr",align:null},"The query that will be used to read data into Spark. See ",(0,r.kt)("a",{parentName:"td",href:"#source-query"},"here")," for more details"),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"driver"),(0,r.kt)("td",{parentName:"tr",align:null},"The class name of the JDBC driver to use to connect to this URL. e.g., ",(0,r.kt)("br",null)," For postgres : ",(0,r.kt)("inlineCode",{parentName:"td"},"org.postgresql.Driver")," ",(0,r.kt)("br",null)," For mysql: ",(0,r.kt)("inlineCode",{parentName:"td"},"com.mysql.cj.jdbc.Driver")),(0,r.kt)("td",{parentName:"tr",align:null},"True"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Partition Column, Lower Bound, Upper Bound"),(0,r.kt)("td",{parentName:"tr",align:null},"These options must all be specified if any of them is specified. In addition, numPartitions must be specified. They describe how to partition the table when reading in parallel from multiple workers. ",(0,r.kt)("inlineCode",{parentName:"td"},"partitionColumn")," must be a numeric, date, or timestamp column from the table in question. Notice that ",(0,r.kt)("inlineCode",{parentName:"td"},"lowerBound")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"upperBound")," are just used to decide the partition stride, ",(0,r.kt)("em",{parentName:"td"},"not")," for filtering the rows in table. So all rows in the table will be partitioned and returned. This option applies only to reading. ",(0,r.kt)("br",null)," ",(0,r.kt)("inlineCode",{parentName:"td"},"Note: Dropdown to choose column in partition column will only be populated once schema is inferred.")),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Number of partitions"),(0,r.kt)("td",{parentName:"tr",align:null},"The maximum number of partitions that can be used for parallelism in table reading. This also determines the maximum number of concurrent JDBC connections."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Query Timeout"),(0,r.kt)("td",{parentName:"tr",align:null},"The number of seconds the driver will wait for a Statement object to execute. Zero means there is no limit. As a ",(0,r.kt)("inlineCode",{parentName:"td"},"Target"),", this option depends on how JDBC drivers implement the API setQueryTimeout, e.g., the h2 JDBC driver checks the timeout of each query instead of an entire JDBC batch."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"0"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Fetch size"),(0,r.kt)("td",{parentName:"tr",align:null},"The JDBC fetch size, which determines how many rows to fetch per round trip. This can help performance on JDBC drivers which default to low fetch size (e.g. Oracle with 10 rows)."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"0"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Session Init Statement"),(0,r.kt)("td",{parentName:"tr",align:null},"After each database session is opened to the remote DB and before starting to read data, this parameter executes a custom SQL statement (or a PL/SQL block). Use this to implement session initialization code. Example: ",(0,r.kt)("inlineCode",{parentName:"td"},'option("sessionInitStatement", """BEGIN execute immediate \'alter session set "_serial_direct_read"=true\'; END;""")')),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Push-Down Predicate"),(0,r.kt)("td",{parentName:"tr",align:null},"Enable or disable predicate push-down into the JDBC data source. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"true"),", in which case Spark will push down filters to the JDBC data source as much as possible. Otherwise, if set to false, no filter will be pushed down to the JDBC data source and thus all filters will be handled by Spark. Predicate push-down is usually turned off when the predicate filtering is performed faster by Spark than by the JDBC data source."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"True"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Push-Down Aggregate"),(0,r.kt)("td",{parentName:"tr",align:null},"Enable or disable aggregate push-down in V2 JDBC data source. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"false"),", in which case Spark will not push down aggregates to the JDBC data source. Aggregate push-down is usually turned off when the aggregate is performed faster by Spark than by the JDBC data source. Please note that aggregates can be pushed down if and only if all the aggregate functions and the related filters can be pushed down. Spark assumes that the data source can't fully complete the aggregate and does a final aggregate over the data source output."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"False"))))),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If you get ",(0,r.kt)("inlineCode",{parentName:"p"},"class not found")," error during running of pipeline then your dependency might be missing in the cluster.\nTo read more about how to add dependencies for specific jdbc jar ",(0,r.kt)("a",{parentName:"p",href:"/low-code-spark/extensibility/dependencies"},(0,r.kt)("strong",{parentName:"a"},"click here"))))),(0,r.kt)("h3",{id:"source-table"},"Source Table"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"dbtable")," parameter dictates which Table will be used as the source to read from. Anything that is valid in a ",(0,r.kt)("inlineCode",{parentName:"p"},"FROM")," clause of a SQL query can also be used. For example, instead of a table name you could use a subquery in parentheses."),(0,r.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"danger")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"dbtable")," parameter and the ",(0,r.kt)("inlineCode",{parentName:"p"},"query")," parameter are mutually exclusive, they cannot both be specified at the same time."))),(0,r.kt)("h3",{id:"source-query"},"Source Query"),(0,r.kt)("p",null,"The specified query will be used as a subquery in the ",(0,r.kt)("inlineCode",{parentName:"p"},"FROM")," clause. Spark will also assign an alias to the subquery clause. For example, Spark will issue a query of the following form to the JDBC Source. ",(0,r.kt)("inlineCode",{parentName:"p"},"SELECT columns FROM (<user_specified_query>) spark_gen_alias"),"."),(0,r.kt)("p",null,"There are a couple of restrictions while using this option:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"query")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"partitionColumn")," options cannot be used at the same time."),(0,r.kt)("li",{parentName:"ol"},"When specifying the ",(0,r.kt)("inlineCode",{parentName:"li"},"partitionColumn")," option is required, the subquery can be specified using ",(0,r.kt)("inlineCode",{parentName:"li"},"dbtable")," option instead and partition columns can be qualified using the subquery alias provided as part of ",(0,r.kt)("inlineCode",{parentName:"li"},"dbtable"),".")),(0,r.kt)("h3",{id:"source-example"},"Example"),(0,r.kt)("div",{class:"wistia_responsive_padding",style:{padding:"56.25% 0 0 0",position:"relative"}},(0,r.kt)("div",{class:"wistia_responsive_wrapper",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"}},(0,r.kt)("iframe",{src:"https://user-images.githubusercontent.com/103921419/173814656-1c857949-cd5a-4032-922b-5a621d77fd75.mp4",title:"JDBC source",allow:"autoplay;fullscreen",allowtransparency:"true",frameborder:"0",scrolling:"no",class:"wistia_embed",name:"wistia_embed",msallowfullscreen:!0,width:"100%",height:"100%"}))),(0,r.kt)("h3",{id:"source-code"},"Generated Code"),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'def Source(spark: SparkSession) -> DataFrame:\n    return spark.read\\\n        .format("jdbc")\\\n        .option("url", f"{Config.jdbc_url}")\\\n        .option("user", f"{Config.jdbc_username}")\\\n        .option("password", f"{Config.jdbc_password}")\\\n        .option("dbtable", "public.demo_customers_raw")\\\n        .option("pushDownPredicate", True)\\\n        .option("driver", "org.postgresql.Driver")\\\n        .load()\n\n'))),(0,r.kt)(i.Z,{value:"scala",label:"Scala",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'object Source {\n\n  def apply(spark: SparkSession): DataFrame = {\n    var reader = spark.read\n      .format("jdbc")\n      .option("url",  s"${Config.jdbc_url}")\n      .option("user", s"${Config.jdbc_username}")\n      .option("password", s"${Config.jdbc_password}")\n      .option("dbtable", "public.demo_customers_raw")\n    reader = reader\n      .option("pushDownPredicate", true)\n      .option("driver", "org.postgresql.Driver")\n    reader.load()\n  }\n\n}\n')))),(0,r.kt)("h2",{id:"target"},"Target"),(0,r.kt)("h3",{id:"target-parameters"},"Target Parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Required"),(0,r.kt)("th",{parentName:"tr",align:null},"Default"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Credential Type"),(0,r.kt)("td",{parentName:"tr",align:null},"Credential Type provider (Databricks Secrets or Username/Password). These can be set in the config options/via Databricks secrets for security purpose, so that it's not visible in code."),(0,r.kt)("td",{parentName:"tr",align:null},"True"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Credential Scope"),(0,r.kt)("td",{parentName:"tr",align:null},"Scope to use for Databricks secrets"),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"url"),(0,r.kt)("td",{parentName:"tr",align:null},"The JDBC URL in the form ",(0,r.kt)("inlineCode",{parentName:"td"},"jdbc:subprotocol:subname")," to connect to. The source-specific connection properties may be specified in the URL. e.g., ",(0,r.kt)("br",null)," ",(0,r.kt)("inlineCode",{parentName:"td"},"jdbc:postgresql://test.us-east-1.rds.amazonaws.com:5432/postgres"),",",(0,r.kt)("br",null)," ",(0,r.kt)("inlineCode",{parentName:"td"},"jdbc:mysql://database-mysql.test.us-east-1.rds.amazonaws.com:3306/mysql")),(0,r.kt)("td",{parentName:"tr",align:null},"True"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"table"),(0,r.kt)("td",{parentName:"tr",align:null},"The JDBC table that should be written into."),(0,r.kt)("td",{parentName:"tr",align:null},"True"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"driver"),(0,r.kt)("td",{parentName:"tr",align:null},"The class name of the JDBC driver to use to connect to this URL. e.g., ",(0,r.kt)("br",null)," For Postgres : ",(0,r.kt)("inlineCode",{parentName:"td"},"org.postgresql.Driver")," ",(0,r.kt)("br",null)," For MySQL: ",(0,r.kt)("inlineCode",{parentName:"td"},"com.mysql.cj.jdbc.Driver")),(0,r.kt)("td",{parentName:"tr",align:null},"True"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Number of Partitions"),(0,r.kt)("td",{parentName:"tr",align:null},"The maximum number of partitions that can be used for parallelism in table writing. This also determines the maximum number of concurrent JDBC connections. If the number of partitions to write exceeds this limit, we decrease it to this limit by calling ",(0,r.kt)("inlineCode",{parentName:"td"},"coalesce(numPartitions)")," before writing."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Query Timeout"),(0,r.kt)("td",{parentName:"tr",align:null},"The number of seconds the driver will wait for a Statement object to execute. Zero means there is no limit. This option depends on how JDBC drivers implement the API setQueryTimeout, e.g., the h2 JDBC driver checks the timeout of each query instead of an entire JDBC batch."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"0"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Batch Size"),(0,r.kt)("td",{parentName:"tr",align:null},"The JDBC batch size, which determines how many rows to insert per round trip. This can help performance on JDBC drivers. This option applies only to writing."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"1000"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Isolation Level"),(0,r.kt)("td",{parentName:"tr",align:null},"The transaction isolation level, which applies to current connection. It can be one of ",(0,r.kt)("inlineCode",{parentName:"td"},"NONE"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"READ_COMMITTED"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"READ_UNCOMMITTED"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"REPEATABLE_READ"),", or ",(0,r.kt)("inlineCode",{parentName:"td"},"SERIALIZABLE"),", corresponding to standard transaction isolation levels defined by JDBC's Connection object. Please refer to the ",(0,r.kt)("a",{parentName:"td",href:"https://docs.oracle.com/en/java/javase/11/docs/api/java.sql/java/sql/Connection.html"},"documentation")," for more information"),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"READ_UNCOMMITTED"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Truncate"),(0,r.kt)("td",{parentName:"tr",align:null},"When ",(0,r.kt)("inlineCode",{parentName:"td"},"SaveMode")," is set to ",(0,r.kt)("inlineCode",{parentName:"td"},"Overwrite"),", this option causes Spark to truncate an existing table instead of dropping and recreating it. This can be more efficient, and prevents the table metadata (e.g., indices) from being removed. However, it will not work in some cases, such as when the new data has a different schema. In case of failures, users should turn off truncate option to use ",(0,r.kt)("inlineCode",{parentName:"td"},"DROP TABLE")," again. Also, due to the different behavior of ",(0,r.kt)("inlineCode",{parentName:"td"},"TRUNCATE TABLE")," among DBMS, it's not always safe to use this. ",(0,r.kt)("inlineCode",{parentName:"td"},"MySQLDialect"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"DB2Dialect"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"MsSqlServerDialect"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"DerbyDialect"),", and ",(0,r.kt)("inlineCode",{parentName:"td"},"OracleDialect")," supports this while ",(0,r.kt)("inlineCode",{parentName:"td"},"PostgresDialect")," and the default ",(0,r.kt)("inlineCode",{parentName:"td"},"JDBCDialect")," doesn't. For unknown and unsupported ",(0,r.kt)("inlineCode",{parentName:"td"},"JDBCDialect"),", the user option truncate is ignored."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"False"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Cascade Truncate"),(0,r.kt)("td",{parentName:"tr",align:null},"If enabled and supported by the JDBC database (PostgreSQL and Oracle at the moment), this options allows execution of a ",(0,r.kt)("inlineCode",{parentName:"td"},"TRUNCATE TABLE t CASCADE")," (in the case of PostgreSQL a ",(0,r.kt)("inlineCode",{parentName:"td"},"TRUNCATE TABLE ONLY t CASCADE")," is executed to prevent inadvertently truncating descendant tables). This will affect other tables, and thus should be used with care."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},"Default according to the ",(0,r.kt)("inlineCode",{parentName:"td"},"JDBCDialect")," in use")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Create Table Options"),(0,r.kt)("td",{parentName:"tr",align:null},"If specified, this option allows setting of database-specific table and partition options when creating a table (e.g., ",(0,r.kt)("inlineCode",{parentName:"td"},"CREATE TABLE t (name string) ENGINE=InnoDB."),")."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Create Table Column Types"),(0,r.kt)("td",{parentName:"tr",align:null},"The database column data types to use instead of the defaults when creating the table. Data type information should be specified in the same format as ",(0,r.kt)("inlineCode",{parentName:"td"},"CREATE TABLE")," columns syntax (e.g: ",(0,r.kt)("inlineCode",{parentName:"td"},'"name CHAR(64), comments VARCHAR(1024)"'),"). The specified types should be valid Spark SQL data types."),(0,r.kt)("td",{parentName:"tr",align:null},"False"),(0,r.kt)("td",{parentName:"tr",align:null},"(none)")))),(0,r.kt)("h3",{id:"supported-write-modes"},"Supported Write Modes"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Write Mode"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"overwrite"),(0,r.kt)("td",{parentName:"tr",align:null},"If data already exists, overwrite with the contents of the DataFrame")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"append"),(0,r.kt)("td",{parentName:"tr",align:null},"If data already exists, append the contents of the DataFrame")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ignore"),(0,r.kt)("td",{parentName:"tr",align:null},"If data already exists, do nothing with the contents of the DataFrame. This is similar to a ",(0,r.kt)("inlineCode",{parentName:"td"},"CREATE TABLE IF NOT EXISTS")," in SQL.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"error"),(0,r.kt)("td",{parentName:"tr",align:null},"If data already exists, throw an exception.")))),(0,r.kt)("h3",{id:"target-example"},"Target Example"),(0,r.kt)("div",{class:"wistia_responsive_padding",style:{padding:"56.25% 0 0 0",position:"relative"}},(0,r.kt)("div",{class:"wistia_responsive_wrapper",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"}},(0,r.kt)("iframe",{src:"https://user-images.githubusercontent.com/103921419/173814665-f932bbae-cc4a-4b4b-90e8-09749b714a76.mp4",title:"JDBC target",allow:"autoplay;fullscreen",allowtransparency:"true",frameborder:"0",scrolling:"no",class:"wistia_embed",name:"wistia_embed",msallowfullscreen:!0,width:"100%",height:"100%"}))),(0,r.kt)("h3",{id:"target-code"},"Generated Code"),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"py",label:"Python",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'def Target(spark: SparkSession, in0: DataFrame):\n   in0.write\\\n      .format("jdbc")\\\n      .option("url", f"{Config.jdbc_url}")\\\n      .option("dbtable", "public.demo_customers_raw_output")\\\n      .option("user", f"{Config.jdbc_username}")\\\n      .option("password", f"{Config.jdbc_password}")\\\n      .option("driver", "org.postgresql.Driver")\\\n      .save()\n\n'))),(0,r.kt)(i.Z,{value:"scala",label:"Scala",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'object Target {\n\n  def apply(spark: SparkSession, in: DataFrame): Unit = {\n    in.write\n      .format("jdbc")\n      .option("url", s"${Config.jdbc_url}")\n      .option("dbtable", "public.demo_customers_raw_output")\n      .option("user", s"${Config.jdbc_username}")\n      .option("password", s"${Config.jdbc_password}")\n      .option("driver", "org.postgresql.Driver")\n      .save()\n  }\n\n}\n\n')))))}k.isMDXComponent=!0}}]);