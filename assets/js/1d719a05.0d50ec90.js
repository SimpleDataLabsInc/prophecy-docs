"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[38667],{20246:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"analysts/development/gems/visual-expression-builder/use-the-expression-builder","title":"Advanced visual expressions","description":"Create complex visual expressions that include logical operators, comparisons, and parameters","source":"@site/docs/analysts/development/gems/visual-expression-builder/use-the-visual-expression-builder.md","sourceDirName":"analysts/development/gems/visual-expression-builder","slug":"/analysts/use-visual-expression-builder","permalink":"/analysts/use-visual-expression-builder","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"expression builder","permalink":"/tags/expression-builder"},{"inline":true,"label":"sql","permalink":"/tags/sql"}],"version":"current","frontMatter":{"title":"Advanced visual expressions","id":"use-the-expression-builder","slug":"/analysts/use-visual-expression-builder","description":"Create complex visual expressions that include logical operators, comparisons, and parameters","tags":["expression builder","sql"]},"sidebar":"mySidebar","previous":{"title":"Visual expressions reference","permalink":"/analysts/visual-expression-builder-reference"},"next":{"title":"Variant data type","permalink":"/analysts/variant-schema"}}');var r=n(74848),t=n(28453);const l={title:"Advanced visual expressions",id:"use-the-expression-builder",slug:"/analysts/use-visual-expression-builder",description:"Create complex visual expressions that include logical operators, comparisons, and parameters",tags:["expression builder","sql"]},o=void 0,a={},c=[{value:"Key advanced features",id:"key-advanced-features",level:2},{value:"Examples",id:"examples",level:2},{value:"Use comparisons to stratify accounts",id:"use-comparisons-to-stratify-accounts",level:3},{value:"Create a new conditional column",id:"create-a-new-conditional-column",level:4},{value:"Configure the WHEN clause",id:"configure-the-when-clause",level:4},{value:"Configure the THEN clause",id:"configure-the-then-clause",level:4},{value:"Use groupings to create complex filters",id:"use-groupings-to-create-complex-filters",level:3},{value:"Set up base filter conditions",id:"set-up-base-filter-conditions",level:4},{value:"Add grouped <code>OR</code> condition",id:"add-grouped-or-condition",level:4},{value:"Create dynamic expressions with parameters",id:"create-dynamic-expressions-with-parameters",level:3},{value:"Create an array parameter",id:"create-an-array-parameter",level:4},{value:"Use the parameter in an expression",id:"use-the-parameter-in-an-expression",level:4},{value:"Validate your expressions",id:"validate-your-expressions",level:2},{value:"Tips",id:"tips",level:2}];function d(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:["In addition to using the ",(0,r.jsx)(s.a,{href:"/analysts/visual-expression-builder-reference",children:"expression options"})," that appear when you open the visual expression builder, you can also create additional configurations that add complexity to your expressions. This page explains the advanced expressions that you can achieve with the visual expression builder."]}),"\n",(0,r.jsx)(s.h2,{id:"key-advanced-features",children:"Key advanced features"}),"\n",(0,r.jsx)(s.p,{children:"The following table describes a few advanced options for the visual expression builder."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Feature"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Comparison"}),(0,r.jsx)(s.td,{children:"Lets you establish relationships between two simple expressions connected by an operator. This mode helps you perform comparisons or existence checks on your data that always evaluate to true or false."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Grouping"}),(0,r.jsxs)(s.td,{children:["Combine multiple comparison expressions into groups using logical operators like ",(0,r.jsx)(s.code,{children:"AND"})," and ",(0,r.jsx)(s.code,{children:"OR"}),". This structure enables you to express intricate business logic in a visual format."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Parameters"}),(0,r.jsxs)(s.td,{children:["Enables you to include variables in your expressions that may vary at runtime. Parameters only show up in the ",(0,r.jsx)(s.strong,{children:"Configuration Variables"})," of the visual expression builder after you have ",(0,r.jsx)(s.a,{href:"/analysts/pipeline-parameters",children:"created them"})," at the pipeline level."]})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(s.h3,{id:"use-comparisons-to-stratify-accounts",children:"Use comparisons to stratify accounts"}),"\n",(0,r.jsx)(s.p,{children:"Let's say you want to stratify accounts based on their annual revenues. Each condition we set up is limited to one comparison. This example combines conditional logic with comparison operators."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Reformat gem using Comparison mode",src:n(78815).A+"",width:"2620",height:"1505"})}),"\n",(0,r.jsx)(s.h4,{id:"create-a-new-conditional-column",children:"Create a new conditional column"}),"\n",(0,r.jsx)(s.p,{children:"To set up the comparison expressions to match the image above:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["In the Reformat gem, under ",(0,r.jsx)(s.strong,{children:"Target Column"}),", click ",(0,r.jsx)(s.strong,{children:"Select Column"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Give the column the name ",(0,r.jsx)(s.code,{children:"stratify_by_revenue"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select expression > Conditional"}),". A ",(0,r.jsx)(s.code,{children:"WHEN"})," clause appears."]}),"\n"]}),"\n",(0,r.jsx)(s.h4,{id:"configure-the-when-clause",children:"Configure the WHEN clause"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["For ",(0,r.jsx)(s.code,{children:"WHEN"}),", click ",(0,r.jsx)(s.strong,{children:"Select expression > Function"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Select ",(0,r.jsx)(s.strong,{children:"Data type cast"}),", which converts a value of one data type into another data type."]}),"\n",(0,r.jsxs)(s.li,{children:["Select ",(0,r.jsx)(s.strong,{children:"Throw error on failure"})," to ensure the pipeline doesn't run if the type cast fails."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select expression > Column"})," and select ",(0,r.jsx)(s.code,{children:"ANNUALREVENUE"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select data type > Float"})," to convert the column to a Float type."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select operator"})," and select ",(0,r.jsx)(s.code,{children:"less than"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select expression > Value"})," and enter ",(0,r.jsx)(s.code,{children:"1000000"})," as the value."]}),"\n"]}),"\n",(0,r.jsx)(s.h4,{id:"configure-the-then-clause",children:"Configure the THEN clause"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["For ",(0,r.jsx)(s.code,{children:"THEN"}),", click ",(0,r.jsx)(s.strong,{children:"Select expression"})," and select ",(0,r.jsx)(s.strong,{children:"Value"}),". Enter ",(0,r.jsx)(s.code,{children:"Low Revenue"})," as the value."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.code,{children:"+"})," on the next line and select ",(0,r.jsx)(s.strong,{children:"Add CASE"})," to add another ",(0,r.jsx)(s.code,{children:"WHEN"})," clause."]}),"\n",(0,r.jsx)(s.li,{children:"Repeat steps 3 to 8 to set up the rest of the comparison expressions."}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.code,{children:"+"})," on the next line and select ",(0,r.jsx)(s.strong,{children:"Add ELSE"})," to add an ",(0,r.jsx)(s.code,{children:"ELSE"})," statement."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select expression"})," and select ",(0,r.jsx)(s.strong,{children:"Value"}),". Enter ",(0,r.jsx)(s.code,{children:"Unknown"})," as the value."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"This conditional expression will categorize your accounts based on revenue thresholds, making it easier to perform segment-specific analysis and reporting. When the pipeline runs, each account will be assigned to the appropriate revenue category based on the conditions you've defined."}),"\n",(0,r.jsx)(s.h3,{id:"use-groupings-to-create-complex-filters",children:"Use groupings to create complex filters"}),"\n",(0,r.jsxs)(s.p,{children:["When filtering data, you often want the output data to meet multiple criteria. You can use Grouping for this by creating multiple ",(0,r.jsx)(s.code,{children:"AND"})," and ",(0,r.jsx)(s.code,{children:"OR"})," statements."]}),"\n",(0,r.jsx)(s.p,{children:"Assume you have a dataset where you want to filter for the following:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Total expected revenue that ",(0,r.jsx)(s.code,{children:"is not null"})]}),"\n",(0,r.jsxs)(s.li,{children:["Total amounts that are greater than ",(0,r.jsx)(s.code,{children:"100000"})]}),"\n",(0,r.jsxs)(s.li,{children:["Latest closed quarters that equals ",(0,r.jsx)(s.code,{children:"2023Q2"})," or ",(0,r.jsx)(s.code,{children:"2024Q2"})]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Filter gem using Grouping mode",src:n(30875).A+"",width:"2620",height:"1507"})}),"\n",(0,r.jsx)(s.admonition,{type:"tip",children:(0,r.jsxs)(s.p,{children:["You can have any number of groups and nestings (a group within a group). You can also always change the grouping conditions between ",(0,r.jsx)(s.code,{children:"AND"})," and ",(0,r.jsx)(s.code,{children:"OR"}),"."]})}),"\n",(0,r.jsx)(s.h4,{id:"set-up-base-filter-conditions",children:"Set up base filter conditions"}),"\n",(0,r.jsx)(s.p,{children:"To set up the grouping expressions to match the image above:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["After creating the Filer gem, click ",(0,r.jsx)(s.strong,{children:"Add condition"}),". An option to Select expression appears."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select expression > Column"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Select ",(0,r.jsx)(s.code,{children:"TOTAL_EXPECTED_REVENUE"})," from the list."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select operator"})," and select ",(0,r.jsx)(s.code,{children:"is not null"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"+ Add Condition"})," to add another condition expression."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select expression > Column"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Select ",(0,r.jsx)(s.code,{children:"TOTAL_AMOUNT"})," from the list."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select operator"})," and select ",(0,r.jsx)(s.code,{children:"greater than"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select expression > Value"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Enter ",(0,r.jsx)(s.code,{children:"100000"})," as the value."]}),"\n"]}),"\n",(0,r.jsxs)(s.h4,{id:"add-grouped-or-condition",children:["Add grouped ",(0,r.jsx)(s.code,{children:"OR"})," condition"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Add Group"}),". A grouped expression row appears."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select expression > Column"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Select ",(0,r.jsx)(s.code,{children:"LATEST_CLOSED_QTR"})," from the list."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select operator"})," and select ",(0,r.jsx)(s.code,{children:"equals"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select expression > Value"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Enter ",(0,r.jsx)(s.code,{children:"2023Q3"})," as the value."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"+ Add Condition"})," and repeat steps 2 to 6 to set up the other ",(0,r.jsx)(s.code,{children:"OR"})," condition."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"This complex filter will return only high-value opportunities from specific quarters that have valid expected revenue values. By combining AND and OR conditions in this way, you can create precise data subsets that match your exact business requirements."}),"\n",(0,r.jsx)(s.h3,{id:"create-dynamic-expressions-with-parameters",children:"Create dynamic expressions with parameters"}),"\n",(0,r.jsx)(s.p,{children:"When you use a pipeline parameter in a visual expression, you can manipulate the value of that parameter using different configs at runtime. Let's review an example that leverages an array parameter in a Filter gem."}),"\n",(0,r.jsxs)(s.p,{children:["Imagine that you want to filter an ",(0,r.jsx)(s.code,{children:"Orders"})," dataset based on the region where the order was placed. Specifically, you only want to keep rows where the region is included in the array parameter."]}),"\n",(0,r.jsx)(s.h4,{id:"create-an-array-parameter",children:"Create an array parameter"}),"\n",(0,r.jsxs)(s.p,{children:["First, you'll set up a ",(0,r.jsx)(s.code,{children:"region"})," parameter, which will be an array of strings that includes a subset of regions."]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Open your project and select ",(0,r.jsx)(s.strong,{children:"Parameters"})," in the header."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"+ Add Parameter"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Name the parameter ",(0,r.jsx)(s.code,{children:"region"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Select the ",(0,r.jsx)(s.strong,{children:"Type"})," and choose ",(0,r.jsx)(s.strong,{children:"Array > String"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select expression > Value"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Type ",(0,r.jsx)(s.code,{children:"AMER"})," and click ",(0,r.jsx)(s.strong,{children:"Done"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Select ",(0,r.jsx)(s.code,{children:"+"})," to add another string to the array."]}),"\n",(0,r.jsxs)(s.li,{children:["Type ",(0,r.jsx)(s.code,{children:"APAC"})," and click ",(0,r.jsx)(s.strong,{children:"Done"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Now, click ",(0,r.jsx)(s.strong,{children:"Save"}),"."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Create string array",src:n(20852).A+"",width:"2866",height:"1610"})}),"\n",(0,r.jsx)(s.h4,{id:"use-the-parameter-in-an-expression",children:"Use the parameter in an expression"}),"\n",(0,r.jsx)(s.p,{children:"Now, you'll use the parameter in an expression inside a Filter gem."}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Create and open the Filter gem."}),"\n",(0,r.jsxs)(s.li,{children:["Remove the default ",(0,r.jsx)(s.code,{children:"true"})," expression."]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Select expression > Function"})," and select ",(0,r.jsx)(s.code,{children:"array_contains"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["In the ",(0,r.jsx)(s.strong,{children:"array"})," dropdown of the function, click ",(0,r.jsx)(s.strong,{children:"Configuration Variable"})," and select the ",(0,r.jsx)(s.code,{children:"region"})," parameter."]}),"\n",(0,r.jsxs)(s.li,{children:["In the ",(0,r.jsx)(s.strong,{children:"value"})," dropdown of the function, click ",(0,r.jsx)(s.strong,{children:"Column"})," and select the order region column."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Filter using array",src:n(96573).A+"",width:"2866",height:"1610"})}),"\n",(0,r.jsxs)(s.p,{children:["The output of this gem will only include rows where the order region matches at least one value in the ",(0,r.jsx)(s.code,{children:"region"})," array. When you run the pipeline interactively, it will use the values of the default array that you set up in the previous section."]}),"\n",(0,r.jsx)(s.h2,{id:"validate-your-expressions",children:"Validate your expressions"}),"\n",(0,r.jsxs)(s.p,{children:["Run the pipeline up to and including the gem with your expression, and observe the resulting data sample. To do so, click the ",(0,r.jsx)(s.strong,{children:"play"})," button on either the canvas or the gem. Once the code has finished running, you can verify the results to make sure they match your expectations. You can explore the result of your gem in the ",(0,r.jsx)(s.a,{href:"/analysts/data-explorer",children:"Data Explorer"}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"tips",children:"Tips"}),"\n",(0,r.jsx)(s.p,{children:"Here are some additional tips to keep in mind when using the visual expression builder:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"The expression dropdowns support search."}),"\n",(0,r.jsx)(s.li,{children:"Each argument of your function is another expression since you have the same expression options to choose from."}),"\n",(0,r.jsx)(s.li,{children:"You can drag and drop your comparison expressions to rearrange them."}),"\n",(0,r.jsx)(s.li,{children:"Just as with conditions, you can also drag and drop your grouping expressions to rearrange them."}),"\n",(0,r.jsx)(s.li,{children:"You can delete individual expressions, conditions, and groupings by clicking the trash icon at the end of the rows."}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},20852:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/array-param-a57958f4505d2584e6352b4eebdf3b97.png"},28453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>o});var i=n(96540);const r={},t=i.createContext(r);function l(e){const s=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:s},e.children)}},30875:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/filter-visual-expression-builder-51af95efb5a61a6902c15daf71f8cdac.png"},78815:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/reformat-visual-expression-builder-5f9835f4df7601eedcdca42f021b35a2.png"},96573:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/filter-array-bbd341e4213e798fd7aed0694ef5d3b6.png"}}]);