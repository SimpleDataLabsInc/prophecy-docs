"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[10547],{28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>r});var t=s(96540);const a={},l=t.createContext(a);function i(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(l.Provider,{value:n},e.children)}},31155:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/hana-properties-132210760e154f2fa94f688a9a8fcef0.png"},87746:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"analysts/development/gems/source-target/external-table/hana/generated-columns","title":"Generated columns","description":"Define generated columns in HANA target gems","source":"@site/docs/analysts/development/gems/source-target/external-table/hana/identity-columns.md","sourceDirName":"analysts/development/gems/source-target/external-table/hana","slug":"/analysts/hana-generated-columns","permalink":"/analysts/hana-generated-columns","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Generated columns","id":"generated-columns","slug":"/analysts/hana-generated-columns","description":"Define generated columns in HANA target gems","tags":[]},"sidebar":"platformSidebar","previous":{"title":"SAP HANA","permalink":"/analysts/hana-gem"},"next":{"title":"Snowflake","permalink":"/analysts/snowflake"}}');var a=s(74848),l=s(28453);const i={title:"Generated columns",id:"generated-columns",slug:"/analysts/hana-generated-columns",description:"Define generated columns in HANA target gems",tags:[]},r=void 0,o={},c=[{value:"Generated column types",id:"generated-column-types",level:2},{value:"GENERATED ALWAYS AS IDENTITY",id:"generated-always-as-identity",level:3},{value:"Example",id:"example-always-as",level:4},{value:"GENERATED BY DEFAULT AS IDENTITY",id:"generated-by-default-as-identity",level:3},{value:"Example",id:"example-by-default",level:4},{value:"GENERATED ALWAYS AS (expression)",id:"generated-always-as-expression",level:3},{value:"Example",id:"example-expression",level:4},{value:"Define generated columns",id:"define-generated-columns",level:2},{value:"Write to tables with generated columns",id:"write-to-tables-with-generated-columns",level:2},{value:"What&#39;s next",id:"whats-next",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"Generated columns automatically generate values for inserted rows. Configure the generation behavior based on your use case."}),"\n",(0,a.jsx)(n.h2,{id:"generated-column-types",children:"Generated column types"}),"\n",(0,a.jsx)(n.h3,{id:"generated-always-as-identity",children:"GENERATED ALWAYS AS IDENTITY"}),"\n",(0,a.jsxs)(n.p,{children:["When a column has the ",(0,a.jsx)(n.code,{children:"GENERATED ALWAYS AS IDENTITY"})," type, it:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Accepts sequence parameters such as ",(0,a.jsx)(n.code,{children:"START WITH"})," and ",(0,a.jsx)(n.code,{children:"INCREMENT BY"})," to control how values are generated."]}),"\n",(0,a.jsx)(n.li,{children:"Generates values automatically based solely on the sequence parameters."}),"\n",(0,a.jsx)(n.li,{children:"Creates an IDENTITY column managed entirely by SAP HANA."}),"\n",(0,a.jsx)(n.li,{children:"Ignores values provided during an insert."}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"example-always-as",children:"Example"}),"\n",(0,a.jsx)(n.p,{children:"Assume you need a column that auto-increments primary keys for users or products. You never want users or inserts to override the value."}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Column: ",(0,a.jsx)(n.code,{children:"user_id"})]}),"\n",(0,a.jsxs)(n.li,{children:["Type: ",(0,a.jsx)(n.code,{children:"GENERATED ALWAYS AS IDENTITY"})]}),"\n",(0,a.jsxs)(n.li,{children:["Always As: ",(0,a.jsx)(n.code,{children:"START WITH 1 INCREMENT BY 1"})]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Here, ",(0,a.jsx)(n.code,{children:"user_id"})," will automatically start at 1 and increment by 1 for every new row. Attempts to insert values will be ignored."]}),"\n",(0,a.jsx)(n.h3,{id:"generated-by-default-as-identity",children:"GENERATED BY DEFAULT AS IDENTITY"}),"\n",(0,a.jsxs)(n.p,{children:["When a column has the ",(0,a.jsx)(n.code,{children:"GENERATED BY DEFAULT AS IDENTITY"})," type, it:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Accepts sequence parameters such as ",(0,a.jsx)(n.code,{children:"START WITH"})," and ",(0,a.jsx)(n.code,{children:"INCREMENT BY"})," to control how values are generated."]}),"\n",(0,a.jsxs)(n.li,{children:["Generates values automatically ",(0,a.jsx)(n.em,{children:"when no value is provided in an insert"}),"."]}),"\n",(0,a.jsx)(n.li,{children:"Creates an IDENTITY column that can accept manual values if they are included in the insert."}),"\n",(0,a.jsx)(n.li,{children:"Adjusts the internal sequence automatically if a manually provided value is higher (or lower, in the case of a negative increment) than the current sequence."}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"example-by-default",children:"Example"}),"\n",(0,a.jsx)(n.p,{children:"Assume you need to migrate legacy data while keeping original IDs, but still allowing auto-increment for new rows."}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Column: ",(0,a.jsx)(n.code,{children:"customer_id"})]}),"\n",(0,a.jsxs)(n.li,{children:["Type: ",(0,a.jsx)(n.code,{children:"GENERATED BY DEFAULT AS IDENTITY"})]}),"\n",(0,a.jsxs)(n.li,{children:["Always As: ",(0,a.jsx)(n.code,{children:"START WITH 1000 INCREMENT BY 1"})]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Suppose you have existing customers with IDs 1000\u20131050. When inserting these rows, you can provide the IDs explicitly. New customers inserted without an ID will automatically get the next sequence value (1051, 1052, ...) by default."}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["For more information on sequence parameters, see ",(0,a.jsx)(n.a,{href:"https://help.sap.com/docs/SAP_HANA_PLATFORM/4fe29514fd584807ac9f2a04f6754767/20d509277519101489029c064d468c5d.html",children:"CREATE SEQUENCE Statement"}),". This includes reference information on syntax and default values."]})}),"\n",(0,a.jsx)(n.h3,{id:"generated-always-as-expression",children:"GENERATED ALWAYS AS (expression)"}),"\n",(0,a.jsxs)(n.p,{children:["When a column has the ",(0,a.jsx)(n.code,{children:"GENERATED ALWAYS AS (expression)"})," type, it:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Computes values using a defined expression based on other columns in the table."}),"\n",(0,a.jsx)(n.li,{children:"Updates automatically whenever referenced columns change."}),"\n",(0,a.jsx)(n.li,{children:"Cannot be manually overridden; all values are derived from the expression."}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"example-expression",children:"Example"}),"\n",(0,a.jsx)(n.p,{children:"Assume you want a column that always concatenates the first and last name columns."}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Column: ",(0,a.jsx)(n.code,{children:"full_name"})]}),"\n",(0,a.jsxs)(n.li,{children:["Type: ",(0,a.jsx)(n.code,{children:"GENERATED ALWAYS AS"})]}),"\n",(0,a.jsxs)(n.li,{children:["Expression: ",(0,a.jsx)(n.code,{children:"first_name || ' ' || last_name"})]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["This ensures that ",(0,a.jsx)(n.code,{children:"full_name"})," will always reflect the ",(0,a.jsx)(n.code,{children:"first_name"})," and ",(0,a.jsx)(n.code,{children:"last_name"}),". It cannot be manually changed."]}),"\n",(0,a.jsx)(n.h2,{id:"define-generated-columns",children:"Define generated columns"}),"\n",(0,a.jsx)(n.p,{children:"To define a column as an IDENTITY column in a new target table:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Add a new Target gem to your pipeline canvas."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["In the ",(0,a.jsx)(n.strong,{children:"Type"})," tab, select HANA as the target type."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["In the ",(0,a.jsx)(n.strong,{children:"Location"})," tab, configure the location where the new table is written."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["In the ",(0,a.jsx)(n.strong,{children:"Properties"})," tab, review the schema of the target table."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"To define a column as an IDENTITY column:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Click on the dropdown arrow that appears on column hover. This expands the column metadata options."}),"\n",(0,a.jsxs)(n.li,{children:["Select a generated column type from the ",(0,a.jsx)(n.strong,{children:"Type"})," dropdown."]}),"\n",(0,a.jsxs)(n.li,{children:["Provide a sequence parameter or expression in the ",(0,a.jsx)(n.strong,{children:"Always As"})," field."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Click ",(0,a.jsx)(n.strong,{children:"Save"})," to save your changes to the gem."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"When you run the gem, Prophecy recognizes the column as generated and lets SAP HANA handle value generation automatically."}),"\n",(0,a.jsxs)(n.p,{children:["If your pipeline includes a field matching a ",(0,a.jsx)(n.code,{children:"GENERATED ALWAYS AS IDENTITY"})," column, Prophecy automatically excludes it from insert operations to avoid conflicts with SAP HANA\u2019s internal sequence generation."]}),"\n",(0,a.jsxs)(n.p,{children:["For ",(0,a.jsx)(n.code,{children:"GENERATED BY DEFAULT AS IDENTITY"})," columns, Prophecy can insert values when they are explicitly provided in your dataset. Otherwise, SAP HANA automatically generates the value."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Hana table schema",src:s(31155).A+"",width:"3126",height:"1606"})}),"\n",(0,a.jsx)(n.h2,{id:"write-to-tables-with-generated-columns",children:"Write to tables with generated columns"}),"\n",(0,a.jsx)(n.p,{children:"If you write to a HANA table that already contains an IDENTITY column, the HANA Gem:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Automatically detects the column in your target table"}),"\n",(0,a.jsx)(n.li,{children:"Lets SAP HANA handle the auto-increment process"}),"\n"]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsx)(n.p,{children:"Prophecy does not label generated columns in metadata when the table originates from SAP HANA. This does not affect write behavior, but you might not catch that the column is generated."})}),"\n",(0,a.jsx)(n.h2,{id:"whats-next",children:"What's next"}),"\n",(0,a.jsxs)(n.p,{children:["For detailed information on functionality and constraints, see the ",(0,a.jsx)(n.code,{children:"<col_gen_as_expression>"})," and ",(0,a.jsx)(n.code,{children:"<col_gen_as_ident>"})," sections of the ",(0,a.jsx)(n.a,{href:"https://help.sap.com/docs/SAP_HANA_PLATFORM/4fe29514fd584807ac9f2a04f6754767/20d58a5f75191014b2fe92141b7df228.html",children:"CREATE TABLE Statement"})," page in the SAP HANA documentation."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);