"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[27701],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>m});var a=n(96540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=a.createContext({}),c=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(o.Provider,{value:t},e.children)},u="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),d=r,m=u["".concat(o,".").concat(d)]||u[d]||g[d]||i;return n?a.createElement(m,s(s({ref:t},p),{},{components:n})):a.createElement(m,s({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,s=new Array(i);s[0]=d;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l[u]="string"==typeof e?e:r,s[1]=l;for(var c=2;c<i;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},35304:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>g,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var a=n(58168),r=(n(96540),n(15680));const i={title:"Execution on Databricks",id:"executions_on_databricks_clusters",description:"Execution on Databricks clusters",sidebar_position:3,tags:["execution","interim","UnityCatalog","Shared","metrics","spark"]},s=void 0,l={unversionedId:"Spark/execution/executions_on_databricks_clusters",id:"Spark/execution/executions_on_databricks_clusters",title:"Execution on Databricks",description:"Execution on Databricks clusters",source:"@site/docs/Spark/execution/databricks-clusters-behaviours.md",sourceDirName:"Spark/execution",slug:"/Spark/execution/executions_on_databricks_clusters",permalink:"/Spark/execution/executions_on_databricks_clusters",draft:!1,tags:[{label:"execution",permalink:"/tags/execution"},{label:"interim",permalink:"/tags/interim"},{label:"UnityCatalog",permalink:"/tags/unity-catalog"},{label:"Shared",permalink:"/tags/shared"},{label:"metrics",permalink:"/tags/metrics"},{label:"spark",permalink:"/tags/spark"}],version:"current",sidebarPosition:3,frontMatter:{title:"Execution on Databricks",id:"executions_on_databricks_clusters",description:"Execution on Databricks clusters",sidebar_position:3,tags:["execution","interim","UnityCatalog","Shared","metrics","spark"]},sidebar:"defaultSidebar",previous:{title:"Execution Metrics",permalink:"/Spark/execution/execution-metrics"},next:{title:"Execution on Livy",permalink:"/Spark/execution/executions_on_livy_clusters"}},o={},c=[{value:"Cluster Types",id:"cluster-types",level:2},{value:"Interims",id:"interims",level:2},{value:"Regular Interims",id:"regular-interims",level:3},{value:"Vanilla Interims",id:"vanilla-interims",level:3},{value:"Execution Metrics",id:"execution-metrics",level:2}],p={toc:c},u="wrapper";function g(e){let{components:t,...i}=e;return(0,r.yg)(u,(0,a.A)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h2",{id:"cluster-types"},"Cluster Types"),(0,r.yg)("p",null,"Databricks clusters comes with various ",(0,r.yg)("a",{parentName:"p",href:"https://docs.databricks.com/clusters/create-cluster.html#what-is-cluster-access-mode"},"Access Modes"),"."),(0,r.yg)("p",null,"For ",(0,r.yg)("a",{parentName:"p",href:"https://docs.prophecy.io/Spark/execution/interactive-execution#interims"},"Interims")," and ",(0,r.yg)("a",{parentName:"p",href:"./execution-metrics"},"Execution Metrics")," to work, Prophecy has written some libraries in Python and Scala, which needs to be installed on the cluster. Hence, because of below restrictions, interims behaviour will be different for different clusters."),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Access mode dropdown"),(0,r.yg)("th",{parentName:"tr",align:null},"Library Installations Allowed?"),(0,r.yg)("th",{parentName:"tr",align:null},"Language supported"),(0,r.yg)("th",{parentName:"tr",align:null},"Interims"),(0,r.yg)("th",{parentName:"tr",align:null},"Execution Metrics"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Single User"),(0,r.yg)("td",{parentName:"tr",align:null},"Yes"),(0,r.yg)("td",{parentName:"tr",align:null},"Python, Scala"),(0,r.yg)("td",{parentName:"tr",align:null},"Regular Interims"),(0,r.yg)("td",{parentName:"tr",align:null},"Yes")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Shared"),(0,r.yg)("td",{parentName:"tr",align:null},"Yes, but interim nodes cant be attached"),(0,r.yg)("td",{parentName:"tr",align:null},"Python"),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("strong",{parentName:"td"},"Vanilla Interims")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("strong",{parentName:"td"},"No"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"No isolation shared"),(0,r.yg)("td",{parentName:"tr",align:null},"Yes"),(0,r.yg)("td",{parentName:"tr",align:null},"Python, Scala"),(0,r.yg)("td",{parentName:"tr",align:null},"Regular Interims"),(0,r.yg)("td",{parentName:"tr",align:null},"Yes")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Unity Catalog Single User"),(0,r.yg)("td",{parentName:"tr",align:null},"Yes"),(0,r.yg)("td",{parentName:"tr",align:null},"Python, Scala"),(0,r.yg)("td",{parentName:"tr",align:null},"Regular Interims"),(0,r.yg)("td",{parentName:"tr",align:null},"Yes")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Unity Catalog Shared"),(0,r.yg)("td",{parentName:"tr",align:null},"No"),(0,r.yg)("td",{parentName:"tr",align:null},"Python"),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("strong",{parentName:"td"},"Vanilla Interims")),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("strong",{parentName:"td"},"No"))))),(0,r.yg)("h2",{id:"interims"},"Interims"),(0,r.yg)("p",null,"During development, often the user will want to see their data to make more sense of it and to check whether the expected output is getting\ngenerated or not after the transformation. Prophecy generates these data samples as ",(0,r.yg)("inlineCode",{parentName:"p"},"Interims"),", which are temporarily cached previews of data after each Gem.\nTo check more about interims, please refer ",(0,r.yg)("a",{parentName:"p",href:"https://docs.prophecy.io/Spark/execution/interactive-execution#interims"},"here"),"."),(0,r.yg)("p",null,"Depending on the type of clusters, we have two modes of Interims"),(0,r.yg)("h3",{id:"regular-interims"},"Regular Interims"),(0,r.yg)("p",null,"For ",(0,r.yg)("inlineCode",{parentName:"p"},"Single User")," clusters, and ",(0,r.yg)("inlineCode",{parentName:"p"},"No isolation Shared")," clusters, we have interims available after each Gem of Pipeline. These are available on both Unity and Non Unity catalog workspaces."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Regular Interims",src:n(49861).A,width:"1664",height:"930"})),(0,r.yg)("h3",{id:"vanilla-interims"},"Vanilla Interims"),(0,r.yg)("p",null,"For ",(0,r.yg)("inlineCode",{parentName:"p"},"Shared mode")," clusters, we have added interims on all Tail nodes of the Pipeline.\nThese interims will come Just before Target Gems, and if there is no Target Gem, then as a dangling edge after last Gem. Please see below images for the same."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Vanilla Interims",src:n(27170).A,width:"1673",height:"938"})),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Vanilla Interims",src:n(75139).A,width:"1670",height:"931"})),(0,r.yg)("h2",{id:"execution-metrics"},"Execution Metrics"),(0,r.yg)("p",null,"When running Pipelines and Jobs, you may be interested to know few metrics related to execution like records\nread/written, bytes read/written, total time taken and Data samples b/w components. These Dataset, Pipeline-run and\nJob-run related metrics are accumulated and stored on your data plane and can be viewed later from Prophecy UI. For more details please refer ",(0,r.yg)("a",{parentName:"p",href:"./execution-metrics"},"here")),(0,r.yg)("admonition",{type:"warning"},(0,r.yg)("p",{parentName:"admonition"},"These metrics are ",(0,r.yg)("strong",{parentName:"p"},"not available")," for ",(0,r.yg)("inlineCode",{parentName:"p"},"Shared mode")," clusters(Both normal workspaces and Unity catalog workspaces). You should see a proper error when trying to get historical runs of Pipelines/Jobs executed on ",(0,r.yg)("inlineCode",{parentName:"p"},"Shared mode")," clusters.")),(0,r.yg)("p",null,"Please refer below images for Execution Metrics on Pipelines page."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Pipeline_Execution_Metrics",src:n(94626).A,width:"1727",height:"970"})),(0,r.yg)("p",null,"Each row here is one run of the Pipeline. You can click and go to a particular run and see the interims for that run or metrics like Rows read/written, time taken etc"),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Execution_Metrics",src:n(44010).A,width:"1669",height:"965"})),(0,r.yg)("p",null,"You can also see Execution Metrics for each Dataset in the Pipeline."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Dataset_metrcis",src:n(80477).A,width:"1670",height:"749"})),(0,r.yg)("p",null,"Each row here is one run where this Dataset was used. You can click and go to a particular run and see more detailed insights on your data along with preview."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Dataset_stats",src:n(17591).A,width:"1530",height:"886"})),(0,r.yg)("admonition",{type:"info"},(0,r.yg)("p",{parentName:"admonition"},"When using ",(0,r.yg)("inlineCode",{parentName:"p"},"High Concurrency")," or ",(0,r.yg)("inlineCode",{parentName:"p"},"Shared Mode")," Databricks Clusters you may notice a delay when running the first command, or when your cluster is scaling up to meet demand. This delay is due to Prophecy and Pipeline dependencies (Maven or Python packages) being installed. For the best performance, it is recommended that you cache packages in an Artifactory or on DBFS. Please ",(0,r.yg)("a",{parentName:"p",href:"https://help.prophecy.io/support/tickets/new"},"contact us")," to learn more about this.")))}g.isMDXComponent=!0},44010:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/ExecutionMetrics-06b0960ab08c45f832470523aefda3a6.png"},27170:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/SharedModeInterims-3005a6d15ddb02323a435d2595ceb8e1.png"},49861:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/SingleModeInterims-8ed0e1dd70211fec2c25756ba37f7b32.png"},17591:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/dataset-statistics-c2b3edf73209d1d054f2035cd6e2cc03.png"},80477:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/execution-metrcis-dataset1-0b8affae519ccc1b35e918a4621e56b4.png"},94626:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/execution-metrics-pipeline-5df685b641bb99e5b0bf0fcba5b884b6.png"},75139:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/vanillaInterims2-281e358b15a276f6d29d85d457364f90.png"}}]);