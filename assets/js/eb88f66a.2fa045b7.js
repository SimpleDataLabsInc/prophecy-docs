"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[61365],{15680:(e,r,t)=>{t.d(r,{xA:()=>p,yg:()=>d});var n=t(96540);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function s(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function o(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?s(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function i(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=n.createContext({}),c=function(e){var r=n.useContext(l),t=r;return e&&(t="function"==typeof e?e(r):o(o({},r),e)),t},p=function(e){var r=c(e.components);return n.createElement(l.Provider,{value:r},e.children)},u="mdxType",g={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},y=n.forwardRef((function(e,r){var t=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=c(t),y=a,d=u["".concat(l,".").concat(y)]||u[y]||g[y]||s;return t?n.createElement(d,o(o({ref:r},p),{},{components:t})):n.createElement(d,o({ref:r},p))}));function d(e,r){var t=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var s=t.length,o=new Array(s);o[0]=y;var i={};for(var l in r)hasOwnProperty.call(r,l)&&(i[l]=r[l]);i.originalType=e,i[u]="string"==typeof e?e:a,o[1]=i;for(var c=2;c<s;c++)o[c]=t[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,t)}y.displayName="MDXCreateElement"},11906:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>l,contentTitle:()=>o,default:()=>g,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var n=t(58168),a=(t(96540),t(15680));const s={title:"Amazon EMR Serverless",id:"EMR-serverless-fabric-configuration",description:"Configuring the EMR Serverless Fabric",sidebar_position:5,tags:["deployment","fabric","emr","serverless"]},o=void 0,i={unversionedId:"Spark/fabrics/EMR-serverless-fabric-configuration",id:"Spark/fabrics/EMR-serverless-fabric-configuration",title:"Amazon EMR Serverless",description:"Configuring the EMR Serverless Fabric",source:"@site/docs/Spark/fabrics/emr-fabric-serverless.md",sourceDirName:"Spark/fabrics",slug:"/Spark/fabrics/EMR-serverless-fabric-configuration",permalink:"/Spark/fabrics/EMR-serverless-fabric-configuration",draft:!1,tags:[{label:"deployment",permalink:"/tags/deployment"},{label:"fabric",permalink:"/tags/fabric"},{label:"emr",permalink:"/tags/emr"},{label:"serverless",permalink:"/tags/serverless"}],version:"current",sidebarPosition:5,frontMatter:{title:"Amazon EMR Serverless",id:"EMR-serverless-fabric-configuration",description:"Configuring the EMR Serverless Fabric",sidebar_position:5,tags:["deployment","fabric","emr","serverless"]},sidebar:"defaultSidebar",previous:{title:"Amazon EMR",permalink:"/Spark/fabrics/EMR-fabric-configuration"},next:{title:"Amazon EMR with Apache Livy",permalink:"/Spark/fabrics/EMR-livy-installation-guide"}},l={},c=[{value:"Create Amazon EMR Serverless cluster with Apache Livy",id:"create-amazon-emr-serverless-cluster-with-apache-livy",level:2},{value:"Allow network connectivity between Amazon EMR Serverless and Prophecy",id:"allow-network-connectivity-between-amazon-emr-serverless-and-prophecy",level:3},{value:"Create a Fabric to connect Prophecy to EMR Serverless",id:"create-a-fabric-to-connect-prophecy-to-emr-serverless",level:2}],p={toc:c},u="wrapper";function g(e){let{components:r,...s}=e;return(0,a.yg)(u,(0,n.A)({},p,s,{components:r,mdxType:"MDXLayout"}),(0,a.yg)("p",null,"In the context of Spark execution engines, you have the flexibility to opt for Amazon EMR Serverless. This guide offers step-by-step instructions on creating a Fabric that enables seamless connectivity to the EMR Serverless environment."),(0,a.yg)("h2",{id:"create-amazon-emr-serverless-cluster-with-apache-livy"},"Create Amazon EMR Serverless cluster with Apache Livy"),(0,a.yg)("p",null,"Navigate to Amazon EMR Serverless service and create a cluster. Under ",(0,a.yg)("strong",{parentName:"p"},"Application bundle")," select ",(0,a.yg)("strong",{parentName:"p"},"Custom"),"."),(0,a.yg)("p",null,"Choose appropriate applications to include in your installation. At a minimum, make sure sure ",(0,a.yg)("strong",{parentName:"p"},"Livy")," and ",(0,a.yg)("strong",{parentName:"p"},"Spark")," are included in the install."),(0,a.yg)("img",{src:t(91552).A,alt:"EMR Serverless create cluster",width:"75%"}),(0,a.yg)("h3",{id:"allow-network-connectivity-between-amazon-emr-serverless-and-prophecy"},"Allow network connectivity between Amazon EMR Serverless and Prophecy"),(0,a.yg)("p",null,"To configure the necessary network settings for seamless integration, specific modifications to the security groups of your EMR Serverless cluster are required. Follow the instructions outlined below:\nIf you intend to utilize Prophecy as a SaaS (Software as a Service) solution, note that the Prophecy public IP is ",(0,a.yg)("inlineCode",{parentName:"p"},"3.133.35.237"),". Ensure that the Core security group's outbound rule allows connections to this IP address."),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Modify the ",(0,a.yg)("strong",{parentName:"li"},"Primary Node")," security group:",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Allow incoming connections to port ",(0,a.yg)("inlineCode",{parentName:"li"},"8998")," from the Prophecy IP."),(0,a.yg)("li",{parentName:"ul"},"This can be achieved by adding an inbound rule to the Master security group that permits incoming traffic on port ",(0,a.yg)("inlineCode",{parentName:"li"},"8998")," from the Prophecy IP address."))),(0,a.yg)("li",{parentName:"ol"},"Modify the ",(0,a.yg)("strong",{parentName:"li"},"Core Node")," security group:",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Allow outgoing connections to the Prophecy public IP over HTTPS."),(0,a.yg)("li",{parentName:"ul"},"To enable this, add an outbound rule to the Core security group that allows outgoing traffic over HTTPS protocol to the Prophecy public IP.")))),(0,a.yg)("p",null,"By implementing these adjustments to your EMR Serverless cluster's security groups, you will establish the necessary network configuration for effective integration with Prophecy."),(0,a.yg)("h2",{id:"create-a-fabric-to-connect-prophecy-to-emr-serverless"},"Create a Fabric to connect Prophecy to EMR Serverless"),(0,a.yg)("p",null,"Navigate to Prophecy's UI and click on ",(0,a.yg)("strong",{parentName:"p"},"Create Fabric"),". The Fabric will establish a connection with your EMR Serverless cluster and use it as the execution engine for your Pipelines."),(0,a.yg)("img",{src:t(17439).A,alt:"EMR Serverless create Fabric",width:"75%"}),(0,a.yg)("br",null),(0,a.yg)("br",null),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Name")," your EMR Serverless Fabric and click on ",(0,a.yg)("strong",{parentName:"p"},"Continue"),"."),(0,a.yg)("br",null),(0,a.yg)("br",null),(0,a.yg)("img",{src:t(42849).A,alt:"EMR Serverless Fabric name",width:"80%"}),(0,a.yg)("p",null,"Choose ",(0,a.yg)("strong",{parentName:"p"},"EMR")," as your ",(0,a.yg)("strong",{parentName:"p"},"Provider"),". At this point, there is no distinction between creating an EMR and an EMR Serverless Fabric."),(0,a.yg)("img",{src:t(95751).A,alt:"EMR Serverless Provider",width:"75%"}),(0,a.yg)("p",null,"Before proceeding, it is crucial to ensure that all the required settings are properly configured. If you are uncertain about the necessary configurations, we recommend reaching out to your cloud infrastructure team for additional guidance and assistance. They will be able to provide you with the specific information and support needed to ensure a successful setup."),(0,a.yg)("p",null,"Enter your AWS credentials under ",(0,a.yg)("strong",{parentName:"p"},"Access Key")," and ",(0,a.yg)("strong",{parentName:"p"},"Secret Key"),". Choose the ",(0,a.yg)("strong",{parentName:"p"},"Region")," that your EMR Serverless cluster is running in."),(0,a.yg)("p",null,"Click on ",(0,a.yg)("strong",{parentName:"p"},"Fetch environments"),"."),(0,a.yg)("img",{src:t(30839).A,alt:"EMR Serverless cred",width:"75%"}),(0,a.yg)("p",null,"Select your EMR Serverless cluster that you would like to connect to under ",(0,a.yg)("strong",{parentName:"p"},"Spark Environment"),". The EMR cluster listing also shows Serverless clusters. From the list of active clusters, you can identify your EMR Serverless cluster by finding ",(0,a.yg)("inlineCode",{parentName:"p"},"emr-serverless-services")," within the Livy URL."),(0,a.yg)("img",{src:t(99978).A,alt:"EMR Serverless select",width:"80%"}),(0,a.yg)("p",null,"Most of the fields should be automatically populated after selecting a EMR Serverless cluster."),(0,a.yg)("p",null,"For the Authentication type, select ",(0,a.yg)("inlineCode",{parentName:"p"},"AWS Sig V4"),". This is the only option that will work for EMR Serverless."),(0,a.yg)("img",{src:t(75073).A,alt:"EMR Serverless Authentication type",width:"50%"}),(0,a.yg)("p",null,"Select your Runtime Role. The role must have enough permissions to use the selected Serverless App."),(0,a.yg)("img",{src:t(2293).A,alt:"EMR Serverless Runtime Role",width:"75%"}),(0,a.yg)("p",null,"Enter the S3 path that points to the location where you would like your logs and Pipeline artifacts to persist."),(0,a.yg)("img",{src:t(45765).A,alt:"EMR Serverless dependencies",width:"80%"}),(0,a.yg)("p",null,"Add the Job size to your environment by clicking on ",(0,a.yg)("strong",{parentName:"p"},"Add Job Size"),". Configure your Job size and click on ",(0,a.yg)("strong",{parentName:"p"},"Add"),"."),(0,a.yg)("img",{src:t(16421).A,alt:"EMR Job size",width:"49%"}),(0,a.yg)("p",null,"Configure the Prophecy Library:"),(0,a.yg)("admonition",{type:"note"},(0,a.yg)("p",{parentName:"admonition"},"The Spark Version and Scala Version are fixed.")),(0,a.yg)("p",null,"Select ",(0,a.yg)("strong",{parentName:"p"},"File System")," under ",(0,a.yg)("strong",{parentName:"p"},"Scala Resolution mode")," and provide the following path:"),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"s3://prophecy-public-bucket/prophecy-libs")),(0,a.yg)("p",null,"Select ",(0,a.yg)("strong",{parentName:"p"},"File System")," under ",(0,a.yg)("strong",{parentName:"p"},"Python Resolution mode")," and provide the following path:"),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"s3://prophecy-public-bucket/python-prophecy-libs")),(0,a.yg)("img",{src:t(74806).A,alt:"EMR Serverless Library",width:"78%"}),(0,a.yg)("p",null,"Click on ",(0,a.yg)("strong",{parentName:"p"},"Complete")," and your EMR Serverless Fabric is ready!"),(0,a.yg)("p",null,"Run a simple Pipeline and make sure that the interim returns data properly."))}g.isMDXComponent=!0},16421:(e,r,t)=>{t.d(r,{A:()=>n});const n=t.p+"assets/images/configure-j-ob-size-058d3dded50c8ba323719d7d822fa8c1.png"},17439:(e,r,t)=>{t.d(r,{A:()=>n});const n=t.p+"assets/images/create-entity-emr-57b7756db750041a330241e5ab066db9.png"},30839:(e,r,t)=>{t.d(r,{A:()=>n});const n=t.p+"assets/images/emr-aws-cred-4ddff8da9c69baadeea2ad16c60ceeab.png"},95751:(e,r,t)=>{t.d(r,{A:()=>n});const n=t.p+"assets/images/emr-f-abric-f799ef07acc31566f38c945f82e788e7.png"},75073:(e,r,t)=>{t.d(r,{A:()=>n});const n=t.p+"assets/images/emr-serverless-auth-type-6649de1c04cf6835f31e3e1cfe730564.png"},99978:(e,r,t)=>{t.d(r,{A:()=>n});const n=t.p+"assets/images/emr-serverless-dev-select-6519ad3a861079c485acfa293c0b2cf8.png"},45765:(e,r,t)=>{t.d(r,{A:()=>n});const n=t.p+"assets/images/emr-serverless-environment-fac25183271713a2fb6d9b5dd9e9ae69.png"},2293:(e,r,t)=>{t.d(r,{A:()=>n});const n=t.p+"assets/images/emr-serverless-runtime-role-7890497455a1d9dfa26b03c4f9f51a85.png"},74806:(e,r,t)=>{t.d(r,{A:()=>n});const n=t.p+"assets/images/emr-serverless-sizes-and-libraries-dc0db1ac9b235473d3206b1de62f9715.png"},91552:(e,r,t)=>{t.d(r,{A:()=>n});const n=t.p+"assets/images/livy-938a5bcdafa0b6d505604595152d0433.png"},42849:(e,r,t)=>{t.d(r,{A:()=>n});const n=t.p+"assets/images/name-emr-serverless-8f2977d7537251e3c5436b9dd87f5220.png"}}]);