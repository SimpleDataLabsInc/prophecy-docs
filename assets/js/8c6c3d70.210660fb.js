"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[21669],{28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>d});var t=s(96540);const i={},r=t.createContext(i);function l(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(r.Provider,{value:n},e.children)}},97137:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"analysts/development/gems/prepare/generate-rows","title":"GenerateRows gem","description":"Create new rows of data using iterative expressions","source":"@site/docs/analysts/development/gems/prepare/generate-rows.md","sourceDirName":"analysts/development/gems/prepare","slug":"/analysts/generate-rows","permalink":"/analysts/generate-rows","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"gems","permalink":"/tags/gems"},{"inline":true,"label":"analyst","permalink":"/tags/analyst"},{"inline":true,"label":"prepare","permalink":"/tags/prepare"}],"version":"current","frontMatter":{"title":"GenerateRows gem","sidebar_label":"GenerateRows","id":"generate-rows","slug":"/analysts/generate-rows","description":"Create new rows of data using iterative expressions","tags":["gems","analyst","prepare"]},"sidebar":"platformSidebar","previous":{"title":"Deduplicate","permalink":"/analysts/deduplicate"},"next":{"title":"Filter","permalink":"/analysts/filter"}}');var i=s(74848),r=s(28453);const l={title:"GenerateRows gem",sidebar_label:"GenerateRows",id:"generate-rows",slug:"/analysts/generate-rows",description:"Create new rows of data using iterative expressions",tags:["gems","analyst","prepare"]},d=void 0,o={},a=[{value:"Input and Output",id:"input-and-output",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Expression examples",id:"expression-examples",level:3},{value:"Initialization expression examples",id:"initialization-expression-examples",level:4},{value:"Condition expression examples",id:"condition-expression-examples",level:4},{value:"Loop expression examples",id:"loop-expression-examples",level:4},{value:"Gem examples",id:"gem-examples",level:2},{value:"Create sequence",id:"create-sequence",level:3},{value:"Increment dates",id:"increment-dates",level:3},{value:"Leverage input data",id:"leverage-input-data",level:3}];function c(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"The GenerateRows gem creates new rows of data at the record level using iterative expressions. This gem generates sequences of numbers, dates, or other values based on initialization, condition, and loop expressions."}),"\n",(0,i.jsx)(n.p,{children:"The gem follows a three-step process to create rows:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Initialization Expression"}),": Sets the starting value for the first row."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Condition Expression"}),": Defines when to stop generating rows (true/false condition)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Loop Expression"}),": Specifies how values change between iterations."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The gem continues generating rows until the condition expression evaluates to false, at which point the generation process terminates."}),"\n",(0,i.jsx)(n.h2,{id:"input-and-output",children:"Input and Output"}),"\n",(0,i.jsx)(n.p,{children:"The GenerateRows gem accepts optional input data and produces one output dataset containing the generated rows."}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Port"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"in0"})}),(0,i.jsxs)(n.td,{children:["Optional input dataset. Columns from this dataset can be referenced in the gem expressions. ",(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"If an input dataset is provided, the gem generates a separate sequence of rows for each input row. "}),(0,i.jsx)("li",{children:"If no input is provided, the gem generates a single sequence."})]})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"out"})}),(0,i.jsxs)(n.td,{children:["Output dataset containing: ",(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"All original input columns (if input is provided)"}),(0,i.jsx)("li",{children:"The new generated column with values created by the iterative expressions"})]})," Each input row may produce multiple output rows depending on the loop and condition expressions."]})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsx)(n.p,{children:"Configure the GenerateRows gem using the following parameters."}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Choose output column name"}),(0,i.jsx)(n.td,{children:"Name of the column that will contain the generated values. Each generated value in this column corresponds to one row created by the gem\u2019s iterative process."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Configure row generation strategy"}),(0,i.jsxs)(n.td,{children:["SQL logic for generating rows using three expressions: ",(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:[(0,i.jsx)(n.strong,{children:"Initialization expression"}),": Sets the starting value for the generation process. This is the value of the first generated row."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)(n.strong,{children:"Condition expression"}),": Determines how long to continue generating rows. Rows are added while this expression evaluates to true. Can reference input columns or the output column value."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)(n.strong,{children:"Loop expression (usually incremental)"}),": Specifies how the generated value changes each iteration. Typically an increment, but can be any expression that modifies the output column value."]})]})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Max rows per iteration"}),(0,i.jsxs)(n.td,{children:["Maximum number of rows generated per sequence. This limit prevents infinite loops or excessive memory usage. ",(0,i.jsx)("br",{}),(0,i.jsx)(n.strong,{children:"Default"}),": 100,000 rows."]})]})]})]}),"\n",(0,i.jsxs)(n.admonition,{title:"Reference Columns",type:"info",children:[(0,i.jsxs)(n.p,{children:["To reference input columns in the ",(0,i.jsx)(n.strong,{children:"Condition expression"})," and ",(0,i.jsx)(n.strong,{children:"Loop expression"})," fields, you must use the following format:"]}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"payload.<columnName>"})})]}),"\n",(0,i.jsx)(n.h3,{id:"expression-examples",children:"Expression examples"}),"\n",(0,i.jsx)(n.p,{children:"Reference the following examples to understand how to build different expressions for this gem. All expressions must be valid SQL. To reference the iterative value, use the output column name you defined."}),"\n",(0,i.jsx)(n.h4,{id:"initialization-expression-examples",children:"Initialization expression examples"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Expression"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"1"})}),(0,i.jsx)(n.td,{children:"Start with the number 1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"StartDate"})}),(0,i.jsxs)(n.td,{children:["Use a value from an input column named ",(0,i.jsx)(n.code,{children:"StartDate"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"CURRENT_DATE()"})}),(0,i.jsx)(n.td,{children:"Start with today's date"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"condition-expression-examples",children:"Condition expression examples"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Expression"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"value <= 10"})}),(0,i.jsx)(n.td,{children:"Generate rows while value is less than or equal to 10"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"value < MaxValue"})}),(0,i.jsxs)(n.td,{children:["Continue until value reaches a maximum from input column named ",(0,i.jsx)(n.code,{children:"MaxValue"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"date <= EndDate"})}),(0,i.jsxs)(n.td,{children:["Generate dates until reaching an end date defined in an ",(0,i.jsx)(n.code,{children:"EndDate"})," column"]})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"loop-expression-examples",children:"Loop expression examples"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Expression"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"value + 1"})}),(0,i.jsx)(n.td,{children:"Increment by 1 each iteration"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"value + StepSize"})}),(0,i.jsxs)(n.td,{children:["Increment by a variable step size defined in the input column ",(0,i.jsx)(n.code,{children:"StepSize"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"date + INTERVAL 1 DAY"})}),(0,i.jsx)(n.td,{children:"Add one day for date sequences"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"gem-examples",children:"Gem examples"}),"\n",(0,i.jsx)(n.p,{children:"The following sections demonstrate different gem configurations and their corresponding outputs."}),"\n",(0,i.jsx)(n.h3,{id:"create-sequence",children:"Create sequence"}),"\n",(0,i.jsx)(n.p,{children:"Assume you need to create a sequence of numbers from 1 to 10 for testing purposes or to generate row IDs. You want to create a simple numeric sequence that can be used as a foundation for other data operations. Use the following configuration:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Input dataset"}),": none"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Choose output column name"}),": ",(0,i.jsx)(n.code,{children:"value"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Initialization expression"}),": ",(0,i.jsx)(n.code,{children:"1"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Condition expression"}),": ",(0,i.jsx)(n.code,{children:"value <= 10"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Loop expression (usually incremental)"}),": ",(0,i.jsx)(n.code,{children:"value + 1"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Max rows per iteration"}),": ",(0,i.jsx)(n.code,{children:"100"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"If no input table is present, the following output table is generated:"}),"\n",(0,i.jsx)("div",{class:"table-example",children:(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.th,{children:"value"})})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"1"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"2"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"3"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"4"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"5"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"6"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"7"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"8"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"9"})}),(0,i.jsx)(n.tr,{children:(0,i.jsx)(n.td,{children:"10"})})]})]})}),"\n",(0,i.jsxs)(n.p,{children:["The gem generates 10 rows with sequential values from 1 to 10. The process starts with the initialization value of 1, continues generating rows while the condition ",(0,i.jsx)(n.code,{children:"value <= 10"})," is true, and increments the value by 1 in each iteration."]}),"\n",(0,i.jsx)(n.h3,{id:"increment-dates",children:"Increment dates"}),"\n",(0,i.jsx)(n.p,{children:"Assume you want to generate a range of dates. To do so, you can use the following gem configuration:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Input dataset"}),": none"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Choose output column name"}),": ",(0,i.jsx)(n.code,{children:"date"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Initialization expression"}),": ",(0,i.jsx)(n.code,{children:"'2024-01-01'"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Condition expression"}),": ",(0,i.jsx)(n.code,{children:"date <= '2024-01-07'"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Loop expression (usually incremental)"}),": ",(0,i.jsx)(n.code,{children:"date + INTERVAL 1 DAY"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This would generate 7 rows with consecutive dates from January 1st through January 7th, 2024."}),"\n",(0,i.jsx)(n.h3,{id:"leverage-input-data",children:"Leverage input data"}),"\n",(0,i.jsxs)(n.p,{children:["Assume you have input data that you want to use to influence the expressions in the gem configuration. You might have the following input table called ",(0,i.jsx)(n.code,{children:"Constants"}),":"]}),"\n",(0,i.jsx)("div",{class:"table-example",children:(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"min_value"}),(0,i.jsx)(n.th,{children:"max_value"}),(0,i.jsx)(n.th,{children:"step_size"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"20"}),(0,i.jsx)(n.td,{children:"3"})]})})]})}),"\n",(0,i.jsx)(n.p,{children:"To leverage this table, you can use the following gem configuration:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Input dataset"}),": ",(0,i.jsx)(n.code,{children:"Constants"})," table"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Choose output column name"}),": ",(0,i.jsx)(n.code,{children:"sequence"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Initialization expression"}),": ",(0,i.jsx)(n.code,{children:"min_value"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Condition expression"}),": ",(0,i.jsx)(n.code,{children:"sequence <= max_value"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Loop expression (usually incremental)"}),": ",(0,i.jsx)(n.code,{children:"sequence + step_size"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This would produce the following output table:"}),"\n",(0,i.jsx)("div",{class:"table-example",children:(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"min_value"}),(0,i.jsx)(n.th,{children:"max_value"}),(0,i.jsx)(n.th,{children:"step_size"}),(0,i.jsx)(n.th,{children:"sequence"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"20"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"5"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"20"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"20"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"11"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"20"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"14"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"20"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"17"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"20"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"20"})]})]})]})}),"\n",(0,i.jsx)(n.p,{children:"The gem processes the input row and generates a sequence starting at 5, incrementing by 3, and continuing until reaching 20."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);