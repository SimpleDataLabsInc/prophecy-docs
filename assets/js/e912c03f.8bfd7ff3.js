"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[30162],{15680:(e,t,a)=>{a.d(t,{xA:()=>m,yg:()=>d});var n=a(96540);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function g(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=n.createContext({}),p=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},m=function(e){var t=p(e.components);return n.createElement(o.Provider,{value:t},e.children)},s="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},y=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,o=e.parentName,m=g(e,["components","mdxType","originalType","parentName"]),s=p(a),y=r,d=s["".concat(o,".").concat(y)]||s[y]||u[y]||l;return a?n.createElement(d,i(i({ref:t},m),{},{components:a})):n.createElement(d,i({ref:t},m))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=y;var g={};for(var o in t)hasOwnProperty.call(t,o)&&(g[o]=t[o]);g.originalType=e,g[s]="string"==typeof e?e:r,i[1]=g;for(var p=2;p<l;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}y.displayName="MDXCreateElement"},6314:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>g,toc:()=>p});var n=a(58168),r=(a(96540),a(15680));const l={title:"Gems",id:"gems",description:"Transform your data with Prophecy gems",sidebar_position:3,tags:["gems","source","target","search","infer schema"]},i=void 0,g={unversionedId:"concepts/project/gems",id:"concepts/project/gems",title:"Gems",description:"Transform your data with Prophecy gems",source:"@site/docs/concepts/project/gems.md",sourceDirName:"concepts/project",slug:"/concepts/project/gems",permalink:"/concepts/project/gems",draft:!1,tags:[{label:"gems",permalink:"/tags/gems"},{label:"source",permalink:"/tags/source"},{label:"target",permalink:"/tags/target"},{label:"search",permalink:"/tags/search"},{label:"infer schema",permalink:"/tags/infer-schema"}],version:"current",sidebarPosition:3,frontMatter:{title:"Gems",id:"gems",description:"Transform your data with Prophecy gems",sidebar_position:3,tags:["gems","source","target","search","infer schema"]},sidebar:"mySidebar",previous:{title:"Models",permalink:"/concepts/project/Model"},next:{title:"Datasets",permalink:"/concepts/project/dataset"}},o={},p=[{value:"Gem categories",id:"gem-categories",level:2},{value:"Gem instance",id:"gem-instance",level:2},{value:"Gem configuration",id:"gem-configuration",level:2},{value:"Input ports",id:"input-ports",level:2},{value:"Output ports",id:"output-ports",level:2},{value:"Gem phase",id:"gem-phase",level:2},{value:"What&#39;s next",id:"whats-next",level:2}],m={toc:p},s="wrapper";function u(e){let{components:t,...l}=e;return(0,r.yg)(s,(0,n.A)({},m,l,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"A gem is a reusable component or transformation step in a data pipeline that performs a certain operation on the data. Each gem has its own configuration and produces its own block of output code."),(0,r.yg)("h2",{id:"gem-categories"},"Gem categories"),(0,r.yg)("p",null,"Gems are grouped by their category. The table below will help you understand this grouping."),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Category"),(0,r.yg)("th",{parentName:"tr",align:null},"Definition"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Source/Target"),(0,r.yg)("td",{parentName:"tr",align:null},"Gems related to ",(0,r.yg)("a",{parentName:"td",href:"/Spark/gems/source-target/"},"sources, targets,")," and lookups.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Transform"),(0,r.yg)("td",{parentName:"tr",align:null},"Gems related to the ",(0,r.yg)("a",{parentName:"td",href:"/Spark/gems/transform/"},"transformation")," of your data.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Custom"),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("a",{parentName:"td",href:"/Spark/gems/custom/"},"Custom")," gems and gems that don't fit into the other categories.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Join/Split"),(0,r.yg)("td",{parentName:"tr",align:null},"Gems related to ",(0,r.yg)("a",{parentName:"td",href:"/Spark/gems/join-split/"},"splitting or joining")," datasets together.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Subgraph"),(0,r.yg)("td",{parentName:"tr",align:null},"Types of ",(0,r.yg)("a",{parentName:"td",href:"/Spark/gems/subgraph/"},"subgraphs")," to use in your pipeline.")))),(0,r.yg)("p",null,"When you open a pipeline, you will find that the ",(0,r.yg)("strong",{parentName:"p"},"gem drawer")," is organized by these categories. The gems in these categories are available to you depending on your project language, project dependencies, and Prophecy version."),(0,r.yg)("h2",{id:"gem-instance"},"Gem instance"),(0,r.yg)("p",null,"When you click on a gem from the gem drawer, an instance of that gem gets added to your pipeline canvas."),(0,r.yg)("p",null,"Use the image and the table below to understand the UI of a gem."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Gem Instance",src:a(69050).A,width:"2628",height:"1490"})),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"},"Callout"),(0,r.yg)("th",{parentName:"tr",align:null},"UI element"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"1"),(0,r.yg)("td",{parentName:"tr",align:null},"Gem instance name"),(0,r.yg)("td",{parentName:"tr",align:null},"The name of this particular gem instance. It must be unique within a given pipeline.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"2"),(0,r.yg)("td",{parentName:"tr",align:null},"Gem type name"),(0,r.yg)("td",{parentName:"tr",align:null},"The type of gem.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"3"),(0,r.yg)("td",{parentName:"tr",align:null},"Input ports"),(0,r.yg)("td",{parentName:"tr",align:null},"One or more ",(0,r.yg)("a",{parentName:"td",href:"#inputs"},"ports")," that accept connections from upstream gems.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"4"),(0,r.yg)("td",{parentName:"tr",align:null},"Output ports"),(0,r.yg)("td",{parentName:"tr",align:null},"One or more ",(0,r.yg)("a",{parentName:"td",href:"#outputs"},"ports")," that connect to downstream gems.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"5"),(0,r.yg)("td",{parentName:"tr",align:null},"Gem phase"),(0,r.yg)("td",{parentName:"tr",align:null},"The ",(0,r.yg)("a",{parentName:"td",href:"#gem-phase"},"phase")," for this gem instance, which defines the order in which gem instances are executed.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"6"),(0,r.yg)("td",{parentName:"tr",align:null},"Open"),(0,r.yg)("td",{parentName:"tr",align:null},"The button that lets you open the gem configuration.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"7"),(0,r.yg)("td",{parentName:"tr",align:null},"Run button"),(0,r.yg)("td",{parentName:"tr",align:null},"A button that runs the pipeline up to and including the gem.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"8"),(0,r.yg)("td",{parentName:"tr",align:null},"Action menu"),(0,r.yg)("td",{parentName:"tr",align:null},"A menu that includes options to change the ",(0,r.yg)("a",{parentName:"td",href:"#gem-phase"},"phase")," of the gem, add run conditions, delete the gem, and more.")))),(0,r.yg)("h2",{id:"gem-configuration"},"Gem configuration"),(0,r.yg)("p",null,"When you open a gem, you can configure how the gem will work."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Gem instance configuration",src:a(83103).A,width:"2620",height:"1508"})),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"}),(0,r.yg)("th",{parentName:"tr",align:null},"UI element"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"1"),(0,r.yg)("td",{parentName:"tr",align:null},"Gem instance name"),(0,r.yg)("td",{parentName:"tr",align:null},"The name of this particular gem instance.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"2"),(0,r.yg)("td",{parentName:"tr",align:null},"Inputs and outputs"),(0,r.yg)("td",{parentName:"tr",align:null},"The inputs and outputs for this gem instance.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"3"),(0,r.yg)("td",{parentName:"tr",align:null},"Gem configuration"),(0,r.yg)("td",{parentName:"tr",align:null},"The configuration for this instance. Each gem will be different. See the documentation for individual gems for more information.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"4"),(0,r.yg)("td",{parentName:"tr",align:null},"Run button"),(0,r.yg)("td",{parentName:"tr",align:null},"A button that runs the pipeline up to and including the gem.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"5"),(0,r.yg)("td",{parentName:"tr",align:null},"Diagnostics"),(0,r.yg)("td",{parentName:"tr",align:null},"A diagnostics window that will show a list of configuration errors if they exist.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"6"),(0,r.yg)("td",{parentName:"tr",align:null},"Data"),(0,r.yg)("td",{parentName:"tr",align:null},"A preview of the output table that is available if you run the gem.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"7"),(0,r.yg)("td",{parentName:"tr",align:null},"Unit tests"),(0,r.yg)("td",{parentName:"tr",align:null},"A set of unit tests. See ",(0,r.yg)("a",{parentName:"td",href:"/ci-cd/tests"},"here")," for more details.")))),(0,r.yg)("h2",{id:"input-ports"},"Input ports"),(0,r.yg)("p",null,"The Input tab defines the incoming connections accepted by the gem. Most gem types only accept one connection, but some (such as ",(0,r.yg)("a",{parentName:"p",href:"/Spark/gems/join-split/join"},"Join"),") allow for multiple inputs."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Input UI",src:a(72404).A,width:"2620",height:"1352"})),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"}),(0,r.yg)("th",{parentName:"tr",align:null},"UI element"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"1"),(0,r.yg)("td",{parentName:"tr",align:null},"Search"),(0,r.yg)("td",{parentName:"tr",align:null},"A field that will filter your input columns.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"2"),(0,r.yg)("td",{parentName:"tr",align:null},"Add Input"),(0,r.yg)("td",{parentName:"tr",align:null},"If the gem supports multiple inputs, you can click this button to add more input ports to this instance.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"3"),(0,r.yg)("td",{parentName:"tr",align:null},"Input"),(0,r.yg)("td",{parentName:"tr",align:null},"The name of the input port and the name of the input gem instance.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"4"),(0,r.yg)("td",{parentName:"tr",align:null},"Port schema"),(0,r.yg)("td",{parentName:"tr",align:null},"The schema of the port (columns and column types). The schema will only appear when an input port is present.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"5"),(0,r.yg)("td",{parentName:"tr",align:null},"Edit ports"),(0,r.yg)("td",{parentName:"tr",align:null},"A button that lets you edit or delete ports.")))),(0,r.yg)("h2",{id:"output-ports"},"Output ports"),(0,r.yg)("p",null,"The Output tab defines the outgoing schemas that will be available to downstream gems. In some cases, the Prophecy compiler can't infer the output schema automatically, so you have the option to infer the schema using your connected fabric or specify it manually."),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:"center"}),(0,r.yg)("th",{parentName:"tr",align:null},"UI element"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"1"),(0,r.yg)("td",{parentName:"tr",align:null},"Output schema"),(0,r.yg)("td",{parentName:"tr",align:null},"Output schema for this gem instance. This will be the schema of the data that downstream gem instances will use")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"2"),(0,r.yg)("td",{parentName:"tr",align:null},"Custom schema"),(0,r.yg)("td",{parentName:"tr",align:null},"Toggle this to enable custom output schema editing")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"3"),(0,r.yg)("td",{parentName:"tr",align:null},"Infer from cluster"),(0,r.yg)("td",{parentName:"tr",align:null},"Run the gem code on the connected cluster and infer the schema from the result")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:"center"},"4"),(0,r.yg)("td",{parentName:"tr",align:null},"Edit schema"),(0,r.yg)("td",{parentName:"tr",align:null},"Edit the output schema manually")))),(0,r.yg)("h2",{id:"gem-phase"},"Gem phase"),(0,r.yg)("p",null,"A gem's phase in a pipeline controls the order in which a gem will run. This is achieved by reordering the code generated for the pipeline:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-scala"},"def apply(spark: SparkSession): Unit = {\n  val df_my_orders     = my_orders(spark).cache()\n  val df_Repartition_1 = Repartition_1(spark, df_my_orders)\n  Write_CSV(spark, df_Repartition_1)\n  val df_SchemaTransform_1 = SchemaTransform_1(spark, df_my_orders)\n}\n")),(0,r.yg)("p",null,"A gem with phase ",(0,r.yg)("inlineCode",{parentName:"p"},"0")," will be put before a gem with phase ",(0,r.yg)("inlineCode",{parentName:"p"},"1"),". The phase can be any integer (positive or negative)."),(0,r.yg)("p",null,"It's important to note that when you run downstream gems, ",(0,r.yg)("strong",{parentName:"p"},"their upstream gems also must run"),". Therefore, if a downstream gem is assigned phase ",(0,r.yg)("inlineCode",{parentName:"p"},"0")," and an upstream gem is assigned phase ",(0,r.yg)("inlineCode",{parentName:"p"},"1"),", the upstream gem will be grouped with phase ",(0,r.yg)("inlineCode",{parentName:"p"},"0"),". Because of this, you might have to pay extra attention when assigning phases to intermediate gems."),(0,r.yg)("h2",{id:"whats-next"},"What's next"),(0,r.yg)("p",null,"Prophecy provides specific Spark gems and SQL gems for your pipelines and models. Not only does Prophecy add new gems for your use, but you can also create gems yourself. To learn more, visit our documentation on ",(0,r.yg)("a",{parentName:"p",href:"/Spark/gems"},"Spark gems")," and ",(0,r.yg)("a",{parentName:"p",href:"/SQL/gems"},"SQL gems"),"."))}u.isMDXComponent=!0},72404:(e,t,a)=>{a.d(t,{A:()=>n});const n=a.p+"assets/images/inputs-57a290a2b7434199ea908a36c7bb3f43.png"},69050:(e,t,a)=>{a.d(t,{A:()=>n});const n=a.p+"assets/images/instance-095306c75e37bf6d7858b5783ba65e17.png"},83103:(e,t,a)=>{a.d(t,{A:()=>n});const n=a.p+"assets/images/instance_open-7d8e7317c021c7788b3dd171b9f1818b.png"}}]);