"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[77467],{28453:(i,e,t)=>{t.d(e,{R:()=>r,x:()=>o});var a=t(96540);const n={},s=a.createContext(n);function r(i){const e=a.useContext(s);return a.useMemo(function(){return"function"==typeof i?i(e):{...e,...i}},[e,i])}function o(i){let e;return e=i.disableParentContext?"function"==typeof i.components?i.components(n):i.components||n:r(i.components),a.createElement(s.Provider,{value:e},i.children)}},62619:(i,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"administration/fabrics/Spark-fabrics/databricks/whitelist-plibs","title":"Add Prophecy libraries to allowlist for UC standard clusters","description":"Make ProphecyLibs available to Databricks UC standard clusters","source":"@site/docs/administration/fabrics/Spark-fabrics/databricks/whitelist-plibs.md","sourceDirName":"administration/fabrics/Spark-fabrics/databricks","slug":"/admin/dbx-whitelist-plibs","permalink":"/admin/dbx-whitelist-plibs","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"unity catalog","permalink":"/tags/unity-catalog"},{"inline":true,"label":"databricks","permalink":"/tags/databricks"},{"inline":true,"label":"plibs","permalink":"/tags/plibs"}],"version":"current","frontMatter":{"title":"Add Prophecy libraries to allowlist for UC standard clusters","sidebar_label":"Allowlist ProphecyLibs","id":"whitelist-plibs","slug":"/admin/dbx-whitelist-plibs","description":"Make ProphecyLibs available to Databricks UC standard clusters","tags":["unity catalog","databricks","plibs"]},"sidebar":"adminSidebar","previous":{"title":"Databricks policies","permalink":"/administration/fabrics/Spark-fabrics/databricks/databricks-policies"},"next":{"title":"ProphecyLibs in volumes","permalink":"/admin/dbx-volumes-plibs"}}');var n=t(74848),s=t(28453);const r={title:"Add Prophecy libraries to allowlist for UC standard clusters",sidebar_label:"Allowlist ProphecyLibs",id:"whitelist-plibs",slug:"/admin/dbx-whitelist-plibs",description:"Make ProphecyLibs available to Databricks UC standard clusters",tags:["unity catalog","databricks","plibs"]},o=void 0,l={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Option 1: Edit allowlist in the Databricks UI",id:"option-1-edit-allowlist-in-the-databricks-ui",level:2},{value:"Option 2: Edit allowlist via Python Notebook",id:"option-2-edit-allowlist-via-python-notebook",level:2},{value:"Option 3: Edit allowlist via cURL",id:"option-3-edit-allowlist-via-curl",level:2},{value:"Prophecy library Maven coordinate",id:"prophecy-library-maven-coordinate",level:3},{value:"Volume path for JARs",id:"volume-path-for-jars",level:3}];function d(i){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...i.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:["To use ",(0,n.jsx)(e.a,{href:"/engineers/prophecy-libraries",children:"Prophecy libraries"})," in Databricks environments that have enabled Unity Catalog, you must whitelist the required Maven coordinates or JAR paths. This page outlines different ways to do so."]}),"\n",(0,n.jsx)(e.admonition,{type:"info",children:(0,n.jsxs)(e.p,{children:["For more information, see the Databricks documentation on ",(0,n.jsx)(e.a,{href:"https://docs.databricks.com/aws/en/data-governance/unity-catalog/manage-privileges/allowlist",children:"allowlists"}),"."]})}),"\n",(0,n.jsx)(e.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,n.jsxs)(e.p,{children:["To whitelist Prophecy libraries in Databricks, you need to be a ",(0,n.jsx)(e.a,{href:"https://docs.databricks.com/aws/en/data-governance/unity-catalog/manage-privileges/admin-privileges#metastore-admins",children:"Databricks metastore admin"}),"."]}),"\n",(0,n.jsx)(e.h2,{id:"option-1-edit-allowlist-in-the-databricks-ui",children:"Option 1: Edit allowlist in the Databricks UI"}),"\n",(0,n.jsx)(e.p,{children:"Follow the instructions to whitelist Prophecy libraries through the Databricks UI."}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsx)(e.p,{children:"Check your Prophecy Library version."}),"\n",(0,n.jsxs)(e.p,{children:["Find your project's Prophecy library version by checking the ProphecyLibs dependency in your ",(0,n.jsx)(e.a,{href:"/projects#project-metadata",children:"project metadata"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsx)(e.p,{children:"Note your Databricks cluster's Spark version."}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsx)(e.p,{children:"Copy the corresponding Maven coordinate."}),"\n",(0,n.jsxs)(e.p,{children:["Format: ",(0,n.jsx)(e.code,{children:"io.prophecy:prophecy-libs_2.12:<version>"})]}),"\n",(0,n.jsxs)(e.p,{children:["Example: ",(0,n.jsx)(e.code,{children:"io.prophecy:prophecy-libs_2.12:3.5.0-8.0.31"})]}),"\n",(0,n.jsxs)(e.p,{children:["You can look up versions on ",(0,n.jsx)(e.a,{href:"https://mvnrepository.com/artifact/io.prophecy/prophecy-libs",children:"Maven Repository"})," that are compatible with your Spark version."]}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsx)(e.p,{children:"Navigate to allowlist in Databricks."}),"\n",(0,n.jsxs)(e.p,{children:["Go to ",(0,n.jsx)(e.strong,{children:"Catalog \u2192 Metastore \u2192 Allowed JARs/Init Scripts"})," to add the path or coordinates."]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:"Databricks allow list",src:t(74987).A+"",width:"1916",height:"1156"})}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsx)(e.p,{children:"(Optional) Add initialization script to pre-configure allowlist behavior."}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(e.h2,{id:"option-2-edit-allowlist-via-python-notebook",children:"Option 2: Edit allowlist via Python Notebook"}),"\n",(0,n.jsxs)(e.p,{children:["Use the following Python code in a Databricks notebook to whitelist the Prophecy library Maven coordinates. This command whitelists any Maven coordinates that begin with ",(0,n.jsx)(e.code,{children:"io.prophecy"}),"."]}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:'import requests\n\nurl = "https://<databricks-host>/api/2.1/unity-catalog/artifact-allowlists/LIBRARY_MAVEN"\nheaders = {\n    "Content-Type": "application/json",\n    "Authorization": "Bearer <your-token>",  # Replace with your PAT\n}\ndata = {\n    "artifact_matchers": [\n        {\n            "artifact": "io.prophecy",\n            "match_type": "PREFIX_MATCH"\n        }\n    ]\n}\n\nresponse = requests.put(url, headers=headers, json=data)\n\nprint(f"Status Code: {response.status_code}")\nprint(f"Response Text: {response.text}")\n'})}),"\n",(0,n.jsx)(e.h2,{id:"option-3-edit-allowlist-via-curl",children:"Option 3: Edit allowlist via cURL"}),"\n",(0,n.jsx)(e.h3,{id:"prophecy-library-maven-coordinate",children:"Prophecy library Maven coordinate"}),"\n",(0,n.jsxs)(e.p,{children:["Run the following in the command line to whitelist the Prophecy library Maven coordinates. This command whitelists any Maven coordinates that begin with ",(0,n.jsx)(e.code,{children:"io.prophecy"}),"."]}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-bash",children:'curl -v --location --request PUT \'<databricks-host>/api/2.1/unity-catalog/artifact-allowlists/LIBRARY_MAVEN\' \\\n--header \'Content-Type: application/json\' \\\n--header \'Authorization: Bearer <your-token>\' \\\n--data \'{\n  "artifact_matchers": [\n    {\n      "artifact": "io.prophecy",\n      "match_type": "PREFIX_MATCH"\n    }\n  ]\n}\'\n'})}),"\n",(0,n.jsx)(e.h3,{id:"volume-path-for-jars",children:"Volume path for JARs"}),"\n",(0,n.jsxs)(e.p,{children:["Run the following in the command line to whitelist a volume path for JARs. This is relevant if you have ",(0,n.jsx)(e.a,{href:"/admin/dbx-volumes-plibs",children:"set up Prophecy libraries in a Databricks volume"}),"."]}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-bash",children:'curl -v --location --request PUT \'<databricks-host>/api/2.1/unity-catalog/artifact-allowlists/LIBRARY_JAR\' \\\n--header \'Content-Type: application/json\' \\\n--header \'Authorization: Bearer <your-token>\' \\\n--data \'{\n  "artifact_matchers": [\n    {\n      "artifact": "/Volumes/shared-libs/",\n      "match_type": "PREFIX_MATCH"\n    }\n  ]\n}\'\n'})})]})}function h(i={}){const{wrapper:e}={...(0,s.R)(),...i.components};return e?(0,n.jsx)(e,{...i,children:(0,n.jsx)(d,{...i})}):d(i)}},74987:(i,e,t)=>{t.d(e,{A:()=>a});const a=t.p+"assets/images/dbx-allowlist-e7cd487f3608a296030a927734747a07.png"}}]);