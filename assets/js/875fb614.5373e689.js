"use strict";(self.webpackChunkdocs_4=self.webpackChunkdocs_4||[]).push([[68646],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>u});var i=n(96540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},g="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),g=c(n),m=a,u=g["".concat(s,".").concat(m)]||g[m]||d[m]||r;return n?i.createElement(u,o(o({ref:t},p),{},{components:n})):i.createElement(u,o({ref:t},p))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[g]="string"==typeof e?e:a,o[1]=l;for(var c=2;c<r;c++)o[c]=n[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},15479:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(96540),a=n(86025);const r=e=>{let{children:t}=e;return i.createElement("div",{style:{position:"relative",display:"flex","justify-content":"center","align-items":"center"}},t)},o=e=>{let{source:t,children:n}=e;return i.createElement("img",{src:(0,a.A)(t),style:{"object-fit":"cover"}})},l=e=>{let{slides:t}=e;const[n,a]=(0,i.useState)(0);return i.createElement(r,null,i.createElement("i",{class:"fa fa-chevron-left",onClick:()=>{a(0===n?t.length-1:n-1)},style:{position:"absolute",top:"50%",left:"0px","font-size":"2rem"}}),i.createElement("i",{class:"fa fa-chevron-right",onClick:()=>{a(n===t.length-1?0:n+1)},style:{position:"absolute",top:"50%",right:"0px","font-size":"2rem"}}),i.createElement("div",{style:{padding:"30px"}},i.createElement(o,{source:t[n].image}),t[n].description))};function s(e){let{ImageData:t}=e;return i.createElement(l,{slides:t,style:{"font-family":" sans-serif","text-align":"center"}})}},22906:(e,t,n)=>{n.r(t),n.d(t,{ImageData:()=>g,assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var i=n(58168),a=(n(96540),n(15680)),r=n(15479);const o={title:"Interactive Execution",id:"interactive-execution",description:"Interactive Execution",tags:["spark","interactive","development"]},l=void 0,s={unversionedId:"Spark/execution/interactive-execution",id:"Spark/execution/interactive-execution",title:"Interactive Execution",description:"Interactive Execution",source:"@site/docs/Spark/execution/interactive-execution.md",sourceDirName:"Spark/execution",slug:"/Spark/execution/interactive-execution",permalink:"/Spark/execution/interactive-execution",draft:!1,tags:[{label:"spark",permalink:"/tags/spark"},{label:"interactive",permalink:"/tags/interactive"},{label:"development",permalink:"/tags/development"}],version:"current",frontMatter:{title:"Interactive Execution",id:"interactive-execution",description:"Interactive Execution",tags:["spark","interactive","development"]},sidebar:"mySidebar",previous:{title:"SQLStatement",permalink:"/Spark/gems/custom/sql-statement"},next:{title:"Execution Metrics",permalink:"/Spark/execution/execution-metrics"}},c={},p=[{value:"Running a pipeline",id:"running-a-pipeline",level:2},{value:"Interims",id:"interims",level:2},{value:"Advanced Data sampling setting",id:"advanced-data-sampling-setting",level:3},{value:"Data sampling modes",id:"data-sampling-modes",level:3},{value:"Execution",id:"execution",level:2},{value:"Execution Code",id:"execution-code",level:3},{value:"Execution Errors",id:"execution-errors",level:3},{value:"Runtime Logs",id:"runtime-logs",level:3},{value:"Runtime Metrics",id:"runtime-metrics",level:3},{value:"Execution Metrics",id:"execution-metrics",level:3},{value:"Shell",id:"shell",level:2},{value:"Examples",id:"examples",level:3},{value:"Python",id:"python",level:4},{value:"Scala",id:"scala",level:4}],g=[{image:"/img/interactive-execution/interactive-execution-interim-all.png",description:(0,a.yg)("h3",{style:{padding:"10px"}},"Data Sampling Mode - All")},{image:"/img/interactive-execution/interactive-execution-interim-source.png",description:(0,a.yg)("h3",{style:{padding:"10px"}},"Data Sampling Mode - Source")},{image:"/img/interactive-execution/interactive-execution-interim-target.png",description:(0,a.yg)("h3",{style:{padding:"10px"}},"Data Sampling Mode - Target")},{image:"/img/interactive-execution/interactive-execution-interim-io.png",description:(0,a.yg)("h3",{style:{padding:"10px"}},"Data Sampling Mode - IO")},{image:"/img/interactive-execution/interactive-execution-sample-interim.png",description:(0,a.yg)("h3",{style:{padding:"10px"}},"Interim example")}],d={toc:p,ImageData:g},m="wrapper";function u(e){let{components:t,...o}=e;return(0,a.yg)(m,(0,i.A)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h2",{id:"running-a-pipeline"},"Running a pipeline"),(0,a.yg)("p",null,"There are 2 ways to run a pipeline interactively:"),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Interactive run options",src:n(13998).A,width:"3450",height:"1848"})),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Using the play button from the bottom right side. This would execute the entire pipeline."),(0,a.yg)("li",{parentName:"ol"},"Using the play button on a particular gem. This would only execute the flow in the pipeline up to and including that gem. This comes\nin handy during development, so that we don't have to run the entire pipeline to debug/change a particular gem.")),(0,a.yg)("div",{class:"wistia_responsive_padding",style:{padding:"56.25% 0 0 0",position:"relative"}},(0,a.yg)("div",{class:"wistia_responsive_wrapper",style:{height:"100%",left:0,position:"absolute",top:0,width:"100%"}},(0,a.yg)("iframe",{src:"https://user-images.githubusercontent.com/103921419/185360973-928612ae-7655-4e67-8f95-ae9b63829231.mp4",title:"Monitoring",allow:"autoplay;fullscreen",allowtransparency:"true",frameborder:"0",scrolling:"no",class:"wistia_embed",name:"wistia_embed",msallowfullscreen:!0,width:"100%",height:"100%"}))),(0,a.yg)("h2",{id:"interims"},"Interims"),(0,a.yg)("p",null,"During development, often the user will want to see their data to make more sense of it and to check whether the expected output is getting\ngenerated or not after the transformation. Prophecy generates these data samples as ",(0,a.yg)("inlineCode",{parentName:"p"},"Interims"),", which are temporarily cached previews of data after each gem."),(0,a.yg)("p",null,"Which gems automatically get Interims created is controlled by the pipeline settings as shown below."),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Data and Job Sampling",src:n(43241).A,width:"2880",height:"1084"})),(0,a.yg)("p",null,"From the pipeline, select the ",(0,a.yg)("strong",{parentName:"p"},"(1) dropdown")," and ",(0,a.yg)("strong",{parentName:"p"},"(2) Pipeline Settings"),". Select ",(0,a.yg)("strong",{parentName:"p"},"(3) Job Sampling")," to generate interim samples for scheduled jobs. Select ",(0,a.yg)("strong",{parentName:"p"},"(4) Sampling Mode")," to chose the level of data sampling. Select ",(0,a.yg)("strong",{parentName:"p"},"(5) Data Sampling")," to generate interim samples during interactive runs, and select the Sampling Mode accordingly. These two options, Job sampling and Data sampling, are independent; one does not affect the other. For Job sampling, the interim metrics are stored in the compute cluster, such as the Databricks workspace, and visible in ",(0,a.yg)("a",{parentName:"p",href:"#execution-metrics"},"execution metrics"),"."),(0,a.yg)("h3",{id:"advanced-data-sampling-setting"},"Advanced Data sampling setting"),(0,a.yg)("p",null,"There is also a global level Development Settings flag that admins can use to disable Data sampling for a given fabric. This flag overrides the pipeline level Data sampling settings. When disabled, you won't be able to see production data in the interims when you run the pipeline."),(0,a.yg)("p",null,"From the Metadata page, click the ",(0,a.yg)("strong",{parentName:"p"},"Fabrics")," tab and select the fabric that you want to change the Data sampling setting for. Click the ",(0,a.yg)("strong",{parentName:"p"},"Advanced")," tab and click the ",(0,a.yg)("strong",{parentName:"p"},"Allow for data sampling")," toggle to turn on or off the flag."),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Create a new model test",src:n(54830).A,width:"2620",height:"1508"})),(0,a.yg)("p",null,"Data sampling is enabled on by default. When left enabled, Data sampling uses the pipeline's data sampling settings. Prophecy samples data during the interactive run experience to provide the best debugging experience for users."),(0,a.yg)("h3",{id:"data-sampling-modes"},"Data sampling modes"),(0,a.yg)("p",null,"Toggle the images below to view the various modes (or levels) of data sampling. By default, for interactive runs, data sampling is enabled for all components. Note ",(0,a.yg)("a",{parentName:"p",href:"/Spark/execution/executions_on_databricks_clusters#vanilla-interims"},"Vanilla")," is an interim sampling mode reserved for Shared Databricks clusters."),(0,a.yg)(r.A,{ImageData:g,mdxType:"App"}),(0,a.yg)("h2",{id:"execution"},"Execution"),(0,a.yg)("p",null,"Once we run a pipeline, we have several options to better understand our pipeline:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#execution-code"},"Execution code")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#execution-errors"},"Execution Errors")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#runtime-logs"},"Runtime Logs")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#runtime-metrics"},"Runtime Metrics")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"#execution-metrics"},"Execution Metrics"))),(0,a.yg)("h3",{id:"execution-code"},"Execution Code"),(0,a.yg)("p",null,"Once we run a pipeline interactively Prophecy generates the execution code in the backend, which is then executed in\nthe selected fabric."),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Execution code",src:n(31422).A,width:"3328",height:"1208"})),(0,a.yg)("admonition",{type:"info"},(0,a.yg)("p",{parentName:"admonition"},"Execution code can also be copy-pasted inside ",(0,a.yg)("inlineCode",{parentName:"p"},"databricks notebook")," or ",(0,a.yg)("a",{parentName:"p",href:"#shell"},"shell")," and can directly\nbe executed for debugging.")),(0,a.yg)("h3",{id:"execution-errors"},"Execution Errors"),(0,a.yg)("p",null,"If there are any errors in the pipeline, a pop-up window will open for ",(0,a.yg)("inlineCode",{parentName:"p"},"execution errors"),".\n",(0,a.yg)("img",{alt:"Interactive execution error",src:n(99999).A,width:"3298",height:"1598"})),(0,a.yg)("p",null,"Also the error can be seen in the runtime logs:\n",(0,a.yg)("img",{alt:"Interactive execution error logs",src:n(96059).A,width:"3324",height:"1230"})),(0,a.yg)("h3",{id:"runtime-logs"},"Runtime Logs"),(0,a.yg)("p",null,"Overall progress with associated timestamps can be monitored from the Runtime Logs as shown here:"),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Runtime Logs",src:n(91881).A,width:"3312",height:"1206"})),(0,a.yg)("h3",{id:"runtime-metrics"},"Runtime Metrics"),(0,a.yg)("p",null,"Various Spark metrics collected during runtime can be monitored as shown here:"),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Runtime Metrics",src:n(80625).A,width:"3326",height:"1198"})),(0,a.yg)("h3",{id:"execution-metrics"},"Execution Metrics"),(0,a.yg)("p",null,"For ",(0,a.yg)("inlineCode",{parentName:"p"},"interactive runs")," execution metrics are collected to make the development easier and performance tuning more intuitive. These can be\naccessed from the ",(0,a.yg)("inlineCode",{parentName:"p"},"Metadata Page")," inside the ",(0,a.yg)("inlineCode",{parentName:"p"},"run tab")," of the ",(0,a.yg)("inlineCode",{parentName:"p"},"Pipeline"),"."),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Execution Metrics",src:n(12819).A,width:"3302",height:"824"})),(0,a.yg)("h2",{id:"shell"},"Shell"),(0,a.yg)("p",null,"Prophecy IDE comes with an inbuilt interactive Spark shell that supports both ",(0,a.yg)("inlineCode",{parentName:"p"},"Python")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"Scala"),". The shell is an easy way to quickly analyze data or test Spark commands\n",(0,a.yg)("img",{alt:"Interactive execution",src:n(68843).A,width:"3226",height:"1070"})),(0,a.yg)("admonition",{type:"info"},(0,a.yg)("p",{parentName:"admonition"},(0,a.yg)("inlineCode",{parentName:"p"},"Spark context")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"session")," are available within the shell as variables ",(0,a.yg)("inlineCode",{parentName:"p"},"sc")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"spark")," respectively")),(0,a.yg)("hr",null),(0,a.yg)("h3",{id:"examples"},"Examples"),(0,a.yg)("admonition",{type:"note"},(0,a.yg)("p",{parentName:"admonition"},"You need to be connected to a cluster to access the interactive shell")),(0,a.yg)("h4",{id:"python"},"Python"),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Python interactive execution",src:n(91225).A,width:"3456",height:"1938"})),(0,a.yg)("h4",{id:"scala"},"Scala"),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Scala interactive execution",src:n(21096).A,width:"3456",height:"1938"})))}u.isMDXComponent=!0},68843:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/int_exc_1-06819b9fb816e6634e0c7c55e0225ffe.png"},91225:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/int_exc_py-e8b3d69d77f69415240565e4ca616ff1.png"},21096:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/int_exc_scala-75d0419fc92ac9aeb536d0967e7e0765.png"},31422:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/interactive-execution-code-0f6ee9619f0b5bcea176668cedbfd487.png"},96059:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/interactive-execution-error-logs-2bb22db972820d0a41d4c7006576d9fb.png"},99999:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/interactive-execution-error-9df26e6ed47a58adba2c9fd03aa0957b.png"},12819:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/interactive-execution-execution-metrics-3835ca06e0405228b3f773f197890162.png"},43241:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/interactive-execution-job-data-sampling-abc32d1b0db57e812c8d35e95dacfc0e.png"},13998:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/interactive-execution-play-options-4845ed9025f1d78c2e9c243b96148800.png"},91881:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/interactive-execution-runtime-logs-7fbf3c747b179885b4ea8d305f989bca.png"},80625:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/interactive-execution-runtime-metrics-c12c60b32964ca2bd349627e3584b3a5.png"},54830:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/limit-data-preview-interims-b37ec1a06104508551195a267acd7190.png"}}]);